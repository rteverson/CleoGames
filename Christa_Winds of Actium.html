<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Winds of Actium</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:.1em}0%,to{top:0px}}@keyframes shudder{25%{left:.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%,to{transform:translateX(0em)}5%,25%,45%{transform:translateX(-1em)}15%,35%,55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%,to{transform:translateY(0em)}5%,25%,45%{transform:translateY(-1em)}15%,35%,55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%,8.1%,82.1%,31.1%,38.1%,44.1%,40.1%,47.1%,74.1%,16.1%,27.1%,72.1%,24.1%,95.1%,6.1%,36.1%,20.1%,4.1%,91.1%,14.1%,87.1%,to{left:0px;top:0px}8%,82%,31%,38%,44%{left:-1px}40%,47%,74%,16%,27%{left:1px}72%,24%,95%,6%,36%{top:-1px}20%,4%,91%,14%,87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:.2}64%{opacity:.4}78%{opacity:.6}87%{opacity:.8}92%,to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:#000;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" name="' attr(name) '">'}tw-open-button[goto]{display:none}.debug-mode tw-open-button[replay],.debug-mode tw-open-button[goto]{display:inline}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 .5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,.5)}.debug-mode tw-expression[title]:not([title=""]){cursor:help}.debug-mode tw-hook{background-color:rgba(0,85,255,.1) !important}.debug-mode tw-hook::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,.1) !important}.debug-mode tw-collapsed::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 50%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0.25) 0%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,.2)}.debug-mode tw-enchantment{animation:enchantment .5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,.1)}.debug-mode tw-include::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(type) ' "' attr(name) '"'}.debug-dialogs tw-backdrop:not(.eval-replay):not(.harlowe-crash){pointer-events:none;opacity:.1}tw-eval-replay tw-eval-code,tw-eval-replay tw-eval-explanation{max-height:20vh;overflow:auto;margin:10px auto}tw-eval-replay tw-eval-code{display:block;font-family:monospace;padding-bottom:1ex;border-bottom:2px solid gray}tw-eval-replay tw-eval-explanation{display:block;text-align:center}tw-eval-replay tw-eval-explanation>code{white-space:pre-wrap}tw-eval-replay tw-eval-explanation>code.from-block{width:40%;display:inline-block;text-align:left;max-height:4em;overflow-wrap:anywhere;overflow-y:scroll}tw-eval-replay tw-eval-explanation>code.from-block~.to-desc{width:calc(40% - 2em);margin-left:2em;display:inline-block}tw-eval-replay tw-eval-explanation>code.from-block+span::after{content:"..."}tw-eval-replay tw-eval-explanation>code.from-inline{text-align:right}tw-eval-replay tw-eval-explanation>:nth-child(2){white-space:pre}tw-eval-replay tw-eval-explanation>.to-desc{text-align:left}tw-eval-replay tw-eval-explanation>table{width:100%;margin-top:1em}tw-eval-replay tw-eval-explanation>table td{white-space:pre-wrap !important;word-wrap:anywhere}tw-eval-replay tw-eval-reason{text-align:center;font-size:80%;font-style:italic;display:block}tw-eval-replay tw-eval-it{text-align:center;font-size:80%;display:block}tw-eval-replay tw-dialog-links{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:14em;min-height:1em;padding:0em .5em .5em 1em;font-size:1.25em;font-family:sans-serif;color:#262626;background-color:#fff;border-left:solid #262626 2px;border-top:solid #262626 2px;border-top-left-radius:.5em;opacity:1}tw-debugger.fade-panel:not(:hover){opacity:.33}tw-debugger.theme-dark{color:#d9d9d9;background-color:#000}tw-debugger.theme-dark{border-color:#d9d9d9 rgba(0,0,0,0) rgba(0,0,0,0) #d9d9d9}tw-debugger select{margin-right:1em;width:12em}tw-debugger button,tw-debugger tw-link{border-radius:3px;border:solid #999 1px;margin:auto 4px;color:#262626;background-color:#fff;cursor:pointer}tw-debugger button.enabled,tw-debugger tw-link.enabled{color:#000;background-color:#d9d9d9;box-shadow:inset #999 3px 5px .5em}tw-debugger.theme-dark button,tw-debugger.theme-dark tw-link{color:#d9d9d9;background-color:#000;border-color:#666}tw-debugger.theme-dark button.enabled,tw-debugger.theme-dark tw-link.enabled{color:#e6e6e6;background-color:#424242;box-shadow:inset #666 3px 5px .5em}tw-debugger button{font-size:1em;overflow-x:hidden;text-overflow:ellipsis;white-space:pre}tw-debugger tw-link{font-size:1.25em;border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-debugger tw-link:hover{border-color:#262626;color:#262626}tw-debugger.theme-dark tw-link:hover{border-color:#d9d9d9;color:#d9d9d9}tw-debugger tw-dialog{background-color:#fff;color:#000;font-size:1.25em}tw-debugger.theme-dark tw-dialog{background-color:#000;color:#e6e6e6}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;overflow-y:scroll;overflow-x:hidden;border:inherit;box-sizing:content-box;background-color:#fff;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger.theme-dark .panel{background-color:#000;border-bottom-color:#666}tw-debugger .panel-source .panel-row-buttons{width:2rem}tw-debugger .panel-source .source-tags{width:20%;font-style:italic}tw-debugger .panel-row-source td{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere;max-height:8rem;padding:1rem}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background-color:#e6e6e6}tw-debugger .panel-tools .panel-rows>*,tw-debugger .panel-options .panel-rows>*{margin-top:.4rem;display:block}tw-debugger.theme-dark .panel-rows>div:nth-of-type(2n){background-color:#212121}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty+.panel-errors-bottom{display:none}tw-debugger.theme-dark .panel-variables .panel-rows:empty::before,tw-debugger.theme-dark .panel-enchantments .panel-rows:empty::before,tw-debugger.theme-dark .panel-errors .panel-rows:empty::before{color:#a8a8a8}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger th[data-col]{text-decoration:underline;cursor:pointer}tw-debugger th[data-col][data-order=asc]::after{content:"↓"}tw-debugger th[data-col][data-order=desc]::after{content:"↑"}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .storylet-exclusive,tw-debugger .storylet-urgent,tw-debugger .storylet-open{text-align:center}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:.8;font-size:.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#575757;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger.theme-dark .variable-type{color:#a8a8a8}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,.3)}tw-debugger .error-row>*{display:table-cell;padding:.25em .5em}tw-debugger .error-row .error-message[title]:not([title=""]){cursor:help}tw-debugger .error-row .error-passage{color:#575757}tw-debugger.theme-dark .error-row .error-passage{color:#a8a8a8}tw-debugger .storylet-row{background-color:rgba(193,240,225,.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(152,231,204,.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;background-color:#fff}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:#e6e6e6}tw-debugger .storylet-row.storylet-closed>:not(.storylet-lambda){opacity:.6}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .storylet-row .storylet-lambda{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere}tw-debugger.theme-dark .storylet-row.storylet-closed{background-color:#000}tw-debugger.theme-dark .storylet-row.storylet-closed:nth-child(2n){background-color:#212121}tw-debugger .tabs{padding-bottom:.5em}tw-debugger .tab{border-radius:0px 0px .5em .5em;border-top:none;top:-2px}tw-debugger .resizer-h{position:absolute;height:14em;border-left:2px solid #999;border-right:2px solid #999;top:10px;left:4px;width:8px;cursor:ew-resize}tw-debugger.theme-dark .resizer-h{border-color:rgba(0,0,0,0) #666}tw-debugger .resizer-v{position:absolute;height:8px;border-top:2px solid #999;border-bottom:2px solid #999;margin-bottom:4px;top:4px;left:10px;width:95%;cursor:ns-resize;box-sizing:border-box}tw-debugger.theme-dark .resizer-v{border-color:#666 rgba(0,0,0,0)}tw-debugger mark{color:inherit;background-color:rgba(101,230,230,.3) !important}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media(min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%;border:solid #fff !important}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop~tw-backdrop{display:none}tw-link,.enchantment-link{cursor:pointer;color:#4169e1;font-weight:bold;text-decoration:none;transition:color .2s ease-in-out}tw-passage [style^=color] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^=color][hover=true] tw-link:hover,tw-passage [style*=" color"][hover=true] tw-link:hover,tw-passage [style^=color] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^=color][hover=true] .enchantment-link:hover,tw-passage [style*=" color"][hover=true] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#dd4b39}.visited{color:#6941e1}tw-passage [style^=color] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^=color][hover=true] .visited:hover,tw-passage [style*=" color"][hover=true] .visited:hover{color:inherit}.visited:hover{color:#e3e}tw-broken-link{color:#933;border-bottom:2px solid #933;cursor:not-allowed}tw-passage [style^=color] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^=color][hover=true] tw-broken-link:hover,tw-passage [style*=" color"][hover=true] tw-broken-link:hover{color:inherit}tw-link.enchantment-mouseover,.link.enchantment-mouseover,tw-expression.enchantment-mouseover>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border-bottom:2px dashed #999}tw-link.enchantment-mouseover:hover,tw-link.enchantment-mouseover:active,.link.enchantment-mouseover:hover,.link.enchantment-mouseover:active,tw-expression.enchantment-mouseover>tw-link:hover,tw-expression.enchantment-mouseover>tw-link:active{color:inherit}tw-link.enchantment-mouseover.enchantment-button,.link.enchantment-mouseover.enchantment-button,tw-expression.enchantment-mouseover>tw-link.enchantment-button{border-style:dashed}tw-link.enchantment-mouseout,.link.enchantment-mouseout,tw-expression.enchantment-mouseout>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border:rgba(64,149,191,.6) 1px solid;border-radius:.2em}tw-link.enchantment-mouseout:hover,tw-link.enchantment-mouseout:active,.link.enchantment-mouseout:hover,.link.enchantment-mouseout:active,tw-expression.enchantment-mouseout>tw-link:hover,tw-expression.enchantment-mouseout>tw-link:active{color:inherit}tw-link.enchantment-mouseout:hover,.link.enchantment-mouseout:hover,tw-expression.enchantment-mouseout>tw-link:hover{background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 1px solid}tw-link.enchantment-dblclick,.link.enchantment-dblclick,tw-expression.enchantment-dblclick>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;cursor:pointer;border:2px solid #999;border-radius:0}tw-link.enchantment-dblclick:hover,tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:hover,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:hover,tw-expression.enchantment-dblclick>tw-link:active{color:inherit}tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:active{background-color:#999}tw-link.enchantment-button,.link.enchantment-button,.enchantment-button:not(.link) tw-link,.enchantment-button:not(.link) .link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}.enchantment-button{display:block}.enchantment-clickblock{cursor:pointer;width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,.5);transition:color .2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 .5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 .5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 2px solid;border-radius:.2em}.enchantment-dblclickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;cursor:pointer;border:2px solid #999}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia,serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media(min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:rgba(0,0,0,0);font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=text]{background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 .5em .5em .5em;vertical-align:middle}tw-story tw-noscript{animation:appear .8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media(min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*=width]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:.2;cursor:pointer}tw-icon[alt]:hover{opacity:.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:.2em;padding:.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:4px;border:1px solid rgba(255,255,255,.5);font-size:.8rem;margin:0 .2rem;padding:3px;white-space:pre}tw-folddown::after{content:"▶"}tw-folddown.open::after{content:"▼"}tw-open-button[replay]{display:none}tw-error tw-open-button,tw-eval-replay tw-open-button{display:inline !important}tw-open-button::after{content:attr(label)}tw-notifier{border-radius:.2em;padding:.2em;font-size:1rem;background-color:rgba(223,182,58,.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid #000;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:.3em 0 .6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,.6);background-color:#ff9}ins{color:rgba(0,0,0,.6);background-color:rgba(255,242,204,.5);border-radius:.5em;box-shadow:0em 0em .2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play Winds of Actium.</tw-noscript></noscript></tw-story>
<tw-storydata name="Winds of Actium" startnode="291" creator="Twine" creator-version="2.9.2" format="Harlowe" format-version="3.3.9" ifid="DF53A696-0255-4C78-BFF8-60961387632D" options="" tags="" zoom="0.3" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css"></style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-passagedata pid="1" name="Introduction" tags="" position="600,275" size="100,100">You open your eyes to the bright white light of the sun warming your skin.

The rush of the wind flows through your hair and fills your lungs with a fresh saltiness from the sea around you.

You stand on the ship’s hull, with a bustle of the crew life all around you. The seas were calm today, it is the middle of summer.[[^^1^^|IntroductionCP]]

[[Look to the horizon|introhorizon]]

[[Look back to your father on the helm|introhelm]]</tw-passagedata><tw-passagedata pid="2" name="introhorizon" tags="" position="675,400" size="100,100">(set:$melancholy to 1)

You look out onto the horizon, the sea glitters blue and green. In the far distance, you vaguely see the remote shoreline of Greece.

You think of Actium, a story that your father often told you when you were a young child. It fills you with a sense of longing and nostalgia for a lost era and possibility.

[[Look back to your father on the helm|introhelm]]

[[Talk to father|introfatherchat]]</tw-passagedata><tw-passagedata pid="3" name="CharacterInfo" tags="" position="600,150" size="100,100">What is your gender? Select below.
(dropdown: bind $gender, &quot;Female&quot;, &quot;Non-Binary&quot;)

(set: $name to (prompt: &quot;What is your name?&quot;, &quot;&quot;))

[[Begin the Winds of Actium|Introduction]]</tw-passagedata><tw-passagedata pid="4" name="introfatherchat" tags="" position="600,525" size="100,100">Shaking yourself out of your thoughts, you walk away from the bord and towards the helm, where your father and the head navigator, Hakor, look over maps.

We left Alexandria over a fortnight ago and have been making our way across the Hellenes to Rome. We should be approaching Sicily soon.[[^^1^^|introfatherchatCP]]

Upon seeing your approach, your father happily greets you, “My sweet (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]! What brings you up here? Don’t you have plenty of duties around the ship?”

[[How much further until we reach Sicily?|introfatherchatsicily]]

[[Why are we going to Rome?|introfatherchatrome]]

[[What should I do around the ship?|introfatherchatduties]]

(if: $melancholy is 1)[[What happened at Actium, again?|Actiumspecialquestion]]</tw-passagedata><tw-passagedata pid="5" name="introfatherchatsicily" tags="" position="425,650" size="100,100">Your father shakes his head, chuckling at your question, “Ah…getting a bit impatient? Just like when you were little, always asking me how much further. It’s nice to know some things stay the same…”

He looks beyond your shoulder, onto the vast sea, his expression hardening, “If the winds remain favorable and no storms pass, we should reach Sicily within the week.” You smile and nod, causing him to reach out and touch your shoulder, giving it a quick squeeze.

[[Ask more questions|introfatherchatquestions]]

[[Attend to your duties|workonship]]
</tw-passagedata><tw-passagedata pid="6" name="introfatherchatrome" tags="" position="550,650" size="100,100">Your father straightens himself, seemingly hesitating before replying, “I’m looking to expand our trading routes, and given the demand for grain in Rome, we could have a chance of making more money and purchasing more ships.”

You curtly nod as he continues, nudging your side, “Maybe you could be captain of one of the ships, what do you think about that?” You smile and politely nod, unclear on how you feel about that, your father beams either way.[[^^1^^|introfatherchatromeCP]]

[[Ask more questions|introfatherchatquestions]]

[[Attend to your duties|workonship]]</tw-passagedata><tw-passagedata pid="7" name="introfatherchatduties" tags="" position="725,650" size="100,100">Your father freezes, causing you to feel a slight panic, before he bursts into laughter, leaning forward. You feel your face burn in slight embarrassment as he continues to howl. You look around and see Hakor chuckling in the corner.

Fighting through his laughter, your father chokes out, “Oh, my (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] you never fail to make me happy. You’ve been living and working on a boat since you could walk! Surely you know your duties by now – helping with the sails, navigation, cleaning, and maintaining the cargo!”

[[Ask more questions|introfatherchatquestions]]

[[Attend to your duties|workonship]]
</tw-passagedata><tw-passagedata pid="8" name="Actiumspecialquestion" tags="" position="775,525" size="100,100">Your father looks at you before touching your cheek in a moment of affection, “That was the day where everything changed. Our country became a memory of the past, it was only inevitable that Augustus took control. Your mother and I recalled the rumors that floated through the streets when Queen Cleopatra and Marc Antony returned, whispers of defeat, betrayal, and fear flooded Alexandria. When the Romans arrived, we knew it was over for our empire.” He sighs, looking troubled before giving you a quick hug.

[[Ask more questions|introfatherchatquestions]]

[[Attend to your duties|workonship]]
</tw-passagedata><tw-passagedata pid="9" name="introfatherchatquestions" tags="" position="450,500" size="100,100">[[How much further until we reach Sicily?|introfatherchatsicily]]

[[Why are we going to Rome?|introfatherchatrome]]

[[What should I do around the ship?|introfatherchatduties]]

(if: $melancholy is 1)[[What happened at Actium, again?|Actiumspecialquestion]]</tw-passagedata><tw-passagedata pid="10" name="workonship" tags="" position="600,775" size="100,100">Satisfied with your conversation with your father, you walk away from the helm to the first mate on the main deck. Cheops, the first mate, sees you approach saying, “[$name!] Where have you been? We need your help lifting sails! These new sailors have no clue what they&#39;re doing. Let&#39;s show them how an expert does it.” You bashfully nod and begin to work!

[[Adjust sails to the wind.|workonship_2]]</tw-passagedata><tw-passagedata pid="11" name="workonship_2" tags="" position="400,825" size="100,100">[[Keep adjusting the sails|workonship_3]]</tw-passagedata><tw-passagedata pid="12" name="workonship_3" tags="" position="525,900" size="100,100">[[What is that rookie doing over there?!|workonship_4]]</tw-passagedata><tw-passagedata pid="13" name="workonship_4" tags="" position="650,900" size="100,100">[[Jeez, that rookie almost fully released the main sail. Cheops wasn&#39;t kidding, they have no clue what they&#39;re doing.|workonship_5]]</tw-passagedata><tw-passagedata pid="14" name="workonship_5" tags="" position="800,800" size="100,100">[[How unbelievable…Your stomach grumbles loudly in protest.|workonship_6]]</tw-passagedata><tw-passagedata pid="15" name="introendnight" tags="" position="550,1025" size="100,100">(set: $sleepiness to 0)

After working all day, you and other members of the crew go beneath the deck into the cargo hold where various hammocks hang about, snaking around the nightly crew beginning their shift. 

Your father and other high ranking crew members have their own semi-private area designated with a curtain. Growing up, you used to sleep there, but now that you&#39;re 21, you reside in the main cargo hold.[[^^1^^|introendnightCP]]

However, tonight, your father and the others remain atop the deck, maintaining course through the stars. Your hammock hangs between two boxes, on it lies your various personal items in a linen bag. Sighing, you open the bag, looking at your life…

[[Touch your necklace|itemjewelry]]

[[Pray to a statuette of Isis|itemstatuette]]

[[Read papyrus|itemstela]]</tw-passagedata><tw-passagedata pid="16" name="itemjewelry" tags="" position="425,1175" size="100,100">You touch your necklace, it was your mother’s. You fiddle with the beads, shells, and amulets. Your mother told you that wearing it would protect you from illness and danger as the colors and materials pleased the gods. Regardless, you find a source of comfort knowing that you have divine protection.[[^^1^^|itemjewelryCP]]
(Set: $sleepiness to $sleepiness + 1)
[[Pray to a statuette of Isis|itemstatuette]]

[[Read papyrus|itemstela]]

(if: $sleepiness is 3 or &gt;3)[[Go to sleep|introend]]</tw-passagedata><tw-passagedata pid="17" name="itemstatuette" tags="" position="600,1175" size="100,100">You paw through the bag, feeling a figurine. You grasp it and carefully remove it. 
(Set: $sleepiness to $sleepiness + 1)
A statuette of Isis, a deity your family worships. You smile as you hold the figurine in your hands, however a feeling of bittersweetness runs through you as you are reminded of Queen Cleopatra’s tragic and untimely death.

You carefully place the statuette onto one of the boxes and kneel, praying to her for protection on the seas and for your journey to Rome. You look at the figurine, and overcome by the reminder of your mother’s love for her, pray for her journey in the afterlife.

The statuette, while small, stands tall and powerful. You feel a source of comfort.[[^^1^^|itemstatuetteCP]]

[[Examine a piece of jewelry|itemjewelry]]

[[Read papyrus|itemstela]]

(if: $sleepiness is 3 or &gt;3)[[Go to sleep|introend]]</tw-passagedata><tw-passagedata pid="18" name="itemstela" tags="" position="775,1175" size="100,100">(Set: $sleepiness to $sleepiness + 1)

You carefully sift to the bottom of the bag where a papyrus lies, it was a paper copy of your father’s business contract. 

Carefully, your fingers trace the figures along the top, seemingly wishing for the sensation of the carved relief as you read the description detailing the contract, it was a trade agreement between Paramonos of Rhodes and your father, Adamantios.

To this day, Paramonos and your father maintain a professional trading relationship, nearly every trip taken involves a stop to Rhodes, an island near Asia Minor.

[[Examine a piece of jewelry|itemjewelry]]

[[Pray to a statuette of Isis|itemstatuette]]

(if: $sleepiness is 3 or &gt;3)[[Go to sleep|introend]]</tw-passagedata><tw-passagedata pid="19" name="introhelm" tags="" position="550,400" size="100,100">You look back to your father on the helm.

You think of your upbringing on the sea, you’re the eldest and only (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child] and your father has always intended that you take over the merchant business.

You love sailing, but you aren’t sure if that is your life path.

[[Look to horizon|introhorizon]]

[[Talk to father|introfatherchat]]
</tw-passagedata><tw-passagedata pid="20" name="workonship_8" tags="" position="775,1050" size="100,100">[[Oh, it’s almost sunset. Time to wash up and get some sleep.|introendnight]]</tw-passagedata><tw-passagedata pid="21" name="workonship_6" tags="" position="925,850" size="100,100">[[You, Cheops, and other crew members sit near the bord, shoving bread chunks and some salted fish into your mouths.^^13^^|workonship_7]]

–––––––––––––––––
13 Casson, //The Ancient Mariners//, 216–18.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On merchant ships, water was provided in tanks within the hold and food was available in the form of meat and porridge cooked on a fire over a protected hearth.]</tw-passagedata><tw-passagedata pid="22" name="workonship_7" tags="" position="775,925" size="100,100">[[You cleaned the main deck with the help of some other crew members.|workonship_8]]</tw-passagedata><tw-passagedata pid="23" name="introend" tags="" position="875,1325" size="100,100">You carefully place the items back into your bag, unfurling your wool blanket to cover yourself. Today was exhausting, though, every day on the seas generally is. Sighing heavily, you settle onto your hammock, gingerlly hoping to awaken to the sight of Sicily. You close your eyes and find yourself quickly slipping into a dream state, incoherent images and echoes of your desires floating through your mind.


[[//End of Prologue//|P1PSStart]]</tw-passagedata><tw-passagedata pid="24" name="P1PSStart" tags="" position="1200,100" size="100,100">A few days later, //The Akhet// begins its arrival to Messana, the harbor city where your trading routes usually stop. 

However, as your father informed you and the crew before leaving Alexandria, Messana would be one stop along a slightly longer route to Rome. Eventually you would collect Maximinus, your father’s Roman connection.

Maximinus and your Father met years ago in Messana and maintain business relations, Maximinus is a patrician-class man who owns many business ventures and has many connections with naval trading.[[^^1^^|P1PSStartCP]]

Despite working with your Father since you were a child, you have never met him…

[[Help unload the cargo.|P1PSDock]]
</tw-passagedata><tw-passagedata pid="25" name="P1PSDock" tags="" position="1200,225" size="100,100">After unloading the cargo, your Father calls the crew to listen on the deck, “As I stated before we left Alexandria, Messana is not our last stop. We will continue to Panormus to collect a business partner before ultimately going to Rome.” The crew idly chatters in understanding, as he continues, “Please enjoy the harbor city! Be back to the ship by sundown to rest up so we can leave bright and early like Aurora.” 

Nodding, you turn to Cheops’ eye, who was already looking at you, “[$name]! Since we have some free time, do you want to come with me to the market?” 

[[Yes! Let’s go!|P1PSMarket]]</tw-passagedata><tw-passagedata pid="26" name="P1PSMarket" tags="" position="1200,350" size="100,100">You and Cheops walk throughout the market, happy to be back on land. You notice a stall with an aroma surely feeding the gods...

Almost as if you two were floating, you and Cheops find yourselves patiently awaiting to try mouthwatering food, a thick-soup with fish and bread. The vendor, a stout man wiping at his brow with a piece of cloth, said, “Gonna stand there all day or are you going to order?”[[^^1^^|P1PSMarketCP]]

[[Clearing your throat, you recite your order.|P1PSMarketFood]]</tw-passagedata><tw-passagedata pid="27" name="P1PSMarketEat" tags="" position="1325,450" size="100,100">As you pay, he gruffs, “Watch your back through here. Things are getting crazy with pirates and everything.” You nod, quickly eating your food at the counter with Cheops.

[[Keep walking around the market together|P1PSTavStart]]</tw-passagedata><tw-passagedata pid="28" name="P1PSTavStart" tags="" position="1200,550" size="100,100">After continuing to explore the market, you and Cheops run into some other crew members who inform you they are heading to the tavern to drink. You and Cheops share a glance, silently agreeing with each other to go drink.^^31, 32^^

[[Order a drink|P1PSTavOrder]]

–––––––––––––––––
^^31^^ Casson, //Everyday Life in Ancient Rome//, 118.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Ancient eating spaces were not technically restaurants, but rather wine shops. Full service was in the rear of the shop and the customers were usually sailors, slaves, muleteers, and street drifters.]
^^32^^ Casson, 118.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[The drinking area of the wine shop would have been in the back where everyone would have received full sit-down service.]</tw-passagedata><tw-passagedata pid="29" name="P1PSTavOrder" tags="" position="1200,675" size="100,100">After walking into the tavern, you and Cheops immediately rush towards the keeper, buying a round of wine for everyone. 

(Set: $PiracyAwareness to 0)
(Set: $MessanaDrink to 0)

[[Drink the wine|P1PSTavDrink]]</tw-passagedata><tw-passagedata pid="30" name="P1PSTavDrink" tags="" position="1200,800" size="100,100">Coming back to the table with wine for everyone, you all toast to Isis for your safe passage and enjoy the wine together.^^33^^

(Set: $MessanaDrink to $MessanaDrink + 1)

[[Talk to crew|P1PSTavCrew]]

[[Talk to locals|P1PSTavLocal]]

(if: $MessanaDrink is 1)[[Leave to the ship|P1PSTavLeave]]

–––––––––––––––––
^^33^^ Jon D. Mikalson, Andrej Petrovic, and Ivana Petrovic, //Ancient Greek Religion //(John Wiley &amp; Sons, 2021), 198.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Isis had a name directly related to sailing, Isis Pelagia, meaning Isis of the sea.]</tw-passagedata><tw-passagedata pid="31" name="P1PSTavCrew" tags="" position="1075,900" size="100,100">Sipping the wine, you talk to the crew and share your experiences in Messana. They account for similar experiences with vendors providing warnings for pirates. You all discuss how strange it is, noting that piracy has been fairly rare since Pompey’s piracy campaign all those decades ago.^^34^^

(Set: $PiracyAwareness to $PiracyAwareness + 1)

[[Talk to locals|P1PSTavLocal]]

(if: $MessanaDrink is 1)[[Leave to the ship|P1PSTavLeave]]

–––––––––––––––––
^^34 ^^ Casson, //The Ancient Mariners//, 204–5.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Pompey conducted a successful campaign against piracy in 67 BCE. His successful plan eliminated widespread piracy and led to the continuation and revival of the Roman Navy. While piracy was widely eliminated, it would still appear here and there within the Mediterranean, but the looming presence of the Roman Navy did help deter it.]</tw-passagedata><tw-passagedata pid="32" name="P1PSTavLocal" tags="" position="1325,900" size="100,100">Bringing your wine, you decide to talk to some of the locals, who happily greet and talk with you. You recount some of your recent travels and mention continuing on to Panormus. The locals seem to stiffen as they say, “Well…you know, there’s been a rise in pirates around here lately. No one is sure why, but be safe when you leave.”^^34^^

You nod, thanking them for their hospitality and conversation, rejoining your friends at their table. 

(Set: $PiracyAwareness to $PiracyAwareness + 1)

[[Talk to crew|P1PSTavCrew]]

(if: $MessanaDrink is 1)[[Leave to the ship|P1PSTavLeave]]

–––––––––––––––––
^^34 ^^ Casson, //The Ancient Mariners//, 204–5.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Pompey conducted a successful campaign against piracy in 67 BCE. His successful plan eliminated widespread piracy and led to the continuation and revival of the Roman Navy. While piracy was widely eliminated, it would still appear here and there within the Mediterranean, but the looming presence of the Roman Navy did help deter it.]
</tw-passagedata><tw-passagedata pid="33" name="P1PSTavLeave" tags="" position="1200,1000" size="100,100">You and the crew stumble back to the ship, Cheops has his arms over your shoulder as he loudly tries to lead the crew in various sea shanties. You laugh at their antics. You all arrive back to the ship in one piece and quickly pass out, praying to sleep off the alcohol before your departure tomorrow. 

[[Go to sleep|P1PSPStart]]</tw-passagedata><tw-passagedata pid="34" name="P1PSPStart" tags="" position="1200,1125" size="100,100">The next morning you wake with a slight hangover, nothing that some bread, olive oil, and fish doesn’t help. You and Cheops begin to order the other crew members around as they pack on both the new cargo from Messana. 

You leave the harbor, only to shortly after see some ships approaching...[[^^1^^|P1PSPStartCP]]

(if: $PiracyAwareness is 1 or 0)[[ARE THOSE PIRATES?!|P1PSPShock]] (if: $PiracyAwareness is 2)[[Pirates. You have GOT to be kidding me.|P1PSPDamn]]</tw-passagedata><tw-passagedata pid="35" name="P1PSPShock" tags="" position="1100,1250" size="100,100">You yell out, “Pirates?! What in Tartarus!” The crew rushes aboard, trying to quickly gather weapons to fight. Looking at your father, whose face wears a hardened expression, you decide…

[[Join the crew and fight|P1PSPFight]]

[[Throw cargo overboard|P1PSPCargo]]</tw-passagedata><tw-passagedata pid="36" name="P1PSPDamn" tags="" position="1300,1250" size="100,100">You smack your palm to your hand in frustration, “I cannot believe everyone in Messana was right.” The crew rushes aboard, trying to quickly gather weapons to fight. Looking at your father, whose face wears a hardened expression, you decide…

[[Join the crew and fight|P1PSPFight]]

[[Throw cargo overboard|P1PSPCargo]]

[[Send those pirates a message|P1PSPFire]]</tw-passagedata><tw-passagedata pid="37" name="P1PSPFight" tags="" position="1100,1375" size="100,100">You rush onto the main deck with the others, grabbing a sword and helping Cheops maintain order. The pirates get closer, and the main ship nearly grazes //The Akhet//, you all lurch forward when suddenly a group of pirates jump onto the deck. You fight them as best as you can, your Father, Hakor, and a few veteran crew members expertly handle the sails to help create a gap between the ships.

After creating a gap between the ships, you and Cheops are able to successfully order the crew to encircle the abandoned pirates and disarm them...

[[Kill them|P1PSPFightKILL]]

[[Spare them|P1PSPFightSPARE]]

(Set: $PirateFightStorySpare to 0)

(Set: $PirateFightStoryKill to 0)

(Set: $GreekFire to 0)</tw-passagedata><tw-passagedata pid="38" name="P1PSPCargo" tags="" position="1250,1375" size="100,100">You see Cheops, attempting to maintain order among the crew, you rush up to him, grabbing his hand and rushing below the deck, “Help me throw some cargo overboard!” Cheops argues before you cut him off, “Cheops! We don’t have time! This will be the perfect diversion.”

[[Grab spare crates and bring them atop|P1PSPCargo2]]

(Set: $PirateCargoStory to 0)
(Set: $GreekFire to 0)</tw-passagedata><tw-passagedata pid="39" name="P1PSPFire" tags="" position="1400,1375" size="100,100">You see Cheops, attempting to maintain order among the crew, you rush up to him, grabbing his hand and rushing below the deck, “Cheops! Help me find this potion!” Cheops argues before you cut him off, “Cheops! We don’t have time! This will be the perfect attack, it is ancient magic. My mother told my father about it and he always keeps some onboard since then.”[[^^1^^|P1PSPFireCP]]

[[Find the various jars and bring them atop|P1PSPFire2]]

(Set: $GreekFire to 0)

(Set: $PirateFireStory to 0)</tw-passagedata><tw-passagedata pid="40" name="P1PSPFightSPARE" tags="" position="1025,1500" size="100,100">You, looking at Cheops, shake your head, holding your swords up. You approach the now unarmed pirates and tell them they will be taken to Panormus where they will be left with authorities. Cheops orders the crew to gather chains and bring them below deck to monitor them.

[[The rest of the short journey to Panormus remains uneventful|P1PanStart]]

(Set: $PirateFightStorySpare to 1)</tw-passagedata><tw-passagedata pid="41" name="P1PSPFightKILL" tags="" position="1175,1500" size="100,100">You, looking at Cheops, nod and give the order to kill the pirates. You all sigh in relief as you bring the bodies below the deck. Even though they were pirates, no one deserves a watery grave. The crew agrees to bury them upon landing at Panormus.

[[The rest of the short journey to Panormus remains uneventful|P1PanStart]]

(Set: $PirateFightStoryKill to 1)</tw-passagedata><tw-passagedata pid="42" name="P1PSPCargo2" tags="" position="1300,1500" size="100,100">As you and Cheops awkwardly ascent the stairs to the main deck, where your father loudly groans, “[$name]! Are you joking? Now is not the time to do that!”

He gestures around to the chaos of the pirates, looking at Cheops, you exaggeratedly respond, “Oh yes, Father! I know it is not the time to move our most precious cargo! But I wanted to make sure we could keep a close eye on it.” 

You look at Cheops with wide eyes, and nod your head, encouraging him to continue the ruse, “Oh…oh…Uhhh…Yes Captain! I know, I tried to tell [$name] here not to do that but (if: $gender is &quot;Female&quot;)[she] (if: $gender is &quot;Non-Binary&quot;)[they] made me, sir.” 

Hakor, the quiet and everly clever head navigator catches onto your attempted trick, yelling with the most genuinity, “Captain! I recognize that crate! That holds spices from the East!”[[^^1^^|P1PSPCargo2CP]]

Your father, completely focused on not crashing //The Akhet//, groans, “Dear Gods, Hakor! I could give a shit about that damned crate!”

[[A strange voice yells out...|P1PSPCargo3]]</tw-passagedata><tw-passagedata pid="43" name="P1PSPCargo3" tags="" position="1300,1625" size="100,100">“If you truly do not care about that damned crate containing silk from the East, you will throw it overboard and we will go our separate ways.” Before your Father can even argue, you and Cheops haul the crate overboard and yell to make haste. Despite your Father’s loud protests, he follows your order, showing his unshaken trust in you.

Upon leaving the pirates in the distant horizon, your Father surrenders his commander to Hakor with a threatening glance, who pretends he does not see it. Your father approaches you and Cheops in anger, “[$name]! What in //dis// was that back there?!”

Suddenly realizing how ridiculous your trick was, you lean forward from laughter saying, “Father! I would never throw overboard any cargo. Especially silk!” Your father, lightens at your joy and begins to laugh himself, “Wait. You mean to tell me you threw overboard an empty crate?” 

Cheops, in hysterical laughter hoarsely states, “Absolutely, Captain! [$name] here has the wit and mischief of Ulysses himself!” The crew all around you, suddenly piecing together the story, begin to fall into laughter, relieved at not having to fight and being safe from the pirates.

[[The rest of the short journey to Panormus remains uneventful and filled with fits of laughing and banter|P1PanStart]]

(Set: $PirateCargoStory to 1)</tw-passagedata><tw-passagedata pid="44" name="P1PanStart" tags="" position="1050,1625" size="100,100">Upon reaching the port city of Panormus, the crew aids with docking the ship. Similar to docking in Messana, your father debriefed the crew, “Everyone! Given the rather unorthodox trip here,” the crew celebrates the successful subduction of the pirates, “Settle down! Settle down…Now, I have decided to elongate our stay in Panormus. We shall leave in three days&#39; time at daybreak. You can rest on the ship or in the city, as long as you all are present when we undock in three days&#39; time.”

[[The crew celebrates and begins to slowly trickle off the ship|P1PanStart2]]</tw-passagedata><tw-passagedata pid="45" name="P1PSPFire2" tags="" position="1450,1500" size="100,100">As you and Cheops ascend the stairs to the main deck, your hands filled with jars, your father cautiously advises, “[$name], is that what I think it is?” 

Before you reply, Cheops opens a jar, and lights the cloth starter from a nearby brazier and throws it at the pirate ship. His aim hits their main sail, which erupts into flame.^^49^^

You follow his lead, lighting and throwing a few of the jars at the ship, which quickly becomes engulfed in flame, as your Father utilizes their shock to gain distance from them. 

[[Sigh in relief|P1PSPFire3]]

–––––––––––––––––
^^49 ^^Mikalson, Petrovic, and Petrovic, //Ancient Greek Religion//, 216–18.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Fire was located within protected hearths on ships as it warmed and cooked the food onboard. This hearth allows Cheops the ability to light his vial of Greek fire before throwing it towards the pirates.]</tw-passagedata><tw-passagedata pid="46" name="P1PSPFire3" tags="" position="1450,1625" size="100,100">Upon leaving the pirates in the distant horizon, your Father surrenders his commander to Hakor. Your father approaches you and Cheops in anger, “[$name]! What in //dis// was that back there?!” 

You shrug your shoulders as you hold onto the few remaining jars. He sighs deeply, slightly smiling as he shakes his head, “That was incredibly dangerous and daring. If it weren’t for that stunt of yours, I’m not sure how we would have escaped.” 

You smile deeply, Father turns to Cheops, “And you. That was excellent aim! You got their main sail with your first throw!” Cheops smiles and bows his head before replying, “Thank you, Captain. //The Akhet// is my home and I will gladly defend her.” 

Your father nods, then eyeing the various remaining jars in both of your arms, stiffens before quietly saying, “Uhhh…let’s put those away.” You look down and then awkwardly chuckle before shuffling towards the cargo hold with Cheops following.

[[The rest of the short journey to Panormus remains uneventful and filled with fits of laughing and banter|P1PanStart]]

(Set: $GreekFire to 1)

(Set: $PirateFireStory to 1)</tw-passagedata><tw-passagedata pid="47" name="P1PanStart2" tags="" position="875,1625" size="100,100">Your father pulled you, Cheops, and Hakor aside prior to docking to inform you that during the stay, you all had been invited to reside at Maximinus’ villa, the Roman business partner. You and Cheops, with your personal bags, chatter on the dock near the ship, when the sound of a horse’s hooves clopping on the stones draws your attention.

[[//Adamantios, you have been requested at the Villa of Cornelius Sisenna.//|P1PanStart3]]</tw-passagedata><tw-passagedata pid="48" name="P1PanVilla" tags="" position="1000,1750" size="100,100">Despite his smiling face, his eyes looked slightly sunken in, holding the passions of Mars, and his face bore the burden of exhaustion. Something about him made you suspicious. 

Your father happily greeted him with a hug, “Maximinus! It has been too long. Wonderful to see your smiling face.” Maximinus nodded lightly, a small smile on his face, he turned to you all. 

His eyes fell upon you, like a hungry wolf, “You must be [$name], I have heard so much.” You nodded, “Yes I am. It is nice to meet you as well, I have heard much about you too.” He nodded before introducing himself to Cheops and Hakor.

Entering the villa’s atrium with Maximinus and your father leading, you walk gingerly with Cheops at your side, both of you sharing a glance.

Maximinus turned dramatically, flaring his arms out, “Please make yourselves comfortable. As my guests I encourage you to feel like my house is your home. Each of you has a room awaiting, my servant shall take you to them.” You, Cheops, and Hakor nodded before being whisked away, your father following Maximinus into the tablinum.[[^^1^^|P1PanVillaCP]]

[[Unpack and settle into the room|P1PanVilla2]]</tw-passagedata><tw-passagedata pid="49" name="P1PanVilla2" tags="" position="1150,1750" size="100,100">You look around the room, the detailing on the walls overcomes you. Richly painted, detailed, and almost, busy, the careful depictions of landscapes shocks you. The room is richly ornamented that you cannot look away from the walls. [[^^1^^|P1PanVilla2CP]]

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/247017/540536/main-image&quot; width=&#39;600&#39;\&gt; 
&lt;/center&gt;

[[Look at the bed|P1PanVilla2bed]]

[[Look at the chest|P1PanVilla2chest]]

[[Take a nap|P1PanVilla2Nap]]</tw-passagedata><tw-passagedata pid="50" name="P1PanVilla2bed" tags="" position="1025,1875" size="100,100">You press your hand onto the bed, shocked at its softness. You have never felt a bed as comfortable, almost like a cloud. You look at the opulently patterned pillows and various blankets, “This is how Romans show their wealth and status, through desired and covertly luxurious everyday items.”[[^^1^^|P1PanVilla2bedCP]]

[[Look at the chest|P1PanVilla2chest]]

[[Take a nap|P1PanVilla2Nap]]</tw-passagedata><tw-passagedata pid="51" name="P1PanVilla2chest" tags="" position="1275,1850" size="100,100">You gaze at the chest near the bed, you decide to unpack your clothes from your bag, keeping the personal objects in your bag. 

[[Look at the bed|P1PanVilla2bed]]

[[Take a nap|P1PanVilla2Nap]]</tw-passagedata><tw-passagedata pid="52" name="P1PanVilla2Nap" tags="" position="1150,1925" size="100,100">Despite the sun at its apex, you find yourself exhausted from the pirates, drifting to sleep on the bed. As you fall deeper into the influence of Hypnos, you have one last thought, “This bed is so comfortable, I don’t think I can ever sleep on that hammock again.”

[[Fall asleep|P1PanN1a]]</tw-passagedata><tw-passagedata pid="53" name="P1PanN1b" tags="" position="1300,2025" size="100,100">As you enter the room, you find your father, Maximinus, Cheops, and Hakor lounging on the various couches with various plates of mouth-watering food. Fruits, cheeses, breads, meats, fish, and wine strung about the room. You feel yourself salivate, reminding yourself of your manners, you quickly bow to Maximinus and thank him for his hospitality. Your father subtly nods in approval at your proper behavior. Maximinus urges you to sit and enjoy the feast.[[^^1^^|P1PanN1bCP]]

(if: $PirateCargoStory is 1 or &gt;1)[[Sit next to Cheops|P1PanN1c]] (if: $PirateFireStory is 1 or &gt;1)[[Sit next to Cheops|P1PanN1c]] (If: $PirateFightStorySpare is 1 or &gt;1)[[Sit next to Cheops|P1PanN1d]] (if: $PirateFightStoryKill is 1 or &gt;1)[[Sit next to Cheops|P1PanN1d]]</tw-passagedata><tw-passagedata pid="54" name="P1PanN1a" tags="" position="1150,2050" size="100,100">You jerk yourself awake, rapidly blinking away the sleep, finding the outside has turned to night. You groan as you pick yourself up, hearing sounds of chatter and clattering of plates.

[[Go to tablinum|P1PanN1b]]</tw-passagedata><tw-passagedata pid="55" name="P1PanN1c" tags="" position="1100,2175" size="100,100">As you sit next to Cheops, he whispers to you, “We must tell him the story of the pirates, to provide entertainment.” You agree and find Cheops staring at you, “What?!” He shakes his head, choking on a gulp of wine, “[$name]!! You must tell the story!”

[[Ugh, fine! I will tell it|P1Pan1c1]]</tw-passagedata><tw-passagedata pid="56" name="P1PanN1d" tags="" position="1275,2200" size="100,100">As you sit next to Cheops, Maximinus looks at you all, “A kind friend informed me of a rather precarious situation at the docks today...

(if: $PirateFightStoryKill is 1 or &gt;1)[He claims he saw your crew drag and bury bodies outside of the city. Tell me, who were they?” The air becomes rather awkward as your father says, “Ah…Yes, we had a run-in with pirates this morning. Cheops and [$name] were able to successfully subdue the few who managed to make it onto //The Akhet//. Despite being pirates, we decided to keep them aboard so we could properly bury them.”] (if: $PirateFightStorySpare is 1 or &gt;1)[He claims he saw a group of men in chains be escorted to the military camp prison. Tell me, who were they?” The air becomes rather awkward as your father says, “Ah…Yes, we had a run-in with pirates this morning. Cheops and [$name] were able to successfully subdue the few who managed to make it onto //The Akhet.// Despite being pirates, we decided to keep them alive so justice could be given.”] 

(if: $PirateFightStoryKill is 1 or &gt;1)[Maximinus nods as he drinks his wine, “How noble of you all to do that.” You nod before replying, “Respecting the dead is a basic decency…No one deserves to have the seas as their grave. They have no chance of rest.” Maximinus pauses slightly before quietly saying, “I agree…the seas are no place for final rest.”] (if: $PirateFightStorySpare is 1 or &gt;1)[Maximinus nods as he drinks his wine, “How noble of you all to do that.” You nod before replying, “Respecting the living is a basic decency…No one deserves to be killed without due process, especially with the seas as a grave.” Maximinus pauses slightly before quietly saying, “I agree…the seas are no place for final rest.”][[^^1^^|P1PanN1dCP]]

[[The night continues with your father and Maximinus exchanging stories until you go to bed, exhausted from the late hour and wine|P1PanD2]]</tw-passagedata><tw-passagedata pid="57" name="P1Pan1c1" tags="" position="1100,2300" size="100,100">Cheops attempts to bat his eyes like a beautiful damsel, you shake your head in false frustration at his antics as you begin to tell the story, “Maximinus, has my father told you of our rather chaotic encounter this morning?”

Maximinus, shaking his head in intrigue, turns to your Father, “Adamantios, have you been withholding stories from me?”

Your father chuckles, his goblet of wine sloshing slightly, “I would never, dear friend! I merely knew that stories are best shared over good food, good wine, and good company.”

(if: $PirateCargoStory is 1 or &gt;1)[You continue before telling the tale of your idea to trick the pirates with false cargo. As you tell the tale, Hakor interrupts to add his own rendition of the story and his knowledge that you and Cheops would struggle as actors. Laughter and false arguments over specific details fill the room and the night.] (if: $PirateFireStory is 1 or &gt;1)[You continue before before telling the tale of your search for the ancient magical fire jars. As you tell the tale, your father interrupts with his own anecdote on how he came to acquire the fire from your mother. Hakor even adds his own account of the shock at witnessing the pirate ship engulfed in flames! Laughter and overall bewilderment fill the room and the night.]

(if:$PirateFireStory is 1 or &gt;1)[[You go to bed that night with a smile on your face, falling asleep quickly with aid from the wine and late hour.|P1PanD2]] (if: $PirateCargoStory is 1 or &gt;1)[[You go to bed that night with a lingering giggle and a smile on your face, falling asleep quickly with aid from the wine and late hour.|P1PanD2]]</tw-passagedata><tw-passagedata pid="58" name="P1PanD2" tags="" position="1275,2325" size="100,100">Waking up in the morning, you feel well rested. You get dressed and go downstairs to the courtyard, where your Father sits on a bench looking at the foliage. 

Upon seeing you walk up he smiles and pats the open space next to him, “Ah my sweet, please come sit.” As you sit next to him, he throws his arm around you and happily exhales, “Isn’t this Villa beautiful?” You nod, he continues, “Yes. I want you to go to the market,” he thrusts a small pouch of coins into your palm, “Find a suitable gift for Maximinus. Do not fret, he is easy to please.” 

You nod and he smiles. You sit in comfortable silence until Maximinus emerges from the tablinum where your father stands up, pats your arm and the two enter the room again.[[^^1^^|P1PanD2CP]]

[[Walk to the marketplace.|P1PanD2Market]]</tw-passagedata><tw-passagedata pid="59" name="P1PanD2Market" tags="" position="1275,2500" size="100,100">As you enter the marketplace in town, you look around and see a variety of stalls selling spices, clothing, jewelry, craftsmen products, and other goods. You feel the pouch of coins your father gave you, there’s enough to purchase one item. 

[[Go to the craftsman stall|P1PanD2MarketCraft]]

[[Go to the jewelry stall|P1PanD2MarketJewel]]</tw-passagedata><tw-passagedata pid="60" name="P1PanD2MarketCraft" tags="" position="1375,2625" size="100,100">You walk by a stall where a young boy stands, his head barely over the table, you gape at the sight. He notices, “Hey! Want to purchase some pottery? Made from real Greek clay! High quality goods.” You slightly smirk at his words, deciding to take a look.

[[Examine red gloss ware|P1PanD2MarketCGloss]]

[[Examine figurine|P1PanD2MarketCFigurine]]

[[Go to another stall|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="61" name="P1PanD2MarketJewel" tags="" position="1150,2625" size="100,100">You decide to stop at a jewelry stall, the gold catching your eye. The pieces are beautiful, encrusted with common gemstones. The woman sees you eyeing her pieces, “Is anything catching your eye?”

[[Examine necklace|P1PanD2MarketJNeck]]

[[Examine a ring|P1PanD2MarketJRing]]

[[Go to another stall|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="62" name="P1PanD2MarketStalls" tags="" position="1125,2450" size="100,100">[[Go to the craftsman stall|P1PanD2MarketCraft]]

[[Go to the jewelry stall|P1PanD2MarketJewel]]</tw-passagedata><tw-passagedata pid="63" name="P1PanD2MarketJRing" tags="" position="1025,2750" size="100,100">You pick up a golden ring impressed in red with Jupiter. The woman smiles, “These are very fashionable with men.”[[^^1^^|P1PanD2MarketJCP]]

&lt;center&gt; &lt;img src=&quot;https://media.britishmuseum.org/media/Repository/Documents/2022_7/19_11/ffd71abf_4659_4143_9a3e_aed700c1fc46/mid_GAA29736__1_.jpg&quot; width=&#39;300&#39;\&gt; 
&lt;/center&gt;

[[Purchase the ring.|P1PanD2Tav]]

[[Look at the other piece.|P1PanD2MarketJNeck]]

[[Go to another stall.|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="64" name="P1PanD2MarketJNeck" tags="" position="850,2750" size="100,100">You look at a necklace with an inlaid amethyst crystal. You pick it up, “This is beautiful.” She smiles, “Yes. Amethyst is a popular gemstone. Very beautiful and regal.” You nod.[[^^1^^|P1PanD2MarketJCP]]

[[Look at the other piece.|P1PanD2MarketJRing]]

[[Go to another stall.|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="65" name="P1PanD2MarketCGloss" tags="" position="1500,2750" size="100,100">You closely examine a red gloss ware. 

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/250773/531215/main-image&quot; width=&#39;300&#39;\&gt; 
&lt;/center&gt;

The boy pipes up, “You have a good eye!” You raise an eyebrow at his words and wonder if he has memorized a script, “Hmm. Can you tell me about this?” The boy hums as he begins to talk about toreutics with metal and the visuals of vines, leaves, animals, and classical scenes. &quot;This red ware used to have a sister piece, until that rich man in town purchased it. He always buys the nicest and most expensive art pieces!” 

The boy looks you up and down, “I don’t think you can afford it.” You chuckle lightly at his forwardness, “He commissioned me to make a decorative pot in honor of his dead son after he bought the ware. He gave me so much denarii! I hope he asks me to make him more pots in the future.” [[^^1^^|P1PanD2MarketCGlossCP]]

Your eyes widened, so Maximinus lost a son…

[[Examine the figurine.|P1PanD2MarketCFigurine]]

[[Go to another stall.|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="66" name="P1PanD2MarketCFigurine" tags="" position="1350,2750" size="100,100">You look at a figurine that has a man holding another man on his shoulders and a young child. The boy notices, “This is a figurine of Aeneas, his father Anchises, and his son Ascanius or Iulus fleeing Troy.” You nod, the names sounding vaguely familiar. 

The boy abruptly asks, “Do you know the story? It’s really popular. Virgil wrote it, then he died, but Caesar Augustus published it! You must not be Roman.” 

You shake your head, “I’m Egyptian.” The boy’s eyes widened in interest, “What?! I have never met an Egyptian!” You smile as he asks you all kinds of outlandish questions about Egypt and Egyptians.[[^^1^^|P1PanD2MarketCFigurineCP]]

[[Purchase the figurine.|P1PanD2Tav]]

[[Examine the red gloss ware.|P1PanD2MarketCGloss]]

[[Go to another stall.|P1PanD2MarketStalls]]</tw-passagedata><tw-passagedata pid="67" name="P1PanD2Tav" tags="" position="1475,2900" size="100,100">After purchasing the gift, you begin to walk through town towards the villa until you recognize Cheops who bounds towards you, “[$name]! Let’s go to the tavern!”

[[Go to the tavern!|P1PanD2Tav2]]</tw-passagedata><tw-passagedata pid="68" name="P1PanD2Tav2" tags="" position="1325,2900" size="100,100">You go into the local tavern, recognizing a couple crew members passed out at tables, clearly having drank themselves to sleep. 

A middle aged woman wearing an apron angrily wipes at their table, “Damned scumbags! Every damn time any ships land, they all flock to alcohol like flies on shit!” You and Cheops stifle a giggle as you carefully approach the counter, patiently waiting for the woman to return.

[[Wait patiently.|P1PanD2Tav3]]</tw-passagedata><tw-passagedata pid="69" name="P1PanD2Tav3" tags="" position="1175,2900" size="100,100">You notice a shield and sword hung behind the counter along with a red cape, staples for soldiers in the Roman Army.

The woman, noticing you and Cheops’ presence, stomps over, “I certainly hope you two aren’t with them.” She points towards your intoxicated crew mates, you and Cheops share a glance, “No ma’am! We don’t know them.” She huffs, “Good! Because I am sick of those scumbags.”

You order some light wine from her, both you and Cheops silently agreeing not to get too drunk around her, in fear you will also become “Scumbags”.

[[Enjoy the drink and talk to the woman.|P1PanD2Tav4]]</tw-passagedata><tw-passagedata pid="70" name="P1PanD2Tav4" tags="" position="1025,2900" size="100,100">The woman, having introduced herself as Sabina, began to tell you and Cheops of her life, “I wasn’t from Panormus originally. My husband was!” She points towards the sword, shield, and cape on the wall, “That bastard married me, took me from Pompeii and dumped me here, only to go fight off in the civil war and die! Well, look who&#39;s laughing now, Junius!” 

You respond, “I’m sorry for your loss ma’am, I am sure he died with honor. At least you have some of his items to remember him by.” She nods, “Yes, thank you. Junius was a good man. Not the brightest bunch, given he died fighting for Antony, but he was my husband.” 

Cheops asks, “Antony? Junius did not fight for Augustus?” 

She laughs, “//Dis// no! Please, Augustus is nothing without his dear Agrippa holding his hand. Say what you want about Antony, but I believe we would have been much better off had he won. Augustus was a child! A spoiled brat! Antony had experience.” You nod and drink your wine, she quickly adds, “And I’m not the only one around here who thinks that.”[[^^1^^|P1PanD2Tav4CP]]

[[Ask about the shield, sword, and cape.|P1PanD2Tav5]]</tw-passagedata><tw-passagedata pid="71" name="P1PanD2Tav5" tags="" position="875,2900" size="100,100">“Ah those…my husband happened to die not at Actium somehow, but was stabbed in the back by his own legion! Can you believe that? They surrendered to Augustus and when my husband refused, he was killed. Augustus at least had the decency to allow him to be brought home and buried.” You nod, “That is very saddening, ma’am.” She nods, “Yeah it is, and call me Sabina, ma’am makes me sound old. Why do you two ask?” You and Cheops shake your head quietly replying, “We are Egyptian, ma– Sabina.” She laughs a little, “Then you understand what I’m saying.”

[[Ask if she has anything else from her husband|P1PanD2Tav5a]]

[[Ask about Maximinus|P1PanD2Tav5b]]

[[Go back to the villa|P1PanN2]]</tw-passagedata><tw-passagedata pid="72" name="P1PanN2" tags="" position="1025,3050" size="100,100">You and Cheops finished your drinks, bade goodbye to Sabina, and made your way back to the Villa.

Upon returning, you gave your father the gift you purchased and enjoy one last dinner with everyone before retiring to bed.

[[Toss and turn|P1PanN2a]]

(Set: $eveningvillawalk to 0)

(Set: $eveningvillasnack to 0)</tw-passagedata><tw-passagedata pid="73" name="P1PanD2Tav5a" tags="" position="750,3000" size="100,100">“You know what? I actually do.” She leans over and reaches below the counter, grabbing a lightly dyed pink pouch, “A wedding gift. I kept it and now it holds this.” She pulls out a coin.

&lt;center&gt; &lt;img src=&quot;https://studylib.net/flashcards/cardimage2/add6cafc/568/8568031_face.png&quot; width=&#39;300&#39;\&gt; [[^^1^^|P1PanD2Tav5aCP]]
&lt;/center&gt;

It is one of Antony’s, you recognize it from a collection your father has, he tries to keep a coin of each minting whenever it comes into his possession. You smile, “That is lovely, Sabina. My father has a couple of Antony’s coins, he says he always liked how rebellious and cheeky Antony was.” She laughs, “I know, right? I think we all need that.”

[[Ask about Maximinus|P1PanD2Tav5b]]

[[Go back to the villa|P1PanN2]]</tw-passagedata><tw-passagedata pid="74" name="P1PanN2a" tags="" position="1200,3050" size="100,100">As you lay in bed, you find yourself thinking about all that you have learned in Panormus about Maximinus. Despite having to be up early the next day, you cannot seem to quiet your thoughts...

[[Go on an evening walk through the villa.|P1PanN2bw]]

[[Go to the kitchen for a late night snack.|P1PanN2bk]]</tw-passagedata><tw-passagedata pid="75" name="P1PanN2b" tags="" position="1500,3050" size="100,100">Maximinus responds, “It better be, agents from across the Mediterranean await our arrival for the plan to begin” You halt in your steps, after a moment he continues, “Adamantios, all of our years of work has been for this final moment, we must not fail, you are positive your (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child] will aid?” 

Your father responds, “Maximinus, do not worry over my (if: $gender is &quot;Female&quot;)[daughter](if: $gender is &quot;Non-Binary&quot;)[child], concern yourself with–” 

[[You quietly gasp and their talking ceases.|P1PanN2c]]</tw-passagedata><tw-passagedata pid="76" name="P1PanN2c" tags="" position="1650,3000" size="100,100">Your father leaves the tablinum, seeing you standing there, “My sweet!” He approaches you, you quickly shake yourself from the shock and happily greet him, acting like you heard nothing, “What are you doing up?”

(if: $eveningvillawalk is 1)[“I could not sleep, so I decided to enjoy the villa one last time before we left for Rome.” Your father nods and begins to walk with you, “It is late, we have an early day tomorrow.” As he walks away with you back towards the guest rooms, Maximinus says, “Adamantios…we will continue this tomorrow.” Your father waves him off and the two of you retire to your rooms.] (if: $eveningvillasnack is 1)[“I could not sleep, so I wanted to enjoy a late night snack before we left for Rome.” Your father nods and begins to walk with you, “It is late, we have an early day tomorrow.” As he walks away with you back towards the guest rooms, Maximinus says, “Adamantios…we will continue this tomorrow.” Your father waves him off and the two of you retire to your rooms.]

[[You find yourself concerned, but exhausted from the traveling during the stay, drifting off to flashes of your memory.|P1PanD3]]</tw-passagedata><tw-passagedata pid="77" name="P1PanD3" tags="" position="1575,2450" size="100,100">You wake the next day to your Father’s presence, he smiles and tells you, “Time to get up, my sweet!” You groan slightly, “Ughh…do we have to?” Your father laughs a little, petting your cheek before patting it, “Yes my dear, come, get dressed, pack, grab bread, and we must leave to reach //The Akhet// to reach Rome.” You nod and he leaves.

You get dressed, packing your bag and grabbing it as you descend towards the atrium.

[[Enter the atrium|P1PanD3a]]</tw-passagedata><tw-passagedata pid="78" name="P1PanD3a" tags="" position="1600,1700" size="100,100">Hakor and Cheops wait by the atrium. Cheops brightens upon seeing you, “[$name], I feel like I barely saw you yesterday!” 

You smile and lightly elbow him, “Cheops, how can you even say that!&quot; He looks at you, with slight bewilderment before the two of you begin to laugh recalling the tavern as you continue, &quot;Either way, we will be back on the ship soon, so you will not be able to get rid of me!” He beams and laughs, “Excellent! I miss it!” You gently say, “Me too.” 

Father and Maximinus appear, bags in hand, and you all leave to //The Akhet//.

[[Walk to the dock.|P1PanD3b]]</tw-passagedata><tw-passagedata pid="79" name="P1PanD3b" tags="" position="1625,475" size="100,100">The crew lays about the deck, your father announcing, “Morning, crew! I pray you all are prepared for our journey to Rome! Let us undock and reach the high seas!” 

The crew yells in excitement and begins to prepare, Maximinus joins your Father and Hakor on the helm.

[[//Untie the knots, open the sails, and go into the seas.//|P2JRomeD1]]</tw-passagedata><tw-passagedata pid="80" name="P2JRomeD1" tags="" position="2100,100" size="100,100">It has been a day since leaving Panormus, the voyage has been relatively normal with the swift winds behind the sails. Maximinus’ presence on the ship feels off, he sticks out like a sore thumb. 

You find yourself watching him without meaning to, Cheops has to keep nudging you to keep you focused. 

You can’t quite shake the feeling that something is off with him…

[[Go to the helm.|P2JRomeD1a]]</tw-passagedata><tw-passagedata pid="81" name="P2JRomeD1a" tags="" position="2250,225" size="100,100">On the helm with Cheops, Hakor, and your Father. You all look over navigatory, naval, and geographic maps as your father explains, “In order to reach Rome, we must dock //The Akhet// in Rome’s port city, Ostia. Cheops, I want you to maintain watch over her and the crew during our stay.” 

You see Cheops slightly deflate but he nods, “Yes Captain.” Your father continues, “Keep the crew near the ship as I will send you word to prepare her. We should not be more than 5 days at the most.” [[^^1^^|P2JRomeD1aCP]] 

As your father talks, you spy Maximinus slowly pacing near the stern, he looks entirely too pleased given all the tragedies you learned in Panormus.

[[Begin your tasks.|P2JRomeD1b]]</tw-passagedata><tw-passagedata pid="82" name="P1PanD2Tav5b" tags="" position="875,3050" size="100,100">Sabina looks out, deep in thought, &quot;A prostitute around here, Julia. She often sees him, but the strangest thing. He doesn&#39;t do anything, he just wants someone to talk to him. You see, his son died and his wife left him. Rumor is she left to Athens, but no one knows.” 

You nod, “I’ve heard of his tragedies. I had no idea how much sorrow he has faced.” 

Sabina nods, “Yes, it is quite unfortunate. All he has left is his daughter, but she had to leave to Rome once she became of age...So he lives here all alone...&quot; She shakes her head, &quot;But enough about that!&quot;[[^^1^^|P1PanD2Tav5bCP]]

[[Ask if she has anything else from her husband|P1PanD2Tav5a]]

[[Go back to the villa|P1PanN2]]</tw-passagedata><tw-passagedata pid="83" name="P2JRomeD1b" tags="" position="2100,300" size="100,100">[[Clean the deck|P2JRomeD1c]]</tw-passagedata><tw-passagedata pid="84" name="P2JRomeD1c" tags="" position="1950,225" size="100,100">[[Shift the sails|P2JRomeD1d]]</tw-passagedata><tw-passagedata pid="85" name="P2JRomeD1d" tags="" position="1950,350" size="100,100">[[Go on watch with Cheops|P2JRomeD1e]]</tw-passagedata><tw-passagedata pid="86" name="P2JRomeD1e" tags="" position="2250,350" size="100,100">You and Cheops sit on the stern, near the bow, on lookout. The sun beginning to dip below the horizon.

As you look out, you see an imposing Imperial Roman ship, evident with the large eagle on its main sail. “Cheops, look!” You nudge him and he makes a sound, “Where the hell were they when we were getting attacked by pirates?” 

Cheops’ face breaks into a smile as he goads, “They were on their way…just slightly blown off course, you know Romans, so frightened of the seas.” You two laugh as the imperial ship lulls by.[[^^1^^|P2JRomeD1eCP]]

A voice in your head ponders, “I could never understand why Antony tried a naval battle against Agrippa and Augustus…”

[[Talk with Cheops|P2JRomeD1Chat]]</tw-passagedata><tw-passagedata pid="87" name="P2JRomeD1Chat" tags="" position="2100,425" size="100,100">“Cheops, have you ever navigated using the stars?” He looks up from his surveillance, “Yes. I have many times.” You hum, hoping he continues, “Well, I have always loved the water and the seas. I always wanted to be doing something with that and this ship allows me to.”

(Set: $JRomeChat to 0)

[[Yes, but when did you use the stars?|P2JRomeD1ChatS]]

[[Would you stay on //The Akhet// forever?|P2JRomeD1ChatA]]</tw-passagedata><tw-passagedata pid="88" name="P2JRomeD1ChatM" tags="" position="2100,550" size="100,100">Cheops cocks his head to the side, “I’m not sure, haven’t given him much thought. You?”

[[I agree.|P2JRomeD1ChatMa]]

[[I don’t know, I don’t trust him.|P2JRomeD1ChatMaa]] 

(Set: $MaximinusAwareness to 0)</tw-passagedata><tw-passagedata pid="89" name="P2JRomeD1ChatA" tags="" position="1950,475" size="100,100">(Set: $JRomeChat to $JRomeChat + 1)

He pauses, uncertain, “Maybe. I’m not sure. I’m happy right now. That’s what matters, right?” You nod, he asks, “Do you?” You shake your head, “I don’t know. Sometimes yes, but sometimes no.” He continues, “What would you do instead?” You pause, “I want to be a philosopher. I always wished I could study at the Library of Alexandria.” He nods and comfortable silence befalls you two.

[[When did you use the stars to navigate?|P2JRomeD1ChatS]]

(if: $JRomeChat is 1 or 2) [[What do you think about Maximinus?|P2JRomeD1ChatM]]</tw-passagedata><tw-passagedata pid="90" name="P2JRomeD1ChatS" tags="" position="2250,475" size="100,100">(Set: $JRomeChat to $JRomeChat + 1)

“You never answered my question.” 

Cheops chuckles lightly, “Ah, well. My mother used to take me to the many temples in Upper Egypt and one of the temples had a wall with people on a boat. I was so excited that my mother and father would take me out to the Western bank of the Nile, where no one would bother us, and tell me about the stars. I found myself desperate for an expedition of my own and tried to take a raft down the Nile using the stars to guide me.” 

He pauses and laughs, “I didn’t get very far before my parents caught me!”

[[Would you stay on //The Akhet// forever?|P2JRomeD1ChatA]]

(if: $JRomeChat is 1 or 2) [[What do you think about Maximinus?|P2JRomeD1ChatM]]</tw-passagedata><tw-passagedata pid="91" name="P2JRomeD1ChatMaa" tags="" position="2250,600" size="100,100">(Set: $MaximinusAwareness to 1)

“I don’t know, Cheops. Something seems off with him. I can’t quite place it.” 

He furrows his brows, “Maybe you’re right. He is a little off putting.” 

You two continue to watch the seas quietly. The coastline continues to guide your approach, until you and Cheops move towards the helm, satisfying the watch.

[[Walk towards the helm|P2JRomeD1Helm]]</tw-passagedata><tw-passagedata pid="92" name="P2JRomeD1ChatMa" tags="" position="1950,600" size="100,100">(Set: $MaximinusAwareness to 0)

“I agree, I mean he’s new and we don’t really know him.” 

Cheops agrees and you two continue to watch the seas quietly. The coastline continues to guide your approach, until you and Cheops move towards the helm, satisfying the watch.

[[Walk towards the helm|P2JRomeD1Helm]]</tw-passagedata><tw-passagedata pid="93" name="P2JRomeD1Helm" tags="" position="2100,675" size="100,100">As you approach the helm, you watch Maximinus quickly slide a piece of paper under an imposing map. Your father smiles and awkwardly chuckles, “My sweet, What are you doing back here?” 

In the corner of your eye, you think you see Hakor roll his eyes, but he moves so quickly towards the tent, you cannot be sure, “Uhh…just Cheops and I coming on the helm…Nothing out of the ordinary. Are you okay?” 

Your father’s eyes dart around, almost with a hint of fear, “Of course. Of course, yes. Yes, of course! Yes!” You and Cheops move back in a sense of bewilderment at his behavior, you elongate, “Okay. Well I suppose we will go back onto the main deck as we seem to be interrupting something.” 

[[Turn to leave|P2JRomeD1Helma]]</tw-passagedata><tw-passagedata pid="94" name="P1PanN2bw" tags="" position="1350,3025" size="100,100">(Set: $eveningvillawalk to 1)
As you walk towards the back courtyard, you pass near the atrium and the tablinum area where you overhear your father’s voice whispering, “We leave for Rome in the morrow…surely that is enough time.” 

[[Stop and listen...|P1PanN2b]]</tw-passagedata><tw-passagedata pid="95" name="P1PanN2bk" tags="" position="1350,3125" size="100,100">(Set: $eveningvillasnack to 1)
As you walk towards the kitchen, you pass near the atrium and the tablinum area where you overhear your father’s voice whispering, “We leave for Rome in the morrow…surely that is enough time.” 

[[Stop and listen...|P1PanN2b]]</tw-passagedata><tw-passagedata pid="96" name="P2JRomeD1Helma" tags="" position="2100,800" size="100,100">As the two of you make way to leave, Maximinus calls, “[$name]? Before you go, might I have a quick word?” 

You and Cheops share a quick glance before he continues on, you linger close towards the steps down the deck.

(if: $MaximinusAwareness is 0)[Maximinus begins, “I know that everything seems a little off, but I have had a business relationship with your father for a long time. I am here to help him establish a direct trading route to Rome. Truly, I wish the best for him…and for you. I hope that you can recognize this.”

You nod and continue, looking over your shoulder to see Maximinus watching you, almost like a predator stalking his prey. You feel a slight shiver and try to brush it off.] (if: $MaximinusAwareness is 1)[Maximinus begins, “I’ve heard some whispers among the crew about concerns with me. I figured that out of everyone here, you would have the most reservations about my presence. I wanted to try to remedy this, I have had a business relationship with your father for a long time. Genuinely, I am here to help him, but I cannot do that if I have to worry about you sniffing around mine and his business. You have to trust me, it’s for the best.” 

You furrow your eyebrows in confusion and fear, shakily nodding, and continuing on your way, looking over your shoulder to see Maximinus watching you, almost like a predator stalking his prey. You feel a slight shiver and try to brush it off.]

[[You go below deck to sleep for your night shift where you fall asleep to the rocking of the waves, anxiety, confusion, and concern filling your mind.|P2JRomeN1]]</tw-passagedata><tw-passagedata pid="97" name="P2JRomeN1" tags="" position="1950,850" size="100,100">Later that night, you find yourself sitting near the bord, Cheops having gone back to bed, Hakor, Maximinus, and your father also gone below deck. You sigh in frustration at the situation, feeling vastly suspicious of Maximinus. In the moonlight, some of the beads on the necklace shimmer.

[[Examine it.|P2JRomeN1e]]
</tw-passagedata><tw-passagedata pid="98" name="P2JRomeN1e" tags="" position="2250,850" size="100,100">Gingerly placing a bead between your fingers, you think about her soft but firm voice as she placed it around your neck, &quot;The gods will watch over you, my love, just as I always will.&quot; Standing in front of you, she took your fingers on each colored stone, explaining the meaning. &quot;The blue is for the sea, the red is for Isis&#39;s nurturing power, the green is for safe returns...&quot; She continued, going through each color and giving it a special meaning. The act of giving you the necklace felt sacred, almost as if she had transferred a piece of her own soul into the necklace. Her passing followed shortly after that.

The story of your beaded necklace reminds you of Isis who protected her child, Horus, against all odds. Like Isis, your mother tried to do the same by giving you the necklace, hoping it would grant safety, protection, and homecoming.

[[Sit in the quiet|P2JRomeN1Chat]]</tw-passagedata><tw-passagedata pid="99" name="P2JRomeN1Chat" tags="" position="2075,950" size="100,100">As you lament, you hear footsteps, which you immediately recognize as your father’s, “Father, you should be resting.”

He smiles, groaning slightly as he sits besides you, both your feet dangling off the ship’s side, “I would say the same for you, my sweet.” He sighs, “I didn’t want to do this but I’ve noticed your strange behavior since Panormus…I figured it had something to do with Maximinus.” 

It’s your turn to respond.

[[Agree with him|P2JRomeN1ChatA]]

[[Disagree with him|P2JRomeN1ChatD]]</tw-passagedata><tw-passagedata pid="100" name="P2JRomeN1ChatA" tags="" position="1950,1075" size="100,100">“Yes, you’re right. I just don’t trust him.” 

Your father nods, “I don’t expect you to trust him yet, but do you trust me?” You sheepishly nod as he continues, “Trust me, my (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child] when I tell you that Maximinus is an ally, not an adversary. What he and I are doing is for the business,” he gestures between you two, “our business. It’s for the future. I don’t expect you to understand fully but trust in me, your father.” You smile. “As a token for you, I wanted to give this to you.”

[[He passes you a pair of golden snake bracelets.|P2JRomeN1Bracelets]]</tw-passagedata><tw-passagedata pid="101" name="P2JRomeN1ChatD" tags="" position="2200,1075" size="100,100">“No Father, it is not like that, it’s just–” You stumble over your words as your father interjects, “I don’t expect you to trust him yet, but do you trust me?” You sheepishly nod as he continues, “Trust me, my (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child] when I tell you that Maximinus is an ally, not an adversary. What he and I are doing is for the business,” he gestures between you two, “our business. It’s for the future. I don’t expect you to understand fully but trust in me, your father.” You smile. “As a token for you, I wanted to give this to you.”

[[He passes you a pair of golden snake bracelets.|P2JRomeN1Bracelets]]</tw-passagedata><tw-passagedata pid="102" name="P2JRomeN1Bracelets" tags="" position="1950,1200" size="100,100">“I have carried it with me since her death all those years ago.” You nod, “You know, she always wanted you to have it. She said it would protect you.” He smiles, tears in his eyes as he helps put them on, they fit perfectly around your wrists. He brushes his hand on your cheek, “You look so much like her.”[[^^1^^|P2JRomeN1BraceletsCP]]

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/547710/1220399/main-image&quot; width=&#39;400&#39;\&gt; &lt;/center&gt;

[[Examine it.|P2JRomeN1Bracelets2]]</tw-passagedata><tw-passagedata pid="103" name="P2JRomeN1Bracelets2" tags="" position="2200,1200" size="100,100">“Where did she get this? These bracelets look like gold.” 

“It is, your mother got it as a gift from Queen Cleopatra. She was a palace attendant.” You nod, “She almost took her life with the Queen but Cleopatra convinced her to leave and come back to us. She told her that her life was not yet over.” 

You gape, he continues, “I wonder if the Queen knew that disease would ravage Alexandria and take your mother.” You nod, “Perhaps, but at least we got that time with her.” he smiles, patting your hand.

[[Enjoy the night with your father.|P2JRomeN1Leave]]</tw-passagedata><tw-passagedata pid="104" name="P2JRomeN1Leave" tags="" position="2075,1300" size="100,100">After quietly sitting together for a while, your father begins to get up. As he turns to leave, touching your shoulder, you gaze up and back at him, “I know you don’t trust Maximinus, but at least trust your father. Trust me and my judgment, my sweet.” he pets your hair in affection, his eyes looking deeply into yours, filled with love and sorrow. 

[[Sit quietly on the deck.|P2JRomeN1Ostia]]</tw-passagedata><tw-passagedata pid="105" name="P2JRomeN1Ostia" tags="" position="1950,1325" size="100,100">//The Akhet// begins to approach the harbor of Ostia shortly after your conversation with your father. 

[[The crew prepares to unload the cargo.|P2JRomeOstia]]</tw-passagedata><tw-passagedata pid="106" name="P2JRomeOstia" tags="" position="1950,1450" size="100,100">As the crew ties to //The Akhet// to port and begins to unload, you linger near Cheops, “Will you be okay?” 

“Pfft me?” He puffs his chest out, “I’ll be fine. What did Sabina call our crew? Scumbags? Well, I&#39;ll keep these scumbags in line.” You two chuckle before he grasps your shoulders causing you to gaze directly at him, “Promise me, [$name]. Be safe. Watch your father, we will be waiting.” 

You nod, he brings you toward him for a hug. You see your father, Maximinus, and Hakor waiting near a smaller ship, a barge, which goes directly to Rome via the Tiber.^^131^^

[[You approach the barge and with Hakor, begin to load the cargo.|P2JRomeOstia2]]

–––––––––––––––––
^^131^^ Aldrete, //Daily Life in the Roman City//, 199.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Following unloading, larger ships needed to ride offshore while river barges called //codicarius// transported goods up the Tiber directly to Rome.]</tw-passagedata><tw-passagedata pid="107" name="P2JRomeOstia2" tags="" position="2100,1425" size="100,100">A Roman soldier inspects cargo as Maximinus talks to the Captain who watches. You watch the two with intensity before your Father calls for your help. 

[[Sail up the River Tiber|P2JRomeOstia3]]</tw-passagedata><tw-passagedata pid="108" name="P2JRomeOstia3" tags="" position="2250,1425" size="100,100">You remain seated along the barge, watching as Rome gets closer and closer, almost hearing the roar of the city.^^132^^ It reminds you of Alexandria. The sea scent becomes quickly overtaken by the smell of people, work, and the urban space. You certainly did not miss that smell.

[[Arrive in Rome|P2JiRomeD1]]

–––––––––––––––––
^^132^^ Aldrete, //Daily Life in the Roman City//, 199-200.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[The journey on the //cardicarri// was 32 kilometers total and took three days as the barges were towed by men and animals along the river bank. Unlike in reality, //Winds of Actium// decreases this journey to last a few hours as //The Akhet// docks in Ostia in the night and arrives in Rome the next day.]</tw-passagedata><tw-passagedata pid="109" name="P2JiRomeD1" tags="" position="2225,1550" size="100,100">Upon reaching Rome, you unload the cargo onto carts, taking it to market for sale the next day.^^133, 134^^ After watching the goods disappear down the street, Maximinus clasps his hands, “Well. Shall we?” You all nod, approaching horses that await. You sit behind your Father on the horse, watching the city as you make your way up a hill. Rome truly is the city of Seven Hills.

[[Ride up Palatine Hill|P2JiRomeD1Hill]]

–––––––––––––––––
^^133^^ Aldrete, //Daily Life in the Roman City//, 200.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Warehouses were called //horrae// and had an open courtyard with four sides all rounded by small storage rooms.]
^^134^^ Aldrete, 200.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[//Horrae// had massive, thick walls with few external openings, elaborate lock systems, and multiple stories to prevent moisture, decrease vermin, and increased ventilation.]</tw-passagedata><tw-passagedata pid="110" name="P2JiRomeD1Hill" tags="" position="2100,1550" size="100,100">As you approach Maximinus’ home on Palatine Hill, you are struck by the neighboring places, such luxury, such wealth. This is what it means to be a patrician of deep ancestral ties, upon entering, servants take the horses, and you are all once again escorted to guest rooms.[[^^1^^|P2JiRomeD1HillCP]]

[[Exhausted from the voyage sets in, you cannot even appreciate the room before you find yourself drifting off.|P2RomeD1]]</tw-passagedata><tw-passagedata pid="111" name="P2RomeD1" tags="" position="1950,1575" size="100,100">The next morning you awaken to the light of day and begin to dress for the day. 

Upon reaching the atrium, Hakor awaits with his arms crossed. An air of stoicism fills the space before your father and Maximinus emerge, “[$name] and Hakor. Would you both see to our cargo at the market? Fetch a decent price.” You both nod and walk off, catching a glimpse of your father and Maximinus descending into the tablinum.

[[Go to the market with Hakor|P2RomeD1Market]]</tw-passagedata><tw-passagedata pid="112" name="P2RomeD1Market" tags="" position="1950,1700" size="100,100">At the marketplace, you and Hakor fight tooth and nail for the cargo, finally between two mongers. Monger 1 provides a 25% higher price than Monger 2, but will not agree to continuing business with your ship in the future. However, Monger 2 says he will continue business with your ship in the future and needs to ensure the cargo remains high quality and consistent. Looking at Hakor, who raises his eyebrow in silence, you both decide…

[[Sell to Monger 1|P2RomeD1M]]

[[Sell to Monger 2|P2RomeD1M]]</tw-passagedata><tw-passagedata pid="113" name="P2RomeD1M" tags="" position="2125,1675" size="100,100">After selling, Hakor turns to you, “[$name], I will return to Palatine Hill. You are welcome to join me or you can remain here.”

[[Stay at the market|P2RomeD1Mar]]

[[Go back with him|P2RomeD1House]]</tw-passagedata><tw-passagedata pid="114" name="P2RomeD1Mar" tags="" position="2050,1800" size="100,100">“I will see you later, Hakor.” He solemnly nods, “Thank you for your help, you’re the best.” The subtlest of smiles dances across his features as he turns to leave. You decide to…
(set: $RomanClothing to 0)
[[Check out a food stall.|P2RomeD1MarFood]]

[[Check out a clothing stall.|P2RomeD1MarCloth]]

(Set: $P2RomeMarket1 to 0)</tw-passagedata><tw-passagedata pid="115" name="P2RomeD1House" tags="" position="2225,1800" size="100,100">“I will go back with you” He nods and begins to walk off, you struggle to maintain his pace!

[[Walk to the house with Hakor.|P2RomeD1House1]]</tw-passagedata><tw-passagedata pid="116" name="P2RomeD1House1" tags="" position="2150,1925" size="100,100">(if: $P2RomeMarket1 is 1)[After shopping at the market, you return to Maximinus’ home on Palatine Hill.]

Upon arrival at the home, you find your father and Maximinus gone and decide to walk around.

[[Go to the courtyard|P2RomeD1HCourt]]

[[Examine the floor mosaics|P2RomeD1HMosaic]]</tw-passagedata><tw-passagedata pid="117" name="P2RomeD1MarFood" tags="" position="1800,1825" size="100,100">You walk around and find another stall with food, the garum smelt absolutely divine that you cannot help but purchase a serving. As you eat, you look around at the bustle of the market: people rush by and franctically purchase produce and products. Mules vocalize in whines and brays, with carts attached. Looking down the counter, you recognize the people as various working professionals. Through the buzz of the market, you hear various languages, and even heard Egyptian, with people from all over. The richness of cultures and peoples warms your heart. Smiling to yourself, you enjoy your soup before continuining on your way.[[^^1^^|P2RomeD1MarFoodCP]]

[[Check out a clothing stall.|P2RomeD1MarCloth]]

[[Walk back to the house.|P2RomeD1House1]]

(Set: $P2RomeMarket1 to 1)</tw-passagedata><tw-passagedata pid="118" name="P2RomeD1MarCloth" tags="" position="1925,1950" size="100,100">You come upon a stall with various pieces of cloth - wools, linens, silks, some dyed in bright colors while others were neutral. Running your hand over a piece of pink silk, the vendor states, &quot;That&#39;s from the East! Very luxurious...&quot; He trails off as he notes your  outfit, &quot;Though, perhaps, you would like to look at...wool?&quot; His hand points towards a brown thicker wool cloth. You smile and shake your head, &quot;No, I think I would prefer linen or silk...dyed that is.&quot; The man vocalizes an &quot;Ahhh&quot; at your words, leaving you to yourself.[[^^1^^|P2RomeD1MarClothCP]]

[[[Purchase a sheet of finen linen.|P2RomeD1House1]](set:$RomanClothing to 1)]

[[Check out a food stall.|P2RomeD1MarFood]]

[[Walk back to the house.|P2RomeD1House1]]

(Set: $P2RomeMarket1 to 1)</tw-passagedata><tw-passagedata pid="119" name="P2RomeD1HCourt" tags="" position="2100,2050" size="100,100">You decide to go to the courtyard, hoping to learn more about the private spaces in the home. You are shocked to see a young woman in a beautiful pale blue dress, and nicely done-up hair. She looks just shocked at you, asking, “Has Caesar Augustus sent you?” 

You gape and scoff, “Gods, no! Isis have mercy on me. No, I’m [$name]. My father is–” “Adamantios. Yes I have heard about you.” You chuckle awkwardly, looking around, “I’m Daria, Maximinus’ daughter. I manage the household and our reputation in his absence.” You nod.[[^^1^^|P2RomeD1HCourtCP]]

[[What was that about Caesar Augustus?|P2RomeD1HCourtCA]]

[[My apologies, Daria, for interrupting you.|P2RomeD1HCourtAI]]</tw-passagedata><tw-passagedata pid="120" name="P2RomeD1HMosaic" tags="" position="2250,2050" size="100,100">You decide to go near the atrium, having heard that mosaics in the homes of the wealthy revealed their family history.

[[Take a closer look|P2RomeD1HMosaic2]]</tw-passagedata><tw-passagedata pid="121" name="P2RomeD1HCourtCA" tags="" position="2000,2175" size="100,100">“Oh, that.” She awkwardly looks around, taking a flower from a vine into her hand, “Yes, well. I fear he has been quite persistent in his attempts to marry me to another elite, Gnaeus Calpurnius Piso.” You nod lightly, “Ah I see.”[[^^1^^|P2RomeD1HCourtCACP]]

[[My apologies, Daria, for interrupting you.|P2RomeD1HCourtAI]]

[[Leave and go examine the floor mosaics.|P2RomeD1HMosaic]]

[[Retire to your room|P2RomeD1HGuestRoom]]</tw-passagedata><tw-passagedata pid="122" name="P2RomeD1HCourtAI" tags="" position="2150,2175" size="100,100">She waves you off, “Nevermind that. It was nice meeting you, [$name].” You smile, bowing slightly, “You too.”

[[What was that about Caesar Augustus?|P2RomeD1HCourtCA]]

[[Leave and go examine the floor mosaics.|P2RomeD1HMosaic]]

[[Retire to your room|P2RomeD1HGuestRoom]]</tw-passagedata><tw-passagedata pid="123" name="P2RomeD1HMosaic2" tags="" position="2375,2050" size="100,100">You look upon a scene of a priest making offerings to a deity. You note how Egyptian the body poses and ornamentation appear. You find the accompanying geometric patterns of the mosaic force you towards a focal point of this scene of devotion. You notice the sitting figure wearing a demes with a uraeus and wonder if this is a depiction of Isis. You begin to look at the very Roman piece with an Egyptian scene in curiosity. Perhaps Maximinus and his family history is more intertwined with Egypt than you would have thought. [[^^1^^|P2RomeD1HMosaic2CP]]

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/254535/1735201/main-image&quot; width=&#39;600&#39;\&gt;
&lt;/center&gt;

[[Go to the courtyard|P2RomeD1HCourt]]

[[Retire to your room|P2RomeD1HGuestRoom]]</tw-passagedata><tw-passagedata pid="124" name="P2RomeD1HGuestRoom" tags="" position="2150,2300" size="100,100">You retire to your all-black room. The paintings were very small, but extremely detailed, intricate, and brightly colorful. You notice how the walls appear bare and plain, but upon a closer look, are rather ornamented. It reminds you of the other subtle ways that Romans present their wealth. You see a framed outline with a central column that has miniature, ornament details. On top of the column lies an exaggerated and spurious image of worship of a bull. You roll your eyes at the obvious lack of understanding or legibility of Egyptian worship before resigning to read a philosophical scroll you found on the room’s bookshelf.[[^^1^^|P2RomeD1HGuestRoomCP]]

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/250931/537062/main-image&quot; width=&#39;500&#39;\&gt;
&lt;/center&gt;

[[Read some Epicurean philosophy...hmm...|P2RomeD1HGuestRoom2]]</tw-passagedata><tw-passagedata pid="125" name="P2RomeD1HGuestRoom2" tags="" position="2300,2300" size="100,100">You begin to dress in a longer silk tunic that one of the household servants delivered. You make your way downstairs to find a banquet in full effect. People lounge around eating and drinking, you spot a corner where men huddle around a game of dice and knucklebones. In the center of the room, a singer with a lyre and flute performs as dancers prance around in fluid, tantalizing motions.[[^^1^^|P2RomeD1HGuestRoom2CP]]

[[Talk to Father|P2RomeD1HBanquetDad]]

[[Talk to Daria|P2RomeD1HBanquetDaria]]

[[Talk to two loud drunk men in Senatorial togas|P2RomeD1HBanquetMarcuses]]</tw-passagedata><tw-passagedata pid="126" name="P2RomeD1HBanquetDad" tags="" position="2050,2425" size="100,100">You spot your father sitting on a bench, laughing with Hakor, as you approach he greets boisterously, “[$name], my sweet! Where have you been?” “I have been upstairs. I did not realize the banquet had begun.” “Yes! Go enjoy the food, wine, and company! Maximinus invited many people,” he hiccups, “Even Senators!” You smile at his joy.

[[Talk to Daria|P2RomeD1HBanquetDaria]]

[[Talk to two loud drunk men in Senatorial togas|P2RomeD1HBanquetMarcuses]]</tw-passagedata><tw-passagedata pid="127" name="P2RomeD1HBanquetDaria" tags="" position="2175,2425" size="100,100">You spot Daria leaning on a column across from where your father and Hakor sit, the performers between the two. “Daria!” She jumps slightly, you notice her white face and black shadowing around her. You quickly wonder if you also should have worn that, though you find it a little ridiculous, “[$name]! My, you make a habit out of scaring me!” 

You smile, “Could I ask you something?” You hum at her question and nod, “Yes, anything!” “Who is that?” She points at Hakor, “Ah…that’s Hakor. He’s our Head Navigator.” She nods slightly, red lips pursed, “Why?” “Oh, no reason.” She twiddles her hair between her fingers. You nod, eyes widened.[[^^1^^|P2RomeD1HBanquetDariaCP]]

[[Talk to Father|P2RomeD1HBanquetDad]]

[[Talk to two loud drunk men in Senatorial togas|P2RomeD1HBanquetMarcuses]]</tw-passagedata><tw-passagedata pid="128" name="P2RomeD1HBanquetMarcuses" tags="" position="2325,2425" size="100,100">You approach two loud drunk men who crowd around a bowl of wine, two slaves cautiously wait nearby, their hands shooting out with each movement of the men. Having heard their fragmented discourses on various philosophers and seeing their purple striped //sinus//, you call out, “Senators!” They snap their heads toward you, “Yes? We are Senators...Proud of our patrician class!” He sways a little, his toga slightly falling off the shoulder, a slave runs up and tries to fix it but he swings his arm around the other.[[^^1^^|P2RomeD1HBanquetMarcusesCP]]

One nudges the speaker, “Marcus!” The one speaking turns exaggeratedly, “What, Marcus?” 

[[Oh, Serapis...drunken senators, no, men, both named Marcus...Is every Roman man named Marcus?!|P2RomeD1HBanquetMarcuses2]]</tw-passagedata><tw-passagedata pid="129" name="P2RomeD1HBanquetMarcuses2" tags="" position="2325,2550" size="100,100">Marcus I, as you dub him, says, “This is my best friend, Marcus.” Marcus II hollers in response, “We are discussing philosophy and politics!” Marcus II butts out, “Trying to understand those Liberatores Aegypti we have heard so much about.” You look in slight bewilderment at the scene of their spilling togas, wondering if their exposure would mark the banquet&#39;s progression into the later and explicit entertainment.

Marcus I looks beyond this existential plane, allowing a slave to fix his toga, as Marcus II continues, “Have you heard of them? We’re trying to figure them out! Stoic? Skeptic? Epicurean?! Gods, no!” Marcus I nods, “Marcus, but what of Pax?” “What of it?” 

The two men descend into endless chatter about the Republic, the Senate, Pax, and this movement.

[[Drink with them.|P2RomeD1HBanquetDRINK]]</tw-passagedata><tw-passagedata pid="130" name="P2RomeD1HBanquetDRINK" tags="" position="2175,2550" size="100,100">You peer between the men, seeing the bowl of wine and begin to pour yourself a cup, “Senators, please. Let us drink!” Marcus II cheers and begins to down his cup of wine to replenish it as you fill yours and his. Marcus I simply refills his. 

You exchange many drinks with the men, finding out that Liberatores Aegypti have a mission of liberating Egypt from the empire under its own governance and seeking revenge for Queen Cleopatra. The whole time, you became very familiar with their chests and could not help but shake your head at their accidental exhibitionistic tendencies.

[[Go to bed.|P2RomeN1Sleep]]</tw-passagedata><tw-passagedata pid="131" name="P2RomeN1Sleep" tags="" position="2025,2550" size="100,100">As the night progresses, you meet many more Romans, sharing food and wine. You eventually leave to bed as the guests depart. You shake your head and quickly sleep, the wine knocking you out.

[[Pass out!|P2RomeD2]]</tw-passagedata><tw-passagedata pid="132" name="P2RomeD2" tags="" position="1875,2550" size="100,100">The next day, you wake up and decide to go explore the Roman Forum.

[[Go to Venus Genetrix|P2RomeD2RFVG]]

[[Visit Ara Pacis|P2RomeD2RFAP]]

(set: $RomanForum to 0)</tw-passagedata><tw-passagedata pid="133" name="P2RomeD2RFVG" tags="" position="2000,2675" size="100,100">You decide to go to The Temple of Venus Genetrix. As you enter, you approach the statue of Venus, noting the similiarities it bears to a Cleopatra statue you saw back in Alexandria. Smirking to yourself, you quickly pray to Isis under the guise of Venus worship, taking in the hums from other worshippers around you and the smells of incense.[[^^1^^|P2RomeD2RFVGCP]]
&lt;center&gt; &lt;img src=&quot;https://i.pinimg.com/736x/08/a5/23/08a523968b9908a9d7aead768e9b4193.jpg&quot; width=&#39;500&#39;\&gt;
&lt;/center&gt;
(set: $RomanForum to $RomanForum + 1)
[[Visit Ara Pacis|P2RomeD2RFAP]]

(if: $RomanForum is 2 or &gt;2)[[Go to the bathhouse.|P2RomeD2Bathhouse]]</tw-passagedata><tw-passagedata pid="134" name="P2RomeD2RFAP" tags="" position="1850,2675" size="100,100">You have heard of Augustus’ //Ara Pacis//, dedicated to the era of peace, so you decide to visit it. You walk around the altar and see the narrative story of the city&#39;s founding as well as Augustus&#39;s family in relation to this story. You also note the children in the images and question when the last time was that you saw a child outside of funeral art. You hum to yourself as you see the children tug their togas and nearby nurses hush them. You also note the explicit humility on Augustus&#39;s face as he leads the procession. You purse your lips at this depiction.[[^^1^^|P2RomeD2RFAPCP]]
&lt;center&gt; &lt;img src=&quot;https://ka-perseus-images.s3.amazonaws.com/5e89190a0946ee00bae5b7a20828d94cbd6b52f2.jpg&quot; width=&#39;500&#39;\&gt; 
&lt;/center&gt;
(set: $RomanForum to $RomanForum + 1)
[[Go to Venus Genetrix|P2RomeD2RFVG]]

(if: $RomanForum is 2 or &gt;2)[[Go to the bathhouse.|P2RomeD2Bathhouse]]</tw-passagedata><tw-passagedata pid="135" name="P2RomeD2Bathhouse" tags="" position="1975,2800" size="100,100">After exploring the forum, you decided to visit a Roman bathhouse. As the steam fogs the room, you hear people whisper about Liberatores Aegypti, “I have heard that in Egypt, they have gotten more bold. Apparently they recently set a camp afire and have been desecrating monuments Augustus completed.” “Oh, really?” the other voice responds. “Don’t they know the war ended almost 20 years ago?” “Yes, but they wish Egypt to be free.” The two laugh, you decide to continue to the cold plunge before leaving.[[^^1^^|P2RomeD2BathhouseCP]]

[[Go back to the house.|P2RomeD2House]]</tw-passagedata><tw-passagedata pid="136" name="P2RomeD2House" tags="" position="2125,2700" size="100,100">After bathing, you return to the house and read more philosophy books before you descend for dinner.

[[Read some Stoicism...a better page turner than Epicureanism!|P2RomeN2]]</tw-passagedata><tw-passagedata pid="137" name="P2RomeN2" tags="" position="2275,2700" size="100,100">At the dinner table, everyone eats in polite silence. 

Daria continuously glances at Hakor, who is so engrossed in his meal he does not catch her glances, or so you assume. He is exceptionally stoic and reserved, you find it difficult to read him, even after knowing him since you were 14, for all you know, he is well aware of her attention. 

Maximinus, with Daria to his right, enjoys his meal, smiling at her every now and then. Your father sits on his other side and also eats with his focus on the food. You decide to break the silence.[[^^1^^|P2RomeN2CP]]

[[Ask about business.|P2RomeN2Talk1]]

[[Talk about Egypt.|P2RomeN2Talk2]]

[[When is your meeting?|P2RomeN2Talk3]]</tw-passagedata><tw-passagedata pid="138" name="P2RomeN2Talk1" tags="" position="2125,2825" size="100,100">“I haven’t seen you much, Father. How have business proceedings gone with Maximinus, so far?” Your father clears his throat, “Ah, they have gone well. Maximinus has been introducing me to other businessmen and contacts. I’m hoping to not only receive approval for the trade route, but potential other contracts.” Maximinus hums and pats your father’s back, “Adamantios here is quite ambitious. I fear he might woo over all my business partners and Roman friends!” The two laugh.

[[Ask about Liberatores Aegypti|P2RomeN2Talk1a]]

[[Talk about Egypt.|P2RomeN2Talk2]]

[[When is your meeting?|P2RomeN2Talk3]]</tw-passagedata><tw-passagedata pid="139" name="P2RomeN2Talk2" tags="" position="2250,2825" size="100,100">“Maximinus, have you ever been to our beautiful land?” Maximinus smiles, “Once, so long ago, when I was a young man in the army!” “You served?” He smiles, “Yes, I had to. My father wanted me to continue the family&#39;s history of politics, so I served under Julius Caesar. I was about 22 when we arrived in Egypt.” 

Your eyes widen, “Did you ever meet the Queen?” He laughs lightly, “No I did not! I fear I was a junior officer, I was far too busy keeping my men in line.”[[^^1^^|P2RomeN2Talk2CP]]

Your father smirks, “I remember when the Romans came, I was 10. Alexandria and Egypt had been in chaos with the fighting between the Ptolemys. But it became relatively stable by the time the Romans departed.” Maximinus nods and smugly states, “You&#39;re welcome.” Your father laughs heartily.

[[Ask about business.|P2RomeN2Talk1]]

[[When is your meeting?|P2RomeN2Talk3]]</tw-passagedata><tw-passagedata pid="140" name="P2RomeN2Talk3" tags="" position="2375,2825" size="100,100">Maximinus replies without looking up, “Tomorrow around noon.” 

Your father pipes up, “I want you to come with us, not exactly into the meeting, but to see the Curia Julia.” You nod, “Why?” “I have heard it is quite beautiful plus I want you close by in case I need you, to show them that you will succeed me in the business.” 

You nod, suddenly wishing Cheops was there, to talk and to share the experience of the palace with someone.

[[Ask about business.|P2RomeN2Talk1]]

[[Talk about Egypt.|P2RomeN2Talk2]]

[[Head to your room|P2RomeN2Room]]</tw-passagedata><tw-passagedata pid="141" name="P2RomeN2Talk1a" tags="" position="2100,2975" size="100,100">Your father stops in confusion, “I have heard of them, but nothing much. Why?” You push your food around, “I’ve just heard some mentions while I was in the forum today, that’s all.” Maximinus lightly shakes his head, “The forum,” he scoffs, “So much gossip there, you can never be sure of the truth and the lies. I wouldn’t pay it much mind.”^^213^^ You nod and take a bite of food.

[[Talk about Egypt.|P2RomeN2Talk2]]

[[When is your meeting?|P2RomeN2Talk3]]

–––––––––––––––––
^^213^^ Patterson, “Living and Dying in the City of Rome: Houses and Tombs,” 260–62.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Due to the historical tradition of the aristocrats being the central political figures in the Roman Republic, Palatine Hill was located near the Roman forum, the center of political activity and public life.
Maximinus’ dismissal of the forum is important as it juxtaposes his status and residency in Palatine: he advocates political disengagement. However, his dismissal could also be a more critical engagement with Roman politics due to the closeness of political life. Either way, his dismissal of the forum speaks about his values, character, status as a patrician-class Roman, and his personal and familial history.]</tw-passagedata><tw-passagedata pid="142" name="P2RomeN2Room" tags="" position="2375,2950" size="100,100">After the conservation over dinner, you go back to your room. Having heard so many mentions of Liberatores Aegypti and still not trusting Maximinus, you decide to wait until everyone goes to bed before sneaking around.
(set: $Sneaking to 0)
[[Go to the kitchen|P2RomeN2SneakKitchen]]

[[Go to Maximinus&#39; Office|P2RomeN2SneakOffice]]</tw-passagedata><tw-passagedata pid="143" name="P2RomeN2SneakKitchen" tags="" position="2275,3050" size="100,100">You reach the kitchen, nothing out of the ordinary…

[[Wait. What is that?|P2RomeN2SneakKitchen2]]</tw-passagedata><tw-passagedata pid="144" name="P2RomeN2SneakOffice" tags="" position="2475,3050" size="100,100">You decide to go inside of Maximinus’ tablinum.

[[Examine the desk.|P2RomeN2SneakOfficeD]]</tw-passagedata><tw-passagedata pid="145" name="P2RomeN2SneakKitchen2" tags="" position="2100,3125" size="100,100">In the corner, you see some ingredients laying around with a smell of sulfur.

(if: $GreekFire is 1)[It reminds you of the Greek fire you used on the pirates.] (if:$GreekFire is 0)[It reminds you of the story your father told you about powerful fire magic.]
(set: $Sneaking to $Sneaking + 1)
You feel a rush of fear flood your body – Why was this in Maximinus’ kitchen? Who made it? And why would they?

[[Go to Maximinus&#39; office|P2RomeN2SneakOffice]]

(if: $Sneaking is 2 or &gt; 2)[[Leave to your room.|P2RomeN2SneakRoom]]</tw-passagedata><tw-passagedata pid="146" name="P2RomeN2SneakOfficeD" tags="" position="2375,3175" size="100,100">You glance at the few papers on his desk, and find a scroll with the Imperial mark. You read it and find a request-not-request from the emperor to marry Daria, a “fine young lady” of “appropriate” background and “influential” family to marry her to another elite family, maintaining Rome’s patrician class. The letter also threatens penalities and says something about being marked insane...You find the demand rather ridiculous and feel even worse for Daria.[[^^1^^|P2RomeN2SneakOfficeDCP]]

[[Turn to leave.|P2RomeN2SneakOfficeD2]]</tw-passagedata><tw-passagedata pid="147" name="P2RomeN2SneakOfficeD2" tags="" position="2525,3250" size="100,100">You turn to leave but notice a weird, almost hidden drawer in the desk.
(Set: $OpenCareful to 0)
[[Open it carefully.|P2RomeN2SneakOfficeD2C]]
(Set: $OpenAggressive to 0)
[[Bust the lock.|P2RomeN2SneakOfficeD2A]]</tw-passagedata><tw-passagedata pid="148" name="P2RomeN2SneakOfficeD2A" tags="" position="2400,3375" size="100,100">By taking a pin on the desk, you jam it into the lock, hitting it. It breaks and leaves a clear dent in the drawer. Inside, you find a log of names, some written in hieroglyphs and others in Latin.
(set: $Sneaking to $Sneaking + 1)
[[Go to the kitchen|P2RomeN2SneakKitchen]]
(Set: $OpenAggressive to 1)
(if: $Sneaking is 2 or &gt; 2)[[Leave to your room.|P2RomeN2SneakRoom]]</tw-passagedata><tw-passagedata pid="149" name="P2RomeN2SneakOfficeD2C" tags="" position="2550,3375" size="100,100">By taking a pin on the desk, you carefully pick the lock and open the drawer. Inside, you find a log of names, some written in hieroglyphs and others in Latin.
(set: $Sneaking to $Sneaking + 1)
[[Go to the kitchen|P2RomeN2SneakKitchen]]
(Set: $OpenCareful to 1)
(if: $Sneaking is 2 or &gt; 2)[[Leave to your room.|P2RomeN2SneakRoom]]</tw-passagedata><tw-passagedata pid="150" name="P2RomeN2SneakRoom" tags="" position="2225,3200" size="100,100">You hear a sound and quickly shove the paper into your shirt and leave to bed, hoping no one saw you.

(if: $OpenAggressive is 1)[[Go to sleep.|P2RomeD3A]] (if: $OpenCareful is 1)[[Go to sleep.|P2RomeD3C]]</tw-passagedata><tw-passagedata pid="151" name="P2RomeD3A" tags="" position="2225,3325" size="100,100">Your father awakens you in a frenzy, asking, “Was it you?” “Huh?” you groan, still waking up. “Was it you, [$name]? That went in Maximinus’ tablinum?”

[[Yes...|P2RomeD3AY]]

[[No!|P2RomeD3AN]]</tw-passagedata><tw-passagedata pid="152" name="P2RomeD3C" tags="" position="2100,3325" size="100,100">The next day, you are woken by your father, “[$name].  it is time to wake up and get dressed.” You groan and slowly get up, rubbing your eyes.

(if: $RomanClothing is 1)[Your father grabs the clothes you purchased at the market. Your father hums at the outfit, “That looks perfect, wear that.” You nod and he leaves.] (if: $RomanClothing is 0)[Your father tells you that Maximinus has clothes you can wear. You nod and he leaves, a servant quickly dropping off the clothes and leaving.]

[[After dressing, you put on your mother’s bracelets and smile.|P2RomeD3L]]</tw-passagedata><tw-passagedata pid="153" name="P2RomeD3AY" tags="" position="2275,3500" size="100,100">He sighs heavily, “I was worried…you need to be careful.” You nod embarrassedly, “[$name]! I told you to trust me…Not only are you not doing that, but you are violating hospitality. Get up and get dressed.”

(if: $RomanClothing is 1)[Your father grabs the clothes you purchased at the market. Your father hums at the outfit, “You really drive me crazy, you know that?&quot; You nod as he continues, &quot;But, that looks perfect, wear that.” You smile and he leaves.] (if: $RomanClothing is 0)[Your father tells you that Maximinus has clothes you can wear. You nod and he leaves, not without giving you another stern glance, a servant quickly dropping off the clothes and leaving.]

[[After dressing, you put on your mother’s bracelets and smile.|P2RomeD3L]]</tw-passagedata><tw-passagedata pid="154" name="P2RomeD3AN" tags="" position="2400,3500" size="100,100">He grabs your shoulders, “[$name]. I need you to be honest with me right now.” You begrudgingly tell him, “Yes. I did.” He sighs heavily, “I told you to trust me…Not only are you not doing that, but you are violating hospitality. Get up and get dressed.”

(if: $RomanClothing is 1)[Your father grabs the clothes you purchased at the market. Your father hums at the outfit, “You really drive me crazy, you know that?&quot; You nod as he continues, &quot;But, that looks perfect, wear that.” You smile and he leaves.] (if: $RomanClothing is 0)[Your father tells you that Maximinus has clothes you can wear. You nod and he leaves, not without giving you another stern glance, a servant quickly dropping off the clothes and leaving.]

[[After dressing, you put on your mother’s bracelets and smile.|P2RomeD3L]]</tw-passagedata><tw-passagedata pid="155" name="P2RomeD3L" tags="" position="2150,3500" size="100,100">You travel to the Curia Julia in a litter with your father and Maximinus, feeling out of place.

[[You look out and see the white marble of the build.|P2RomeD3IP]]</tw-passagedata><tw-passagedata pid="156" name="P2RomeD3IP" tags="" position="2025,3500" size="100,100">Upon arriving at the Curia Julia, a Roman officer escorts you three to one of the Eastern wings whereupon your father and Maximinus enter a room. The Imperial government official, named Fido, receives them, as he represents the Emperor for all the empire’s business related ventures. Your father turns to you, “Wait near here, my sweet. Do not wander too far in case I need you.” You nod, the palace crawls with activity and soldiers on sentry duty are posted about.
(Set: $imperialwaiting to 0)
[[Examine busts.|P2RomeD3IPBusts]]

[[See Prima Porta.|P2RomeD3IPPP]]

[[Examine wall reliefs of Augustus’ triumphs.|P2RomeD3IPW]]</tw-passagedata><tw-passagedata pid="157" name="P2RomeD3IPBusts" tags="" position="1900,3625" size="100,100">You gaze upon a line of various busts. You can tell that each of them are related since they all look very similar, you quickly make note of the various deviations throughout. Perhaps these deviations individualize these busts. You look at the women and note the rather plain nature of them: minimal makeup, conservative hair, and from the brief part of shoulders, a traditional stola. You quickly turn towards bust of a man and note the similarities to Alexander the Great with the turned head and youthful appearance, but also the hints of aging to convey wisdom and experience. Each of these busts feel almost, sterile and mechanical, with no feelings of life. It sends a slight shiver down your spine...[[^^1^^|P2RomeD3IPBustsCP]]
&lt;center&gt; &lt;img src=&quot;https://i.pinimg.com/474x/18/28/d6/1828d6c0673b75068ec7832cddc4ff52.jpg&quot; width=&#39;300&#39;\&gt; 
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Bust_of_Augustus_wearing_the_Corona_Civica%2C_ca._29_BC%2C_found_in_Rome%2C_Moi%2C_Auguste%2C_Empereur_de_Rome_exhibition%2C_Grand_Palais%2C_Paris_-_14464577048.jpg/740px-Bust_of_Augustus_wearing_the_Corona_Civica%2C_ca._29_BC%2C_found_in_Rome%2C_Moi%2C_Auguste%2C_Empereur_de_Rome_exhibition%2C_Grand_Palais%2C_Paris_-_14464577048.jpg?20200904065104&quot; width=&#39;300&#39;\&gt; 
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/%28Toulouse%29_Portrait_de_Julie_Mus%C3%A9e_Saint-Raymond_Ra_338.jpg/800px-%28Toulouse%29_Portrait_de_Julie_Mus%C3%A9e_Saint-Raymond_Ra_338.jpg?20220310200935&quot; width=&#39;300&#39;\&gt;
&lt;/center&gt;
(Set: $imperialwaiting to $imperialwaiting + 1)
[[See Prima Porta.|P2RomeD3IPPP]]

[[Examine wall reliefs of Augustus’ triumphs.|P2RomeD3IPW]]

(if: $imperialwaiting is 3 or &gt;3)[[Turn your head to the door opening.|P2RomeD3IP2]]</tw-passagedata><tw-passagedata pid="158" name="P2RomeD3IPPP" tags="" position="2025,3625" size="100,100">You look up at the statue of Augustus wearing a breastplate. His pose commands attention and draws your interest. You gaze upon the piece and notice the, almost, story told on his breastplate. Images of the gods and divine as well as peace proceedings flanked by two submissive figures. You take it in, and despite disliking it, cannot help but feel a source of...pride? The statue&#39;s grandoise and patriotic nature cannot help but evoke pride and satisfaction within you. Though the sphinxes on the shoulders quickly snap you out of your hypnosis – you are not Roman and you will never be seen as one. The statue quickly becomes cold.[[^^1^^|P2RomeD3IPPPCA]]

&lt;center&gt; &lt;img src=&quot;https://smarthistory.org/wp-content/uploads/2020/10/primaporta-tall.jpg&quot; width=&#39;300&#39;\&gt;
&lt;/center&gt;
(Set: $imperialwaiting to $imperialwaiting + 1)
[[Examine busts.|P2RomeD3IPBusts]]

[[Examine wall reliefs of Augustus’ triumphs.|P2RomeD3IPW]]

(if: $imperialwaiting is 3 or &gt;3)[[Turn your head to the door opening.|P2RomeD3IP2]]</tw-passagedata><tw-passagedata pid="159" name="P2RomeD3IPW" tags="" position="2150,3625" size="100,100">You carefully examine the carved reliefs in the walls. You see a procession with images of Egypt, a straw-like figure wearing a diadem with a snake wrapped around its arm. Your eyes widen as you realize this depicts Cleopatra&#39;s effigy in Augustus&#39;s triumph. You take a step back and examine the whole piece: Egypt depicted as an ostentatious land filled with riches and bounty, while Augustus appears as a strong, Roman commander. The images of conquered Egypt make your stomach twist, especially when you note the exaggerated and fantastical depictions that make your home appear as a magical, otherworldly space polluted with ornate and corrupted people.[[^^1^^|P2RomeD3IPWCP]]

(Set: $imperialwaiting to $imperialwaiting + 1)
[[Examine busts.|P2RomeD3IPBusts]]

[[See Prima Porta.|P2RomeD3IPPP]]

(if: $imperialwaiting is 3 or &gt;3)[[Turn your head to the door opening.|P2RomeD3IP2]]</tw-passagedata><tw-passagedata pid="160" name="P2RomeD3IP2" tags="" position="2025,3750" size="100,100">Afterwards, the door opens and Maximinus and your father leave. You ask, “How did it go?” He beams at you as Maximinus responds, “It went wonderfully. Fido said that he would take it directly to the Emperor!&quot;

[[Leave and go back to Palatine Hill|P2RomeD3PH]]</tw-passagedata><tw-passagedata pid="161" name="P2RomeD3PH" tags="" position="2150,3750" size="100,100">In the litter back, upon reaching Palatine Hill, Maximinus redirects the route. He points to a house, “This is Agrippa’s home, it used to be Antony’s. I remember seeing him every now and then when I was younger.”^^245^^

You nod enthusiastically as your father speaks, “I never told you this, [$name],But back before you were born, your mother and I used to walk Alexandria at night enjoying the peace and quiet. One night, as we enjoyed some dates, we saw this man walking towards us, a woman following close behind. Their dress was common for servants, but we could tell they weren&#39;t servants.” 

[[How?|P2RomeD3PH2]]

–––––––––––––––––
^^245^^ Patterson, “Living and Dying in the City of Rome: Houses and Tombs,” 260–62.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Since atriums could contain decorations of battle spoils from earlier occupants, it is not unusual to assert that Agrippa inherited Marc Antony’s home after their defeat in 30 BCE. This detail is fictionalized as I am not sure if Marc Antony had a home on Palatine Hill and who inherited his property after his death. For the sake of drama and intrigue, I wanted to insert Agrippa as having taken over Antony’s residence as this indirectly aligns with the theme of Augustus directly opposing values, characteristics, and behaviors attributed to Antony and Cleopatra. Agrippa, as his top general and right-hand man, follows Augustus’ image, identity, and propaganda cultivation campaign, and as a victor of the war, received high spoils including an elite property on one of the most affluent hills in Rome.]</tw-passagedata><tw-passagedata pid="162" name="P2RomeD3PH2" tags="" position="2275,3750" size="100,100">“We could just tell! The man demanded to have some of the dates. Your mother recognized the woman as the Queen but she merely remained besides who we then knew was Antony. Playing along, I began to argue with him over the dates until Antony said something that made your mother laugh so hard, I conceded defeat to him! We laughed as he jumped away, the Queen behind with a smile on her face.”

“Wow, Adamantios! He did that?” “Oh yes, Antony loved to prank us Alexandrians, he was quite the witty and daring man. We liked it, he fit with our culture.”[[^^1^^|P2RomeD3PH2CP]]

You smile at the story and the two continue to exchange more stories.

[[Enter Maximinus&#39;s House|P2RomeD3House]]</tw-passagedata><tw-passagedata pid="163" name="P2RomeD3House" tags="" position="2425,3750" size="100,100">Upon arriving at the house, your father says, “We wish to celebrate. [$name], please go to my room and grab the mead I brought with us.” You agree and go to his room.

[[Enter your Father&#39;s room.|P2RomeD3HouseFR]]</tw-passagedata><tw-passagedata pid="164" name="P2RomeD3HouseFR" tags="" position="2525,3600" size="100,100">Entering the room, you look around, wondering where the mead could be.
(Set: $Mead to 0)
[[Examine the chest.|P2RomeD3HouseFRChest]]

[[Examine bag.|P2RomeD3HouseFRBag]]</tw-passagedata><tw-passagedata pid="165" name="P2RomeD3HouseFRChest" tags="" position="2575,3750" size="100,100">You check the chest and find nothing but clothes and two small figurines of Isis and Serapis. Father and Mother worshiped them as a pair, they even performed a sacrificial ritual after their marriage.[[^^1^^|P2RomeD3HouseFRChestCP]]

[[Examine bag.|P2RomeD3HouseFRBag]]

(if: $Mead is 1)[[Examine wooden shelf.|P2RomeD3HouseFRShelf]]</tw-passagedata><tw-passagedata pid="166" name="P2RomeD3HouseFRBag" tags="" position="2700,3600" size="100,100">You examine his bag on the chair, and sift through, until you find the mead near the bottom. You carefully take it, cradling it.
(Set: $Mead to 1)
[[Examine the chest.|P2RomeD3HouseFRChest]]

[[Examine wooden shelf.|P2RomeD3HouseFRShelf]]</tw-passagedata><tw-passagedata pid="167" name="P2RomeD3HouseFRShelf" tags="" position="2725,3750" size="100,100">You see a paper slipping out from scrolls, you take it and find a map with circled places in Rome…Finally, it clicks. Maximinus and your father are planning something. They are related to the Liberatores Aegypti. 

Some names stand out: Acheron, Delta, Memphis, Anubis, Leopardus, Mercator, Argonaut, Fortuna, Maat, Ignis, and Aurora. Your hand starts to shake, however, you hear the footsteps of Daria. 

Thankfully, the shelf faced opposite the door, allowing you to fold and slip the map into your clothes. You turn back to face her, the mead in your hand. She smiles, “Your father asked me to grab you.” You smile and walk back with her. 

[[Celebrate with Maximinus and Father.|P2RomeD3HouseDrink]]</tw-passagedata><tw-passagedata pid="168" name="P2RomeD3HouseDrink" tags="" position="2850,3600" size="100,100">You find yourself on edge, and unable to enjoy the drink. Your father notices your anxiety, asking, “Are you okay?” You shake your head, “No, I don’t feel good. I think I am going to go lie down.” He nods, “I will come get you for dinner later.” You walk away, feeling faint.

[[Walk to your room...|P2RomeD3HouseRoom]]</tw-passagedata><tw-passagedata pid="169" name="P2RomeD3HouseRoom" tags="" position="2750,3250" size="100,100">You get back to your room, and grab the paper with the names and the map. You dig through your bag, finding your wax tablet and stylus.^^254^^ You jot down everything you have learned.

[[Maximinus’ Past|P2RomeN3MP]]

–––––––––––––––––
^^254^^ Aldrete, //Daily Life in the Roman City//, 64.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[A wax tablet and //stilus// which is a metal cylinder with a flat and pointed end for writing, were common writing methods and by heating the wax, notes could be erased. A completely sustainable and less expensive method of writing than with papyrus.]</tw-passagedata><tw-passagedata pid="170" name="P2RomeN3MP" tags="" position="2700,2900" size="100,100">You recall what Sabina and the merchant boy told you: Maxinimus had a wife and two children, Daria and a son. 

A son who perished at Actium, fighting with Antony. His body was never recovered and that loss caused Maximinus&#39;s wife to leave him to Athens. Daria was 7 when her mother left, and she stayed until 15 when she was sent to Rome. 

He lives a life of misery in Panormus, spending money just to talk to people and pouring his wealth into expensive pieces in memorial for his son. He still wears a beard, unbecoming of a Roman, let alone a patrician, 18 years after his son&#39;s death. 

[[Daria and her marriage prospect|P2RomeN3DM]]</tw-passagedata><tw-passagedata pid="171" name="P2RomeN3DM" tags="" position="2675,2525" size="100,100">Maximinus faces ruthless harassment from Augustus to marry Daria to another Roman elite, despite his and her protests. Clearly the emperor has gotten more aggressive in his approach, evident with Daria’s fear when you first met her…

[[Liberatores Aegypti|P2RomeN3LA]]</tw-passagedata><tw-passagedata pid="172" name="P2RomeN3LA" tags="" position="2625,2200" size="100,100">Various Romans have mentioned the movement in their actions in Egypt but also in whispers of their arrival to Rome. They do not seem above destruction and starting public outcries and riots…

[[The sulfur in the kitchen|P2RomeN3S]]</tw-passagedata><tw-passagedata pid="173" name="P2RomeN3S" tags="" position="2625,1850" size="100,100">You think of the sulfur smell and other ingredients for that fire magic in the kitchen, you know that it would be the perfect distraction and agent of chaos.

[[The map|P2RomeN3M]]</tw-passagedata><tw-passagedata pid="174" name="P2RomeN3M" tags="" position="2600,1450" size="100,100">You think of the map of the city with circled locations perfect to strike to cause absolute chaos and damage in Rome, allowing something even bigger to happen… 

[[The name log|P2RomeN3NL]]</tw-passagedata><tw-passagedata pid="175" name="P2RomeN3NL" tags="" position="2600,1075" size="100,100">Finally, the log makes sense. The names, all references to Roman, Greek, and Egyptian folklore and stories…You review the notable names: Acheron, Delta, Memphis, Anubis, Leopardus, Mercator, Argonaut, Fortuna, Maat, Ignis, and Aurora.

You think deeply...Argonaut stands out to you. The Argonauts were the hero Jason&#39;s crew who helped him on his naval voyage. A story that your father loved telling you...

Acheron...Acheron...The river in the underworld associated with sorrow. Sorrowful is one of many words to describe Maximinus&#39; life...

It only makes sense that Argonaut and Acheron refer to your father and Maximinus. 

[[You look at all that you&#39;ve written on the paper.|P2RomeN3P]]</tw-passagedata><tw-passagedata pid="176" name="P2RomeN3P" tags="" position="2600,650" size="100,100">You look out the window, the dark greets you. Enraged by what you have discovered and still in shock, you let your emotions cloud your judgment, leaving your room in a fit of anger, stomping to the room where your Father and Maximinus talk.

[[Open the door.|P2RomeN3OP]]</tw-passagedata><tw-passagedata pid="177" name="P2RomeN3OP" tags="" position="2750,300" size="100,100">You slam the door open, shocking the two. The mead nearly empty. In your anger you throw down your papers, demanding they tell you the truth now…

[[//Listen intently as your Father and Maximinus tell you everything.//|P3Rome]]</tw-passagedata><tw-passagedata pid="178" name="P3Rome" tags="" position="3800,200" size="100,100">&quot;Well?&quot; Your father looks at you with hope, &quot;Our plan is to try and kill the emperor for vengeance. Bengeance for our country, for our independence, our freedom.&quot;

Maximinus adds, &quot;He slaughtered Romans without remose. He refuses to acknowledge it, matter of fact, he punishes those who talk about it. He cannot escape justice.&quot;

You widen your eyes, mouth open, but before you can speak your father says, &quot;[$name]. Do you agree with us...Yes or no?&quot;

[[Yes, I agree with you.|P3RomeAgree]]

[[No, I cannot agree with you.|P3RomeDisagree]]</tw-passagedata><tw-passagedata pid="179" name="P3RomeAgree" tags="" position="3300,300" size="100,100">After talking the plan over with your father and Maximinus, you all went to bed.

You barely slept from the memory of the night before, tossing and turning all night. Trying to prepare yourself to join your father and Maximinus in the conspiracy.

[[You get up the next morning|P3RomeAagree1]]</tw-passagedata><tw-passagedata pid="180" name="P3RomeDisagree" tags="" position="4300,300" size="100,100">After disagreeing with your father and Maximinus, you all went to bed in silent tension.

You couldn’t sleep knowing what your Father and Maximinus had planned. Guilt gnaws at your soul.

[[You get up the next morning|P3RomeDisagree1]]</tw-passagedata><tw-passagedata pid="181" name="P3RomeDisagree1" tags="" position="4300,425" size="100,100">Your Father and Maximinus leave to begin their conspiracy. As you found out the night before, other members of the Liberatores Aegypti will attack the locations you found on the map using Greek Fire. You are not sure how that would even make any change, as your Father tried to explain to you, it was not just about them, but something larger. You could not really follow.

[[Anxiously pace the house.|P3RomeDisagree2]]</tw-passagedata><tw-passagedata pid="182" name="P3RomeDisagree2" tags="" position="4300,575" size="100,100">Shortly after they leave, someone arrives at the house. Daria and you share a look of concern, wondering who it was: Was it your fathers? Or was it someone else? You both approach the door, opening it gingerly, finding soldiers looking back. Before you can close the door, the Captain emerges and forces it wider, letting themselves in. They turn to you both and ask if you two knew anything about the Liberatores Aegypti.

[[Lie|P3RomeDisLie]]

[[Tell the truth|P3RomeDisTruth]]

//The soldiers grasp you and Daria, forcing you two into a chariot to the Curia Julia. //</tw-passagedata><tw-passagedata pid="183" name="P3RomeDisTruth" tags="" position="4100,675" size="100,100">A captain questions you, you tell him everything you have learned. He nods and leaves, saying he will be back. The city descends into chaos as the hours go on, you can hear the screams of the people, their energy gives you strength.[[^^1^^|P3RomeDisTruthCP]]

[[Wait.|P3RomeDisTruth2]]
</tw-passagedata><tw-passagedata pid="184" name="P3RomeDisLie" tags="" position="4500,675" size="100,100">After arriving at the Curia Julia, you and Daria are separated despite your protests. You are taken into a room with the Captain who tries to beat the information out of you. The city descends into chaos as the hours go on. You can hear the screams of the people, their energy gives you strength.[[^^1^^|P3RomeDisLieCP]]

[[Try and stay conscious...|P3RomeDisLie2]]</tw-passagedata><tw-passagedata pid="185" name="P3RomeDisLieWindow" tags="" position="4375,925" size="100,100">As much as you want to escape and warn your Father, you don’t think you could survive that jump…

[[You decide to leave.|P3RomeDisLieLeave]]</tw-passagedata><tw-passagedata pid="186" name="P3RomeDisLie2" tags="" position="4500,800" size="100,100">The Captain screams, “What do you know?!” You cry out in response, your lip busted and bleeding, and your right eye swollen shut, your face pulses, “I told you” you cry out, “All I know was my father and one of his business partners came here to establish a trade route.” You sob and beg him to believe you. He begrudgingly yields, hissing, “I will be back and I will bring someone who will make you talk.” You shiver and look around…

[[Examine the window.|P3RomeDisLieWindow]]

[[Examine door.|P3RomeDisLieDoor]]

[[Wait...|P3RomeDisLieWait]]</tw-passagedata><tw-passagedata pid="187" name="P3RomeDisLieDoor" tags="" position="4500,925" size="100,100">You couldn’t hear anyone outside, and based on how the rest of the interrogation went, it would only get worse. 

[[You decide to leave.|P3RomeDisLieLeave]]</tw-passagedata><tw-passagedata pid="188" name="P3RomeDisLieWait" tags="" position="4625,925" size="100,100">You think about waiting, but based on how that Captain beat you, it will only get worse…

[[You decide to leave.|P3RomeDisLieLeave]]</tw-passagedata><tw-passagedata pid="189" name="P3RomeDisLieLeave" tags="" position="4500,1050" size="100,100">You leave the room and decide to turn…

[[Left|P3RomeDisLieLeft]]

[[Right|P3RomeDisLieRight]]</tw-passagedata><tw-passagedata pid="190" name="P3RomeDisLieLeft" tags="" position="4400,1175" size="100,100">You turn left, heading deeper into the Curia Julia. You enter the Hall, where Augustus, Agrippa, other generals, and augurs, await the wedding of Daria and Gaius who stand in the center, she wears a solemn face in a white dress with a red-orange veil, .^^255, 256^^ Upon seeing Augustus, you think to yourself, “He looks much older than I expected.”

[[What&#39;s that?|P3RomeDisLieLeft2]]

–––––––––––––––––
^^255^^ Aldrete, //Daily Life in the Roman City//, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On their wedding days, girls had their hair parted into six strands then tied atop their head into a cone shape.]
^^256^^ Aldrete, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Their wedding dress was a white tunic with a wreath of marjoram with a bright orange or red transparent veil matching her shoes.]</tw-passagedata><tw-passagedata pid="191" name="P3RomeDisLieRight" tags="" position="4600,1175" size="100,100">You sprint through the halls, seeing the fires flickering outside. You have to warn your Father and Maximinus. You run down the Via, yelling for your father, crowds of people flood around you. A thick smell of smoke lingers, you keep yelling despite the hoarseness in your voice.

[[You feel someone grab you into an alley.|P3RomeDisLieRight2]]</tw-passagedata><tw-passagedata pid="192" name="P3RomeDisLieLeft2" tags="" position="4400,1300" size="100,100">Father and Maximinus appear, with a crowd of people, Maximinus, enraged at the scene, charges the emperor, who engages in a brief battle. Before you know it, Agrippa holds Maximinus’ right arm, another general holds his left, forcing him to his knees, shoving his head down, not before Maximinus yells out, “Libertas Aegypti!” 

Augustus roars as he swings his sword down, slicing his head clean off. Daria screams in horror, but your Father yells out, “We //MUST// go! He did it for us!” You three run through the streets of Rome, seeing Hakor waiting at a barge along the Tiber, urging you all to continue, the city in chaos around you.

[[Get on boat.|P3RomeDisLieLeft3]]
</tw-passagedata><tw-passagedata pid="193" name="P3RomeDisLieRight2" tags="" position="4600,1300" size="100,100">You begin to fight back, only to see Maximinus, Hakor, your Father, and other crew members looking at you. 

You sigh in relief, hugging your father, “I was so worried.” He pats your head, asking, “My sweet, where is Daria?” You shake your head, eyes flickering between your Father and Maximinus.

[[I don’t know, soldiers took us to the Curia Julia and separated us.|P3RomeDisLieRight3]]</tw-passagedata><tw-passagedata pid="194" name="P3RomeDisLieRight3" tags="" position="4600,1425" size="100,100">Maximinus growls, “That damned emperor thinks me a fool – believing he can marry my daughter to that foul Gnaeus.” Everyone nods, agreeing to retrieve Daria from her marital sentence. Your father pushes a dagger into your hand, turning to Hakor, “You know what to do.” He nods, before turning down the alley, running. 

[[Go back to the Curia Julia.|P3RomeDisLieRight4]]</tw-passagedata><tw-passagedata pid="195" name="P3RomeDisLieRight4" tags="" position="4600,1550" size="100,100">Your father, Maximinus, yourself, and other Liberatores Aegypti members storm the stairs, the posted soldiers clamoring to prevent fires. You all barge into the main hall, Augustus, Agrippa, generals, and the augers await. Daria, in a white dress with a red-orange veil, and Gnaeus stand, posed to marry.^^255, 256^^ You scoff and couldn&#39;t help but think how typical of Augustus, everything was posed and artificial.

[[Augustus chuckles, outstretching his arms.|P3RomeDisLieRight5]]

–––––––––––––––––
^^255^^ Aldrete, //Daily Life in the Roman City//, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On their wedding days, girls had their hair parted into six strands then tied atop their head into a cone shape.]
^^256^^ Aldrete, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Their wedding dress was a white tunic with a wreath of marjoram with a bright orange or red transparent veil matching her shoes.]</tw-passagedata><tw-passagedata pid="196" name="P3RomeDisLieRight5" tags="" position="4600,1675" size="100,100">“Maximinus. I should have known you were behind this. Please…join us.” Maximinus yells, “Augustus! Let my daughter go, now!” 

The Emperor shakes his head tauntingly, “Now…that’s no way to treat your Emperor” The moonlight, the wild flames roaring through the city, and the hall’s oil lamps illuminate his face. You can’t help but think about how aged he looks, completely different from his statue...

[[Look around.|P3RomeDisLieRight6]]</tw-passagedata><tw-passagedata pid="197" name="P3RomeDisLieRight6" tags="" position="4600,1800" size="100,100">You look behind you, seeing the crowds and smoke, yelling “You claim to provide peace, but is this truly peace? Or have the gods let the people speak freely?” In this moment, you look at Daria, who nods back. She begins to run, the generals and Gnaeus scramble to grab her, you reach out and yank her. 

[[Maximinus appears conflicted, you yell, “Either you die here or you live. Your choice.”|P3RomeDisLieRight7]]</tw-passagedata><tw-passagedata pid="198" name="P3RomeDisLieRight7" tags="" position="4600,1925" size="100,100">He nods, throwing a fire grenade. Your people fight off the generals enough to give everyone a chance to run, they trail behind. Maximinus and your Father lead, Daria and you run hand-in-hand.

Eventually, you reach the Tiber, finding Hakor who gestures as you approach, “I prepared the barge for our escape.” You all quickly approach and begin to get into the barge, helping others before taking off. 

You thank Hakor for preparing the barge and he nods in response. He gazes at Daria intensely, who blushes, causing Hakor’s eyes to widen before he quickly looks away. Maximinus groans in protest, “Please, Hakor, I have had enough men vie for my daughter’s hand for one day.” You all laugh while Daria hits her father playfully. 

[[Hakor clears his throat, reaching below his seat.|P3RomeDisLieRight8]]</tw-passagedata><tw-passagedata pid="199" name="P3RomeDisLieRight8" tags="" position="4600,2050" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, who smiles at her and ruffles her hair, much to her disapproval. 

[[Enjoy the silent trip down the Tiber.|P3RomeDisLieRight9]]</tw-passagedata><tw-passagedata pid="200" name="P3RomeDisLieRight9" tags="" position="4600,2175" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you in your condition, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I will be okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeDisLieRight10]]</tw-passagedata><tw-passagedata pid="201" name="P3RomeDisLieRight10" tags="" position="4600,2300" size="100,100">Daria and Maximinus walk by, who grumbles in quiet protest over his blushing daughter as Hakor carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. 

Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m relieved you’re okay but I still worry about you. Let me take care of you when we take to the seas” 

[[You smile and turn to your Father.|P3RomeDisLieRight11]]
</tw-passagedata><tw-passagedata pid="202" name="P3RomeDisLieRight11" tags="" position="4600,2425" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,], let us burn the barge.” 

You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[No, I want to continue the family business…in you and mother’s memory and honor.|EContV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="203" name="P3RomeDisLieLeft3" tags="" position="4400,1425" size="100,100">Hakor states, “I prepared the barge and as requested, Captain, I retrieved your belongings from Maximinus’ home.” He reaches below his seat, passing you two your bags. Looking at the sorrowful Daria with a glance of pity, he reaches under his seat again, dragging a chest, pushing it towards her, “Your father wanted you to have this.” She nods tearfully. 

[[Ride in silence.|P3RomeDisLieLeft4]]
</tw-passagedata><tw-passagedata pid="204" name="P3RomeDisLieLeft4" tags="" position="4400,1550" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you in your condition, rushing over and grabbing your shoulders, “Are you okay?” You smile mournfully, taking his hands off your shoulders gently, “Yes, Cheops. I will be okay.” He nods hesitantly, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeDisLieLeft5]]</tw-passagedata><tw-passagedata pid="205" name="P3RomeDisLieLeft5" tags="" position="4400,1675" size="100,100">Daria shuffles by as Hakor quietly carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m relieved you’re okay but I still worry about you. Let me take care of you when we take to the seas” 

[[Your lips curl in a moment of affection and turn to your Father.|P3RomeDisLieLeft6]]</tw-passagedata><tw-passagedata pid="206" name="P3RomeDisLieLeft6" tags="" position="4400,1800" size="100,100">He smiles bittersweetly and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV2]]

[[No, I want to continue the family business…in you and mother’s memory and honor.|EContV2]]

[[No, I want to pursue my dreams.|EDreamV2]]</tw-passagedata><tw-passagedata pid="207" name="P3RomeDisTruth2" tags="" position="4100,800" size="100,100">A general enters, you glance up and quickly recognize him as the great Marcus Vipsanius Agrippa. “I was informed you know quite a lot about” he gestures to the window where the fruit of your father’s labor presents itself, “this.” 

You nod, feeling a sense of unease and worry for your Father. He nods in thought, walking around the room, looking out the window “You know…I was there…at Actium. Young (if: $gender is &quot;Female&quot;)[girl] (if: $gender is &quot;Non-Binary&quot;)[child], I have seen what war, no, what civil war does to a country, to its people.” You nod, he looks back, looking you up and down, “Hmm. You look Greek and Egyptian…Ah, it makes more sense now. A drowned dream, a mirage in the desert. This is what your Father pursues. Either way, you have a choice (if: $gender is &quot;Female&quot;)[girl] (if: $gender is &quot;Non-Binary&quot;)[child]. You can condemn your father or spare him. I leave it to you.” 

[[He leaves, almost like he was never there.|P3RomeDisTruth3]]</tw-passagedata><tw-passagedata pid="208" name="P3RomeDisTruth3" tags="" position="4100,925" size="100,100">You feel turmoil brew. The captain returns, escorting you to the hall. You see Agrippa standing to the right of the Emperor, you two make eye contact. You feel a fire within him, his passion spreads to you. Among the hall, Daria, in a white dress with a red-orange veil, and Gnaeus stand in the center.^^255, 256^^

[[What’s that?|P3RomeDisTruth4]]

–––––––––––––––––
^^255^^ Aldrete, //Daily Life in the Roman City//, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On their wedding days, girls had their hair parted into six strands then tied atop their head into a cone shape.]
^^256^^ Aldrete, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Their wedding dress was a white tunic with a wreath of marjoram with a bright orange or red transparent veil matching her shoes.]</tw-passagedata><tw-passagedata pid="209" name="P3RomeDisTruth4" tags="" position="4100,1050" size="100,100">Father and Maximinus appear with a crowd of people. You look between them, rushing toward Daria, grabbing her…

[[Blame Maximinus.|P3RomeDisTruthCondemn]]

[[Blame Augustus.|P3RomeDisTruthSpare]]</tw-passagedata><tw-passagedata pid="210" name="P3RomeDisTruthSpare" tags="" position="4200,1175" size="100,100">“I will never let you kill my father!” You look back to Maximinus, and your father, the fire burning within you, “We must flee!” you descend down the stairs, Daria behind you. Maximinus yells out, throwing a fire grenade. You take one last look over your shoulder, Agrippa appears to smile, you feel a sense of pride and continue. 

[[Maximinus and your Father lead the retreat, Daria and you run hand-in-hand.|P3RomeDisTruthSpare2]]</tw-passagedata><tw-passagedata pid="211" name="P3RomeDisTruthCondemn" tags="" position="4000,1175" size="100,100">“He did this!” You point at Maximinus, who gives a look of shock, Daria gasps. She yanks herself from you, running to her father, “No! If you kill him, you must kill me.” 

Agrippa looks pained, you feel as though you made the wrong choice. You turn to your father whispering, “I did it for you.” He shakes his head, tears in his eyes, “No…this is not how it should have gone.” 

You beg him to leave with you, but he only caresses your cheeks with his hand, “Go. You made your choice. Now, I will make mine.” Your eyes burn, this is the last time you will ever see him. You can never bury him. Your father joins Maximinus and Daria, fighting as best as they can, you can’t bear to watch, so you run.

[[Flee|P3RomeDisTruthCondemn2]]</tw-passagedata><tw-passagedata pid="212" name="P3RomeDisTruthSpare2" tags="" position="4200,1300" size="100,100">You all quickly approach and begin to get into the barge, helping others before taking off. You thank Hakor for preparing the barge and he nods in response. He gazes at Daria intensely, who blushes, causing Hakor’s eyes to widen before he quickly looks away. Maximinus groans in protest, “Please, Hakor, I have had enough men vie for my daughter’s hand for one day.” You all laugh while Daria hits her father playfully. 

[[Hakor clears his throat, reaching below his seat.|P3RomeDisTruthSpare3]]</tw-passagedata><tw-passagedata pid="213" name="P3RomeDisTruthSpare3" tags="" position="4200,1425" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, who smiles at her and ruffles her hair, much to her disapproval. 

[[Enjoy the silent trip down the Tiber.|P3RomeDisTruthSpare4]]</tw-passagedata><tw-passagedata pid="214" name="P3RomeDisTruthSpare4" tags="" position="4200,1550" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I’m okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeDisTruthSpare 5]]</tw-passagedata><tw-passagedata pid="215" name="P3RomeDisTruthSpare 5" tags="" position="4200,1675" size="100,100">Daria and Maximinus walk by, who grumbles in quiet protest over his blushing daughter as Hakor carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m really relieved that you’re okay.” 

[[You smile and turn to your Father.|P3RomeDisTruthSpare6]]</tw-passagedata><tw-passagedata pid="216" name="P3RomeDisTruthSpare6" tags="" position="4200,1800" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[No, I want to continue the family business…in you and mother’s memory and honor.|EContV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="217" name="P3RomeDisTruthCondemn2" tags="" position="4000,1300" size="100,100">You run to the Tiber, finding Hakor waiting by the barge who deflates upon seeing only you. He reaches under his seat, pulling two bags and passing them to you, “Your father tasked me with collecting your items from Maximinus’ house.” You nod, “Thank you, Hakor…I’m sorry.” He only nods in response as silence overtakes you.

[[Sit in stillness down the Tiber.|P3RomeDisTruthCondemn3]]</tw-passagedata><tw-passagedata pid="218" name="P3RomeDisTruthCondemn3" tags="" position="4000,1425" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you, rushing over and grabbing your shoulders, “Are you okay?” You nod, taking his hands off your shoulders gently, “Yes, Cheops. I will be okay.” He nods, stiffening as he sees only Hakor, “I…uh, received a message from your father yesterday. The ship is ready to go whenever.”

[[Turn towards the barge.|P3RomeDisTruthCondemn4]]</tw-passagedata><tw-passagedata pid="219" name="P3RomeDisTruthCondemn4" tags="" position="4000,1550" size="100,100">Hakor unloads the barge, you spot your father’s bag, your bag, and a chest. He walks to the boat in silence. Cheops looks at you, “Well, [$name], that makes you the captain. What now?”

[[We flee. We go to Paramonos and go East.|EEastV3]]

[[We leave, and pray we can rebuild. I must continue the family business…in you and mother’s memory and honor.|EContV3]]

[[We leave, back to Alexandria. Sell everything, split the profits before we all go our separate ways. |EDreamV3]]</tw-passagedata><tw-passagedata pid="220" name="P3RomeAagree1" tags="" position="3300,425" size="100,100">Your father enters your room, having barely slept, you immediately sit up, alert. Your eyes meet, in his hands lay pieces of armor, “This was Maximinus’ son’s armor. He wanted me to give it to you for today.” You nod and take it, “Thank you, Father. What of Daria?” He looks to the side, “Maximinus believes she will be safe here. Do you?”

[[Yes.|P3RomeAgreeYes]]

[[No.|P3RomeAgreeNo]]</tw-passagedata><tw-passagedata pid="221" name="P3RomeAgreeNo" tags="" position="3600,550" size="100,100">“You don’t?” “No, Father. There has been much chatter about Liberatores Aegypti and I worry that her presence here poses a risk, especially since Augustus desperately wants to marry her off.” Your father nods, agreeing, “How insightful, just like your mother.” He turns to leave, before stopping and saying, “Dress. We have a big day ahead of us.” You nod.

[[Dress.|P3RomeAgreeNo2]]</tw-passagedata><tw-passagedata pid="222" name="P3RomeAgreeYes" tags="" position="3200,550" size="100,100">“Yes, I agree.” He nods, “Good. Get dressed, we have much to do.” You dress and wear the armor, feeling out of place. You scan the room, looking at your bag, debating on whether to grab it, but deciding against it.

[[Tighten the armor and leave.|P3RomeAgreeYes2]]</tw-passagedata><tw-passagedata pid="223" name="P3RomeAgreeNo2" tags="" position="3600,675" size="100,100">You dress in the armor, feeling out of place. You scan the room, grabbing your bag and exiting. You meet Maximinus, your Father, and Daria in the dining room. They all have their belongings prepared, your father nods, saying “We must make haste. Hakor has been tasked to prepare a barge.” 

[[Leave to Tiber.|P3RomeAgreeNo3]]</tw-passagedata><tw-passagedata pid="224" name="P3RomeAgreeNo3" tags="" position="3600,800" size="100,100">Upon meeting Hakor near the river, you all load the ship. He takes Daria, swearing, “Maximinus, Captain. I will watch guard over her and ensure her protection.” They nod and as you, Maximinus, and your Father leave, you turn to see an almost flustered Hakor helping a giddy Daria onto the barge. You smile to yourself, love often finds a way, even in the most chaos.

[[Meet the others.|P3RomeAgreeNo4]]</tw-passagedata><tw-passagedata pid="225" name="P3RomeAgreeNo4" tags="" position="3600,925" size="100,100">Throughout the day, you all meet with other members, sharing the Greek fire and reviewing the plan. The hope is to strike popular spaces as to cause chaos, allowing for an easier attempt at the emperor. You all leave, heading out and beginning the chaos.

[[Begin the conspiracy.|P3RomeAgreeNo5]]</tw-passagedata><tw-passagedata pid="226" name="P3RomeAgreeNo5" tags="" position="3600,1050" size="100,100">As Luna begins to take control of the sky, the plan comes into full effect. The soldiers are distracted by preventing the spread of the fire and the crowds flood the city so that it allows your group to approach the Curia Julia without resistance.[[^^1^^|P3RomeAgreeNo5CP]]

Your father places an arm out, preventing further movement, turning to you, “How do we approach this? With the might of Mars or the cunning of Hecate?”

[[We should storm the Curia Julia.|P3RomeAgreeNoMars]]

[[We should sneak into the Curia Julia.|P3RomeAgreeNoHecate]]</tw-passagedata><tw-passagedata pid="227" name="P3RomeAgreeNoMars" tags="" position="3500,1175" size="100,100">You all rush the stairs, guards having abandoned their posts to aid with fire prevention efforts. You all barge open the main hall’s door, finding Augustus, Agrippa, and others pouring over a map, dividing duties to bring the city back to order. They all snap their heads to your crowd, “Ha!” proclaims Augustus, “I should have known it was you behind this conspiracy, Maximinus!”

[[Listen.|P3RomeAgreeNoMars2]]</tw-passagedata><tw-passagedata pid="228" name="P3RomeAgreeNoHecate" tags="" position="3700,1175" size="100,100">Your group begins to approach, however your father halts, turning to Maximinus, “We must not let pride cloud our judgment, friend. Perhaps it is best to be discreet.” In spite of his anger, Maximinus breathes deeply, “Yes, Adamantios, I fear you are correct.” They turn to you, “[$name]. Please, you must try to assassinate the emperor.” 

[[Gulping, you nod and begin to climb up the stairs.|P3RomeAgreeNoHecate2]]</tw-passagedata><tw-passagedata pid="229" name="P3RomeAgreeNoHecate2" tags="" position="3700,1300" size="100,100">You miss the main hall and slip down the palace halls, running as your sword burns a hole in your hand. The Curia Julia remains largely deserted, however, nearing the corner, you find yourself panting. The task of assassinating Augustus suddenly feeling futile and suicidal. 

You begin to see the exit, the stairs become visible to your left. However, Agrippa appears from a column, his sword hanging at his side. You stop and gasp, shocked at his presence. Agrippa places his empty hands out with a shrug stating, “I will not harm you. I came here to speak.”

[[Listen to him.|P3RomeAgreeNoHecate3]]</tw-passagedata><tw-passagedata pid="230" name="P3RomeAgreeNoHecate3" tags="" position="3700,1425" size="100,100">“I have seen civil war, (if: $gender is &quot;Female&quot;)[girl] (if: $gender is &quot;Non-Binary&quot;)[child]. I have seen what it does to a country, to a people. You all here today–” he gestures around to the city, “You pursue a drowned dream, a mirage in the desert.” He pauses, beginning to walk toward you, stopping next to you, not even sparing a glance, “Do you understand?”

[[You reply, “Yes. Yes, I understand.”|P3RomeAgreeNoHecate4]]</tw-passagedata><tw-passagedata pid="231" name="P3RomeAgreeNoHecate4" tags="" position="3700,1550" size="100,100">“Good,” he replies, “then leave and never come back.” You nod, Agrippa already walking off, “Thank you.” Silence responds. 

[[You descend the stairs, the group of Liberatores Aegypti emerge around the corner.|P3RomeAgreeNoHecate5]]</tw-passagedata><tw-passagedata pid="232" name="P3RomeAgreeNoHecate5" tags="" position="3700,1675" size="100,100">You spot your father, and Maximinus. They look at you uncertainly, your father shakes slightly, “[$name]? Is it…” You shake your head, “I’m sorry, Father, I couldn’t do it.” 

He exhales shakily, “No…no my sweet, don’t apologize. We were foolish, utterly foolish. I’m just so relieved you’re okay.” You smile as he brings you to his chest, embracing you and kissing your head. He turns to everyone, “We must go to the Tiber immediately.” 

[[You nod as you begin to run towards the Tiber.|P3RomeAgreeNoHecate6]]</tw-passagedata><tw-passagedata pid="233" name="P3RomeAgreeNoHecate6" tags="" position="3700,1800" size="100,100">As you approach the river, Hakor sees you all and gestures, informing you, “I prepared the barge for our escape.” You all quickly approach and begin to get into the barge, helping others before taking off. 

You thank Hakor for preparing the barge and he nods, replying “Of course, [$name]. We all had a role to play today. You did yours fantastically. Plus, we were able to keep this lovely lady safe” He gestures at Daria, who blushes, causing Hakor’s eyes to widen before he quickly looks away, “I apologize that was quite forward.” 

Maximinus groans in protest, “Please, Hakor, I have had enough battles in my primary duty of fatherhood!”

[[You and Daria giggle as Hakor clears his throat, reaching below his seat.|P3RomeAgreeNoHecate7]]</tw-passagedata><tw-passagedata pid="234" name="P3RomeAgreeNoHecate7" tags="" position="3700,1925" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, who smiles at her and ruffles her hair, much to her disapproval. 

[[Enjoy the silent trip down the Tiber.|P3RomeAgreeNoHecate8]]</tw-passagedata><tw-passagedata pid="235" name="P3RomeAgreeNoHecate8" tags="" position="3700,2050" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I’m okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeAgreeNoHecate9]]</tw-passagedata><tw-passagedata pid="236" name="P3RomeAgreeNoHecate9" tags="" position="3700,2175" size="100,100">Daria and Maximinus walk by, who grumbles in quiet protest over his blushing daughter as Hakor carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. 

Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m really relieved that you’re okay.” 

[[You smile and turn to your Father.|P3RomeAgreeNoHecate10]]</tw-passagedata><tw-passagedata pid="237" name="P3RomeAgreeNoHecate10" tags="" position="3700,2300" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[Yes, go to the Red Sea and begin a new merchant business.|ENewV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="238" name="P3RomeAgreeNoMars2" tags="" position="3500,1300" size="100,100">“It was only a matter of time – the way you butchered all those Romans at Actium. Did you think we would forget?” Maximinus’s voice rings out, “Perhaps we were just unlucky enough to have you be the victor.” 

Augustus darkens with rage, “And what is the point of all this…this…this anarchy? Rome grows exhausted with war! Why would we have fought so hard for peace?!” He gestures wildly to himself and the other generals, Agrippa stands at his right, his sword placed between his legs, he shows no fear. 

[[You worry about this petty squabble, deciding to yell out, “Liberty to Egypt!”|P3RomeAgreeNoMars3]]</tw-passagedata><tw-passagedata pid="239" name="P3RomeAgreeNoMars3" tags="" position="3500,1425" size="100,100">Maximinus and the others begin to throw a variety of Greek Fire, the room illuminating in rows of flame like Tartarus. You all storm the generals, you find yourself helping your father, clashing swords. 

You see Augustus swipe down one of the Liberatores Aegypti members, his vision trained on Maximinus, you quickly grab a fire grenade given to you that you saved. 

You throw it in front of Augustus, preventing him and creating a line of fire between them and Liberatores Aegypti, you yell, “We must go! We cannot win this!” Your father calls out, “Maximinus! This is bigger than us. We must flee. Now!” 

[[Maximinus nods, your group fleeing, taking advantage of the moment.|P3RomeAgreeNoMars4]]</tw-passagedata><tw-passagedata pid="240" name="P3RomeAgreeNoMars4" tags="" position="3500,1550" size="100,100">You run through the streets, with Maximinus and your father following. Your father yells out, “We must go to the Tiber immediately.” 

[[You nod and begin to lead the group towards the Tiber.|P3RomeAgreeNoMars5]]</tw-passagedata><tw-passagedata pid="241" name="P3RomeAgreeNoMars5" tags="" position="3500,1675" size="100,100">As you approach the river, Hakor sees you all and gestures, Daria sits behind him on the boat. You all quickly approach, helping others get on the barge before taking off.

You thank Hakor for preparing the barge and he nods, replying “Of course, [$name]. We all had a role to play today. You did yours fantastically. Plus, we were able to keep this lovely lady safe” He gestures at Daria, who blushes, causing Hakor’s eyes to widen before he quickly looks away, “I apologize that was quite forward.” 

Maximinus groans in protest, “Please, Hakor, I have had enough battles in my primary duty of fatherhood!”

[[You and Daria giggle as Hakor clears his throat, reaching below his seat.|P3RomeAgreeNoMars6]]</tw-passagedata><tw-passagedata pid="242" name="P3RomeAgreeNoMars6" tags="" position="3500,1800" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, who smiles at her and ruffles her hair, much to her disapproval. 

[[Enjoy the silent trip down the Tiber.|P3RomeAgreeNoMars7]]</tw-passagedata><tw-passagedata pid="243" name="P3RomeAgreeNoMars7" tags="" position="3500,1925" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you in your condition, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I will be okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeAgreeNoMars8]]</tw-passagedata><tw-passagedata pid="244" name="P3RomeAgreeNoMars8" tags="" position="3500,2050" size="100,100">Daria and Maximinus walk by, who grumbles in quiet protest over his blushing daughter as Hakor carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. 

Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m relieved you’re okay but I still worry about you. Let me take care of you when we take to the seas” 

[[You smile and turn to your Father.|P3RomeAgreeNoMars9]]</tw-passagedata><tw-passagedata pid="245" name="P3RomeAgreeNoMars9" tags="" position="3500,2175" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[No, I want to continue the family business…in you and mother’s memory and honor.|EContV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="246" name="P3RomeAgreeYes2" tags="" position="3200,675" size="100,100">You meet Maximinus, your Father, and Daria in the dining room. You smile at Daria who averts your gaze, her hands nervously grasping each other. Your father nods at your entrance, saying “We must make haste and meet the others.”

[[Meet the others.|P3RomeAgreeYes3]]</tw-passagedata><tw-passagedata pid="247" name="P3RomeAgreeYes3" tags="" position="3200,800" size="100,100">Throughout the day, you all meet with other members, sharing the Greek fire and reviewing the plan. The hope is to strike popular spaces as to cause chaos, allowing for an easier attempt at the emperor. You all leave, heading out and beginning the chaos.

[[Begin the conspiracy.|P3RomeAgreeYes4]]</tw-passagedata><tw-passagedata pid="248" name="P3RomeAgreeYes4" tags="" position="3200,925" size="100,100">As the hours continue and dusk takes over, Liberatores Aegypti has successfully created a state of anarchy with the city plunging into chaos.[[^^1^^|P3RomeAgreeYes4CP]] You begin to approach the Curia Julia with Maximinus, your father, and a few other Liberatores Aegypti members. 

As you begin your approach, Hakor runs up, out of breath, “Sir! Wait! I went to your house as you instructed to bring Daria to the barge and she was gone.” 

[[You stop in shock.|P3RomeAgreeYes5]]</tw-passagedata><tw-passagedata pid="249" name="P3RomeAgreeYes5" tags="" position="3200,1050" size="100,100">Maximinus halts, enraged, and yells out telling everyone to prepare to meet Augustus head-on. Father turns to Hakor, “Go wait at the river. We need to have the barge ready to escape.” 

He nods, you all make way to the palace with purpose and passion burning. Your father grabs Maximinus’ shoulder, “Maximinus. We will get your daughter back.”
Maximinus shrugs your father’s hand, “We better.”

[[Enter the Curia Julia with confidence, loving the thrill of storming it.|P3RomeAgreeYesMars]]

[[Enter the Curia Julia with reluctance, hoping for a more discrete entrance.|P3RomeAgreeYesHecate]]</tw-passagedata><tw-passagedata pid="250" name="P3RomeAgreeYesMars" tags="" position="3100,1175" size="100,100">You all rush the stairs, guards having abandoned their posts to aid with fire prevention efforts. You all barge open the main hall’s door, finding Augustus, Agrippa, and others pouring over a map, dividing duties to bring the city back to order. They all snap their heads to your crowd, “Ha!” proclaims Augustus, “I should have known it was you behind this conspiracy, Maximinus!”

[[Listen.|P3RomeAgreeYesMars2]]</tw-passagedata><tw-passagedata pid="251" name="P3RomeAgreeYesHecate" tags="" position="3300,1175" size="100,100">Your group begins to approach, however your father halts, turning to Maximinus, “We must not let anger cloud our judgment, friend. Perhaps it is best to be discreet.” In spite of his anger, Maximinus breathes deeply, “Yes, Adamantios, I fear you are correct.” They turn to you, “[$name]. Please, you must retrieve Daria safely.” 

[[You nod and begin to climb up the stairs.|P3RomeAgreeYesHecate2]]</tw-passagedata><tw-passagedata pid="252" name="P3RomeAgreeYesMars2" tags="" position="3100,1300" size="100,100">“It was only a matter of time – the way you butchered all those Romans at Actium. Did you think we would forget?” Maximinus’s voice rings out, “Perhaps we were just unlucky enough to have you be the victor.” Tuning out their squabble, you notice that Daria is missing, your father leans in and whispers, “She isn’t here. Go and find her.” 

[[You nod, and during a moment of Augustus’ dramatic expressions, running to the left exit.|P3RomeAgreeYesMars3]]</tw-passagedata><tw-passagedata pid="253" name="P3RomeAgreeYesMars3" tags="" position="3100,1425" size="100,100">You run down the palace halls, your sword burning a hole in your hand. The Curia Julia remains largely deserted, however, at the end of the long hallway, two large wooden doors remain guarded, with a chain wrapped around the wooden beam locking it. Two large fire pits flank the doors, illuminating the dark, daunting building. 

You take a breath, preparing yourself to fight, however, the sounds of the battle in the hall grow louder, the two guards alert to this sound and begin to run towards the source.

[[You duck behind a column, your breath catching in your throat.|P3RomeAgreeYesMars4]]</tw-passagedata><tw-passagedata pid="254" name="P3RomeAgreeYesMars4" tags="" position="3100,1550" size="100,100">You run towards the door, yelling out, “Daria!” She yells back, “[$name]?!” “Yes! I’m here t–” “Where is my father?!” “He’s here, mine too.” “What’s happening? I’m so fr–” “Daria! We don’t have time right now. I need to open this door!” 

[[Slam your body into the door.|P3RomeAgreeYesMars5]]</tw-passagedata><tw-passagedata pid="255" name="P3RomeAgreeYesMars5" tags="" position="3100,1675" size="100,100">You slam into the door, it shakes. You realize there must be another way, “Daria, is there anything in the room you can use to open the door?” You hear her shuffling, wracking your mind, she yells out, “Nothing…I can’t open it!” 

[[You decide to slam your sword’s hilt into the lock.|P3RomeAgreeYesMars6]]</tw-passagedata><tw-passagedata pid="256" name="P3RomeAgreeYesMars6" tags="" position="3100,1800" size="100,100">You continually slam into the lock, it begins to weaken before you look up, closing your eyes and quickly praying to Isis for strength. You breathe deeply, pulling back and hitting the lock one final time. It shatters. You quickly remove the chains around the beam, yanking the beam onto the floor and rushing the doors open.  Daria, who looks completely different from earlier, runs toward you. Her usual pink dress replaced with a white one, her hair in an intricate hairstyle covered by a red-orange veil.^^255^^ When she ran towards you, you could see a glimpse of a matching shoe.^^256^^

[[Run down the hall.|P3RomeAgreeYesMars7]]

–––––––––––––––––
^^255^^ Aldrete, //Daily Life in the Roman City//, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On their wedding days, girls had their hair parted into six strands then tied atop their head into a cone shape.]
^^256^^ Aldrete, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Their wedding dress was a white tunic with a wreath of marjoram with a bright orange or red transparent veil matching her shoes.]</tw-passagedata><tw-passagedata pid="257" name="P3RomeAgreeYesMars7" tags="" position="3100,1925" size="100,100">You two run down the halls, leaving further down the halls opposite of the battle. As you begin to see the exit, the palace stairs become visible to your left. However, Agrippa appears from a column, his sword hanging at his side. 

You and Daria stop and gasp, shocked at his presence. You attempt to shield her, Agrippa places his empty hands out with a shrug stating, “I will not harm you. I came here to speak.”

[[Listen to him.|P3RomeAgreeYesMars8]]</tw-passagedata><tw-passagedata pid="258" name="P3RomeAgreeYesMars8" tags="" position="3100,2050" size="100,100">“I have seen civil war, (if: $gender is &quot;Female&quot;)[girl] (if: $gender is &quot;Non-Binary&quot;)[child]. I have seen what it does to a country, to a people. You all here today–” he gestures around to the Curia Julia and city, “You pursue a drowned dream, a mirage in the desert.” He pauses, beginning to walk toward you two, stopping next to you, not even sparing a glance, “Do you understand?”

[[You reply, “Yes. Yes, I understand.”|P3RomeAgreeYesMars9]]</tw-passagedata><tw-passagedata pid="259" name="P3RomeAgreeYesMars9" tags="" position="3100,2175" size="100,100">“Good,” he replies, “then take your friend, leave, and never come back.” You nod, Agrippa already walking off, “Thank you.” Silence responds, turning to Daria, you two nod, and run down the steps, yelling for your fathers to flee. 

[[As you yell, a group of Liberatores Aegypti fighters descend the stairs, Augustus and the other generals quickly following.|P3RomeAgreeYesMars10]]</tw-passagedata><tw-passagedata pid="260" name="P3RomeAgreeYesMars10" tags="" position="3100,2300" size="100,100">You spot your father, holding Maximinus, who limps and grabs his side. You check your pocket and find one last greek fire, throwing it behind them. You and Daria rush towards them, your father holds Maximinus’s left arm and you grab his right, your father stating, “We must go to the Tiber immediately.” 

[[You nod holding up Maximinus and begin to drag him towards the Tiber.|P3RomeAgreeYesMars11]]</tw-passagedata><tw-passagedata pid="261" name="P3RomeAgreeYesMars11" tags="" position="3100,2425" size="100,100">As you approach the river, Hakor sees you all and gestures. You all quickly approach and lay Maximinus along the seats, helping others get on the barge before taking off. 

You thank Hakor for preparing the barge and he nods, replying “Of course, [$name]. We all had a role to play today. You did yours fantastically.” He gestures at Daria, who blushes, causing Hakor’s eyes to widen before he quickly looks away. 

Maximinus groans in protest, “I may be injured, but do not think for one second my injury prevents my primary duty of fatherhood!”

[[You and Daria giggle as Hakor clears his throat, reaching below his seat.|P3RomeAgreeYesMars12]]</tw-passagedata><tw-passagedata pid="262" name="P3RomeAgreeYesMars12" tags="" position="3100,2550" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, wrapping his wound. 

[[Help care for Maximinus on the journey.|P3RomeAgreeYesMars13]]</tw-passagedata><tw-passagedata pid="263" name="P3RomeAgreeYesMars13" tags="" position="3100,2675" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I’m okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeAgreeYesMars14]]</tw-passagedata><tw-passagedata pid="264" name="P3RomeAgreeYesMars14" tags="" position="3100,2800" size="100,100">Daria and Hakor walk by, holding Maximinus who grumbles in light protest as they bring him aboard. A couple other crew members help unload the barge and pack the various items onto the ship. Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m really relieved that you’re okay.” 

[[You smile and turn to your Father.|P3RomeAgreeYesMars15]]</tw-passagedata><tw-passagedata pid="265" name="P3RomeAgreeYesMars15" tags="" position="3100,2925" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[No, I want to continue the family business…in you and mother’s memory and honor.|EContV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="266" name="P3RomeAgreeYesHecate2" tags="" position="3300,1300" size="100,100">You miss the main hall and slip down the Curia Julia&#39;s halls, running as your sword burns a hole in your hand. The building remains largely deserted, however, at the end of the long hallway, two large wooden doors remain guarded, with a chain wrapped around the wooden beam locking it. Two large fire pits flank the doors, illuminating the dark, daunting place. 

You take a breath, preparing yourself. Looking around the hall, you see the same series of busts when you visited with your father and Maximinus. You decide to push over the busts, creating a loud sound and toss your sword down the hall. You hear the guards approach as you hide behind a column. 

[[As the two begin to investigate, you are able to slip past them towards the door.|P3RomeAgreeYesHecate3]]</tw-passagedata><tw-passagedata pid="267" name="P3RomeAgreeYesHecate3" tags="" position="3300,1425" size="100,100">You run towards the door, speaking in a low tone, “Daria!” She responds, “[$name]?!” “Yes! I’m here t–” “Where is my father?!” “He’s here, mine too.” “What’s happening? I’m so fr–” “Daria! We don’t have time right now. I need to open this door!” 

[[Slam your body into the door.|P3RomeAgreeYesHecate4]]</tw-passagedata><tw-passagedata pid="268" name="P3RomeAgreeYesHecate4" tags="" position="3300,1550" size="100,100">You slam into the door, it shakes. You realize there must be another way, “Daria, is there anything in the room you can use to open the door?” You hear her shuffling, wracking your mind as you wildly look around for the guards, she responds, “Nothing…I can’t open it!” 

[[You decide to slam your sword’s hilt into the lock.|P3RomeAgreeYesHecate5]]</tw-passagedata><tw-passagedata pid="269" name="P3RomeAgreeYesHecate5" tags="" position="3300,1675" size="100,100">You continually slam into the lock, it begins to weaken before you look up, closing your eyes and quickly praying to Isis for strength. You breathe deeply, pulling back and hitting the lock one final time. It shatters, you hear the guards shuffling towards the door with concern. You quickly remove the chains around the beam, yanking the beam onto the floor and rushing the doors open. Daria, who looks completely different from earlier, runs toward you. Her usual pink dress replaced with a white one, her hair in an intricate hairstyle covered by a red-orange veil.^^255^^ When she ran towards you, you could see a glimpse of a matching shoe.^^256^^

[[Run down the hall.|P3RomeAgreeYesHecate6]]

–––––––––––––––––
^^255^^ Aldrete, //Daily Life in the Roman City//, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[On their wedding days, girls had their hair parted into six strands then tied atop their head into a cone shape.]
^^256^^ Aldrete, 60.
(align:&quot;&lt;==&quot;)+(box:&quot;=XXXXXXXXXXXXXXXXXX=&quot;)[Their wedding dress was a white tunic with a wreath of marjoram with a bright orange or red transparent veil matching her shoes.]</tw-passagedata><tw-passagedata pid="270" name="P3RomeAgreeYesHecate6" tags="" position="3300,1800" size="100,100">You two run down the halls, leaving further down the halls opposite to the main hall. As you begin to see the exit, the palace stairs become visible to your left. However, Agrippa appears from a column, his sword hanging at his side. 

You and Daria stop and gasp, shocked at his presence. You attempt to shield her, Agrippa places his empty hands out with a shrug stating, “I will not harm you. I came here to speak.”

[[Listen to him.|P3RomeAgreeYesHecate7]]</tw-passagedata><tw-passagedata pid="271" name="P3RomeAgreeYesHecate7" tags="" position="3300,1925" size="100,100">“I have seen civil war, (if: $gender is &quot;Female&quot;)[girl] (if: $gender is &quot;Non-Binary&quot;)[child]. I have seen what it does to a country, to a people. You all here today–” he gestures around to the city, “You pursue a drowned dream, a mirage in the desert.” He pauses, beginning to walk toward you two, stopping next to you, not even sparing a glance, “Do you understand?”

[[You reply, “Yes. Yes, I understand.”|P3RomeAgreeYesHecate8]]</tw-passagedata><tw-passagedata pid="272" name="P3RomeAgreeYesHecate8" tags="" position="3300,2050" size="100,100">“Good,” he replies, “then take your friend, leave, and never come back.” You nod, Agrippa already walking off, “Thank you.” Silence responds, turning to Daria, you two nod, and run down the steps. 

[[As you descend, the group of Liberatores Aegypti emerge around the corner.|P3RomeAgreeYesHecate9]]</tw-passagedata><tw-passagedata pid="273" name="P3RomeAgreeYesHecate9" tags="" position="3300,2175" size="100,100">You spot your father, and Maximinus, who rushes towards Daria. He embraces her with tears in his eyes, asking, “My light, are you alright?” 

Daria responds, “Yes, tata. I am safe.” You beam, your father stating, “As beautiful as this moment is” his arm slung around your shoulders, “We must go to the Tiber immediately.” 

[[You nod as you begin to run towards the Tiber.|P3RomeAgreeYesHecate10]]</tw-passagedata><tw-passagedata pid="274" name="P3RomeAgreeYesHecate10" tags="" position="3300,2300" size="100,100">As you approach the river, Hakor sees you all and gestures, informing you, “I prepared the barge for our escape.” You all quickly approach and begin to get into the barge, helping others before taking off. 

You thank Hakor for preparing the barge and he nods, replying “Of course, [$name]. We all had a role to play today. You did yours fantastically.” He gestures at Daria, who blushes, causing Hakor’s eyes to widen before he quickly looks away. 

Maximinus groans in protest, “Please, Hakor, I have had enough battles in my primary duty of fatherhood!”

[[You and Daria giggle as Hakor clears his throat, reaching below his seat.|P3RomeAgreeYesHecate11]]</tw-passagedata><tw-passagedata pid="275" name="P3RomeAgreeYesHecate11" tags="" position="3300,2425" size="100,100">He passes you and your father your bags from Maximinus’ house. He reaches under his seat again, dragging a chest, pushing it towards Daria, “Your father wanted you to have this.” She nods excitedly, as she turns to her father, who smiles at her and ruffles her hair, much to her disapproval. 

[[Enjoy the silent trip down the Tiber.|P3RomeAgreeYesHecate12]]</tw-passagedata><tw-passagedata pid="276" name="P3RomeAgreeYesHecate12" tags="" position="3300,2550" size="100,100">You make it back to Ostia, where Cheops has the ship ready to flee. He jumps upon seeing you, rushing over and grabbing your shoulders, “Are you okay?” You laugh, taking his hands off your shoulders gently, “Yes, Cheops. I’m okay.” He nods, stiffening as he faces your father, “Captain, I received your message yesterday. The ship is ready to go whenever.” 

[[Your father nods and places his hand on his shoulder.|P3RomeAgreeYesHecate13]]</tw-passagedata><tw-passagedata pid="277" name="P3RomeAgreeYesHecate13" tags="" position="3300,2675" size="100,100">Daria and Maximinus walk by, who grumbles in quiet protest over his blushing daughter as Hakor carries the chest. A couple other crew members help unload the barge and pack the various items onto the ship. 

Cheops looks at you, “[$name], I will go help prepare the final details for our departure,” as he walks away, he stops and looks back at you, “I’m really relieved that you’re okay.” 

[[You smile and turn to your Father.|P3RomeAgreeYesHecate14]]</tw-passagedata><tw-passagedata pid="278" name="P3RomeAgreeYesHecate14" tags="" position="3300,2800" size="100,100">He smiles and grabs your shoulder, “Come, my sweet (if: $gender is &quot;Female&quot;)[daughter,] (if: $gender is &quot;Non-Binary&quot;)[child,] let us burn the barge.” You two begin to light the wooden boat aflame, watching the amber glisten with a heavy silence, Father turns to you solemnly saying, “Everything has changed, (if: $gender is &quot;Female&quot;)[daughter] (if: $gender is &quot;Non-Binary&quot;)[child]. I must leave to exile. Do you want to come with me?”

[[Yes, live out in the East.|EEastV1]]

[[Yes, go to the Red Sea and begin a new merchant business.|ENewV1]]

[[No, I want to pursue my dreams.|EDreamV1]]</tw-passagedata><tw-passagedata pid="279" name="EEastV1" tags="" position="3675,3175" size="100,100">After fleeing Rome, you all made your way to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia.

You and your father stayed in a town near the sea, fishing and using your naval knowledge to your advantage along the coast of the Caspian. Maximinus became the town leader and advocated for your community with the Kingdom. While Daria and Hakor married, which did not surprise anyone. Life was simple, but good.

Years later, you had settled down with an Armenian from the town and had children. Your father lived with you until he passed. You buried him near the sea. You, your spouse, and your family lived a peaceful life. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="280" name="EEastV2" tags="" position="4225,1925" size="100,100">After fleeing Rome, you all made your way to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia.

You and your father stayed in a town near the sea, fishing and using your naval knowledge to your advantage along the coast of the Caspian. Daria and Hakor eventually married as he supported her throughout her grief. Life was simple, but good.

Years later, you had settled down with an Armenian from the town and had children. Your father lived with you until he passed. You buried him near the sea. You, your spouse, and your family lived a peaceful life. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="281" name="EEastV3" tags="" position="3850,1925" size="100,100">After fleeing Rome, you all made your way to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia.

You and the crew stayed near the sea, you fish and use your naval knowledge to your advantage along the coast of the Caspian. Life was simple but solemn, often silent and haunted by the mistakes of your past.

You live the rest of your life by the Caspian Sea, by yourself. Although life gets better, you constantly think of that night, when you condemned your father, Maximinus, and Daria to death, you had no idea that you also condemned yourself.

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="282" name="EContV3" tags="" position="3975,1925" size="100,100">After fleeing Rome, you take command of the ship and sail to Alexandria, to begin the trading route again. You don’t dare go beyond Messina, maintaining the usual routes. 

Business flourishes with an increased demand for Egyptian goods, and you find yourself ironically fulfilling another one of your father’s dreams of expanding the business to a second ship.

You continue in the motions, hoping to ease the hauntings of that night, when you condemned your father, Maximinus, and Daria to death, and yourself.

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="283" name="EDreamV3" tags="" position="4100,1925" size="100,100">After fleeing Rome, you and the crew went to Alexandria, where everyone agreed to go their separate ways, selling everything, including the ship, and splitting the money. Some took off to start their own merchant businesses while others settled throughout Egypt and beyond. You decided to stay in Alexandria, pursuing your dreams of becoming a scholar and studying philosophy. 

You continued in your philosophical studies and teachings, immersing yourself in a stoic approach to life to remedy the agony of your soul from that choice that damned your life. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="284" name="EContV2" tags="" position="4350,1925" size="100,100">After fleeing Rome, you take command of the ship and sail to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia for your father, Daria, and Hakor, who has a soft spot for her. You tearfully bade your father goodbye, praying to Isis for his protection, success, and a hope to see him again. 

The crew sets off for Alexandria, to begin the trading route again. You don’t dare go beyond Messina, maintaining the usual routes. Business flourishes with an increased demand for Egyptian goods, and you find yourself able to fulfill another one of your father’s dreams of expanding the business to a second ship.

Years later, you had expanded new trading routes to Carthage. You smile as you stand on the helm, wondering if your father knows your success. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="285" name="EDreamV2" tags="" position="4475,1925" size="100,100">After fleeing Rome, you all made your way to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia for your father, Daria, and Hakor, who had provided her comfort during her grief. You tearfully bade your father goodbye, praying to Isis for his protection, success, and a hope to see him again. 

You and the crew then went to Alexandria, where everyone agreed to go their separate ways, selling everything, including the ship, and splitting the money. Some took off to start their own merchant businesses while others settled throughout Egypt and beyond. You decided to stay in Alexandria, pursuing your dreams of becoming a scholar and studying philosophy.

Eventually marrying a Roman strategos and having children together. You, your Roman spouse, and your children enjoyed a peaceful and quiet life.

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="286" name="ENewV1" tags="" position="3825,3175" size="100,100">After fleeing Rome, you all made your way back to Egypt, taking the risk of landing in Alexandria where you sell as much as possible, including the ship.

You and the others are able to secure passage to the port of Berenice where you settle in the kingdom of Kush, taking your money to purchase a smaller trading vessel and continuing in the merchant business.

Daria and Hakor, who had a connection, decided to remain on land with Maximinus, establishing themselves in the capital, Meroe.

You stayed on the rough seas with your father until he was too old, when you two decided to settle along the Red Sea. Eventually you buried your father and lived the rest of your life in quiet peace. Enjoying the wealth that Red Sea trading provided. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="287" name="EDreamV1" tags="" position="3975,3175" size="100,100">After fleeing Rome, you all made your way to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia for your father, Maximinus, Daria, and Hakor, who had bonded with her. You tearfully bade your father goodbye, praying to Isis for his protection, success, and a hope to see him again. 

You and the crew then went to Alexandria, where everyone agreed to go their separate ways, selling everything, including the ship, and splitting the money. Some took off to start their own merchant businesses while others settled throughout Egypt and beyond. You decided to stay in Alexandria, pursuing your dreams of becoming a scholar and studying philosophy.

Eventually marrying a Roman strategos and having children together. You, your Roman spouse, and your children enjoyed a peaceful and quiet life.

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="288" name="EContV1" tags="" position="3525,3175" size="100,100">After fleeing Rome, you take command of the ship and sail to Paramonos of Rhodes, who helped arrange means of escape through Asia Minor to Armenia for your father, Maximinus, Daria, and Hakor, who had bonded with her. You tearfully bade your father goodbye, praying to Isis for his protection, success, and a hope to see him again. 

The crew sets off for Alexandria, to begin the trading route again. You don’t dare go beyond Messina, maintaining the usual routes. Business flourishes with an increased demand for Egyptian goods, and you find yourself able to fulfill another one of your father’s dreams of expanding the business to a second ship.

Years later, you had expanded new trading routes to Carthage. You smile as you stand on the helm, wondering if your father knows your success. 

[[Redo the entire conspiracy (or press the back arrow to try another ending)|P3Rome]]

[[//End of the Winds of Actium//|End]]</tw-passagedata><tw-passagedata pid="289" name="P1PSMarketFood" tags="" position="1075,450" size="100,100">You look at Cheops who has his mouth comically opened as you inform the vendor you will take two orders of the fish soup and bread. He grunts loudly and begins to prepare your order. 

Cheops quietly says, “Maybe I didn’t want the fish soup.” You swipe his chest, and the two of you laugh.

[[Pay for the food.|P1PSMarketEat]]</tw-passagedata><tw-passagedata pid="290" name="P1PanStart3" tags="" position="875,1750" size="100,100">Approaching the Villa, you are overcome by its grandiose nature with no outward windows but made of marble. An average-height man with graying short hair and a beard wearing a black toga with sandals happily waits outside, and waved with a smile upon seeing your father.[[^^1^^|P1PanStart3CP]]

[[I am Maximinus, it is wonderful to meet you all.|P1PanVilla]]</tw-passagedata><tw-passagedata pid="291" name="Exposition" tags="" position="600,25" size="100,100">Welcome to the //Winds of Actium//! Before continuing on, I would like to provide some brief information about the game.

//Winds of Actium// is a historical fiction set in the year 13 BCE, which is 18 years after the Battle of Actium with Augustus, Agrippa, Antony, and Cleopatra. Due to being a historical fiction, some details have been tweaked. Certain moments in the game will either have a citation leading to another passage within the game containing additional information or contain a &quot;footnote&quot; at the bottom of the passage.

The main character (who is you, dear Player!) is female-coded, which informs how they navigate spaces and interact with people in the Roman Empire. You can choose to use She/Her pronouns or They/Them pronouns in the next passage.

[[Happy playing and I hope you enjoy!|CharacterInfo]]</tw-passagedata><tw-passagedata pid="292" name="IntroductionCP" tags="" position="775,275" size="100,100">Seasonal weather conditions detailed sailing schedules over distances.^^1^^ The summer was peak sailing season as the Mediterranean sea created violent storms in the winter.^^2^^ While one source cites the sailing season as limited to only 3 to 4 months in the summer, another source states that the sailing season was limited to the late spring, summer, and early fall. The sailing season was commemorated in March with an annual festival for Isis as she was the patron goddess of mariners.^^3^^

What we can know is that it is reasonable to place //Winds of Actium// within the summer with the occurrence of the sailing season.

[[Return to Game|Introduction]]

–––––––––––––––––
^^1^^ Steven E. Sidebotham, //Berenike and the Ancient Maritime Spice Route// (University of California Press, 2011), 208–9.
^^2^^ Gregory S. Aldrete, //Daily Life in the Roman City: Rome, Pompeii, and Ostia //(Bloomsbury Publishing USA, 2004), 199.
^^3^^ Lionel Casson, //Everyday Life in Ancient Rome// (JHU Press, 1998), 86–88; Aldrete, Daily Life in the Roman City, 199.</tw-passagedata><tw-passagedata pid="293" name="introfatherchatCP" tags="" position="900,400" size="100,100">With correct breezes, ships average around four to six knots.^^4^^ One source states that freighters could get from Ostia to Alexandria with proper wind in ten to fourteen days while another states that with proper winds, vessels could travel from Naples to Alexandria in fourteen days, Naples to Athens in seven, Athens to Asia Minor’s west coast in a few days. However, traveling from Alexandria to Rome could take up to two and a half months due to the northern winds in the Eastern Mediterranean.^^5^^ 

Most shipping routes reached Asia Minor through Rhodes then to Syracus in Sicily before continuing north through the Strait of Messina.^^6^^ During the sailing season, vessels could complete a round trip or a trip and a half, as full trips took between fifty to seventy days.^^7^^ 
In this game, we have accelerated the timeline so as to compress the game, but it is important to note how seafaring occurred in reality based on the winds of the Mediterranean.

Freighters also contained collapsible shelters which could function as sleeping quarters.^^8^^  In this instance, the collapsible shelter, which we can assume to function similarly to a tent, remains on the helm almost like an office for the high ranking crew members. 

[[Return to Game|introfatherchat]]

–––––––––––––––––
^^4^^ Lionel Casson, //The Ancient Mariners: Seafarers and Sea Fighters of the Mediterranean in Ancient Times //(Princeton University Press, 1991), 220.
^^5^^ Casson, 234; Casson, //Everyday Life in Ancient Rome//, 115.
^^6^^ Casson, //The Ancient Mariners//, 234.
^^7^^ Casson, 234.
^^8^^ Casson, 234; Lionel Casson, //Everyday Life in Ancient Rome //(JHU Press, 1998), 114.</tw-passagedata><tw-passagedata pid="294" name="introfatherchatromeCP" tags="" position="300,525" size="100,100">Seafaring was a lucrative business industry as long-distance trade with Eastern goods like spice, fabric, and dyes could yield high returns.^^9^^ However, the process of building and funding a merchant ship required a lot of upfront investment and was extremely risky due to concerns from the lack of storm predictive technology and piracy which heavily preyed upon merchant ships.^^10^^ Typically, Roman aristocrats would fund merchant shipping due to their resources and potentially high yield responses.^^11^^ Roman senators and sons of senators used to own merchant ships due to the monetary responses which eventually became illegal in the first century AD, however to circumvent legislative restrictions, Romans took advantage of the patron/client relationship.^^12^^

[[Return to Game|introfatherchatrome]]

–––––––––––––––––
^^9^^ Aldrete, //Daily Life in the Roman City//, 194.
^^10^^ Aldrete, 194, 199.
^^11^^ Aldrete, 194.
^^12^^ Aldrete, 194.</tw-passagedata><tw-passagedata pid="295" name="introendnightCP" tags="" position="350,1025" size="100,100">There were three classes of vessels according to their storage sizes: Common smaller vessels with 75 tons or less, medium vessels with 75 to 200 tons, and rare larger vessels with 250 tons.^^14^^ Egyptian grain freighters were larger vessels that had an average storage of 250 tons.^^15^^ These large vessels with storage up to 250 tons were sailing in the late first century BC to first century AD.^^16^^ Roman merchant ships usually were broad-beamed with a single mast and large sails.^^17^^ Freighters of appreciable size could house crew mates in their cabin space.^^18^^

With this information, we can assume that the merchant ship, //The Akhet//, is a common vessel with a maximum storage capacity of 75 tons and could potentially house a cabin space. In the game, I decided to do a mixed approach where the lower deck includes living quarters amongst the storage through hammocks while the high-ranking crew members have an almost de-facto cabin space delineated by a sheet. In the game, MC grew up sleeping in this high-ranking crew cabin space before leaving for the main cargo hold when they turned 16.

[[Return to Game|introendnight]]

–––––––––––––––––
^^14^^ Sidebotham, //Berenike and the Ancient Maritime Spice Route//, 196.
^^15^^ Aldrete, //Daily Life in the Roman City//, 215.
^^16^^ Sidebotham, //Berenike and the Ancient Maritime Spice Route//, 196.
^^17^^ Aldrete, //Daily Life in the Roman City//, 215.
^^18^^ Casson, //The Ancient Mariners//, 216–18.</tw-passagedata><tw-passagedata pid="296" name="itemstatuetteCP" tags="" position="600,1325" size="100,100">Isis worship was popular among men and women, but particularly women due to her depiction as an ideal wife and mother, but men were also interested in her depiction as a nurturer.^^19^^ Devotees noted a sense of liberation, hope, and joy from worshipping her.^^20^^ In the Mediterranean world, Isis was essentially fused with Demeter, Aphrodite, Artemis, and other goddesses in the Mediterranean: she wielded multiple titles ranging from a divine ruler over the universe, underworld, and nature, to a patron of health, beauty, love, abundance, wisdom, and having a relation to the seas.^^21^^ She originated in Egypt but was popular across Greece, Sicily, and Southern Italy.^^22^^

Praying to Isis for sea protection and concerns with the underworld were well within her realm of influence, allowing the MC to have a direct connection to Isis through both their professional and private life. Further, women strongly relating to Isis due to her maternal and wifely attributes makes the MC’s mother more typical for being a devoted follower. Worshippers also noted positive emotional responses through their worship, probably due to the omniscient maternal attitude of Isis, which the MC also experiences. 

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/547702/1171041/main-image&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Statue of a Ptolemaic Queen, perhaps Cleopatra VII//; 200–30 B.C; Egypt
&lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/548310/1214471/main-image&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Statuette of Isis nursing Horus//; 332–30 B.C; Egypt
&lt;/center&gt;

I imagine the figurine that MC has is more compact and smaller, allowing for worship on the go, similar to the Statuette of Isis nursing Horus which is 17 cm or about 6 inches tall and the medium, faience, is a glazed earthenware. But, I do not picture this figurine sitting or with Horus, but instead, with the size and medium in mind, but in the power pose like the Statue of a Ptolemaic Queen, perhaps Cleopatra VII. I find the image of Isis, who was connected to Cleopatra VII, in a striding power pose significant as it asserts power to a female figure, especially when examining the post-Actium attitudes on Cleopatra that disregarded her power and intellect as a ruler. The figurine-statuette counteracts this by placing emphasis through the traditional Egyptian depictions of pharaonic power and divine power, fusing the two. This fused site also speaks to the influence and effectiveness of Cleopatra VII’s legacy and image cultivation of her power through an explicitly divine principle.

[[Return to Game|itemstatuette]]

–––––––––––––––––
^^19^^ Aldrete, //Daily Life in the Roman City//, 160; Casson, //Everyday Life in Ancient Rome//, 86–88; Mark P. O. Morford and Robert J. Lenardon, //Classical Mythology// (Oxford University Press, 2007), 388.
^^20^^ Morford and Lenardon, //Classical Mythology//, 388.
^^21^^ Morford and Lenardon, 388; Casson, //Everyday Life in Ancient Rome//, 86–88.
^^22^^ Casson, //Everyday Life in Ancient Rome//, 86–88.</tw-passagedata><tw-passagedata pid="297" name="P1PSStartCP" tags="" position="1400,100" size="100,100">Roman affluent individuals were associated with monetary sponsorship of merchant vessels after the ban of senators or sons of senators owning merchant ships in the first century AD, leading them to turn to the transactional nature of the patron/client relationship.^^23^^ The patronage system not only allowed Romans to provide and receive services from their peers, but to also sponsor social and economic class inferiors.^^24^^ 

With this, it makes sense that Maximinus and Adamantios’ relationship stems from an almost proxy patronage that mutually benefits the two. Maximinus receives fortune from the trade while Adamantios receives sponsorship and further connections into more Roman circles.

[[Return to Game|P1PSStart]]

–––––––––––––––––
^^23^^ Aldrete, //Daily Life in the Roman City//, 194.
^^24^^ Aldrete, 44.</tw-passagedata><tw-passagedata pid="298" name="P1PSMarketCP" tags="" position="1400,300" size="100,100">//Popinae// was a Roman combination of a contemporary bar and fast food restaurant.^^25^^ Usually these places allow pedestrians to purchase a bowl of garum, which is fish entrails, heads, and fins mixed with herbs and olive oil, with a side of bread.^^26^^ The counters at the restaurants had two or three large clay pots with small fires underneath that had gruel, fish stew, and garum, purchased by the ladleful.^^27^^ These walk-up food places allowed a person to stop and quickly eat their food before continuing on.^^28^^ If someone wanted full service, they would walk through the shop to a back room.^^29^^ Further, the clientele at these places was for sailors, slaves, muleteers, which referred to people who pulled carts with mules, and other street drifters.^^30^^

MC and Cheops purchase a bowl of garum with bread at a //popinae//, which was typical due to their profession as well as being a convenient food service.


[[Return to Game|P1PSMarket]]

–––––––––––––––––
^^25^^ Aldrete, //Daily Life in the Roman City//, 192.
^^26^^ Aldrete, 112.
^^27^^ Aldrete, 192.
^^28^^ Aldrete, 192; Casson, //Everyday Life in Ancient Rome//, 118.
^^29^^ Casson, //Everyday Life in Ancient Rome//, 118.
^^30^^ Casson, 118.</tw-passagedata><tw-passagedata pid="299" name="P1PanD2Tav5bCP" tags="" position="875,3175" size="100,100">Daria would have been raised in the household, typical for girls, and the chief figure would have been her mother who supervised her education.^^110^^ Girls usually received an education on reading, writing, and literature, but excessive knowledge or intellectualism was not accepted.^^111^^ Without her mother, Maximinus would have had to directly intervene and supervise her education, instilling Republican values of frugality, industriousness, restraint, piety, self-effacement, obedience, control of emotions, and a stoic demeanor.^^112^^ As the paterfamilias, he held the power over his family and would arrange marriages.^^113^^ Daughters came of age between twelve to fifteen, partially explaining why Daria was sent to Rome.^^114^^ As an of-age daughter, she needed to directly represent her father and their family socially in Rome to maintain relevance and respectability among the upper class.

The term for a prostitute was //meretrix// and prostitution was legal in Rome, with taxes calculated from her first daily client’s payment.^^115^^

[[Return to Game|P1PanD2Tav5b]]

–––––––––––––––––
^^110^^ Aldrete, //Daily Life in the Roman City//, 56–58.
^^111^^ Aldrete, 56–58.
^^112^^ Aldrete, 56–58.
^^113^^ Casson, //Everyday Life in Ancient Rome//, 11.
^^114^^ Casson, 11.
^^115^^ Aldrete, //Daily Life in the Roman City//, 117.</tw-passagedata><tw-passagedata pid="300" name="P1PanD2Tav4CP" tags="" position="1100,3175" size="100,100">Women in masculine roles were viewed as unwomanly and monstrous.^^107^^ The women who worked at taverns, or //tabernae//, had negative reputations and were considered equivalent to prostitutes, regardless if their capacity within the tavern was as a tavern keeper, waitress, barmaid, or cook.^^108^^

Sabina would have been viewed negatively by her peers due to her position as a tavern keeper as well as her masculine role in maintaining management over the business independently from a man. Despite being a widow of a civil war veteran, she would also have been looked down upon as women were expected to remarry one year after being widowed if aged 20 to 50.^^109^^

[[Return to Game|P1PanD2Tav4]]

–––––––––––––––––
^^107^^ Aldrete, //Daily Life in the Roman City//, 58.
^^108^^ Aldrete, 58.
^^109^^ Aldrete, 61.</tw-passagedata><tw-passagedata pid="301" name="P1PanD2MarketCFigurineCP" tags="" position="1200,2750" size="100,100">Egyptians were often demonized through either primitivization of the native and country Egyptians or through feminization and //luxuria//, degrading them as being uncivilized while also critiquing an excessive hedonistic tendency.^^104^^ This occurred through Latin literature upholding stereotypes in the works of Juvenal, Horace, Virgil, and Propertius.^^105^^ These works also lament and reduce Cleopatra as this imagined Egyptian, misconstruing her Greek identity and further erasing the Greco-Egyptian heritage under Ptolemaic Egypt.^^106^^

This young boy, growing up in a culture that demonizes Egypt, has a misconstrued, imagined, and exaggerated Egypt, finds interest in speaking to MC as a mode of understanding the fantastical landscape and people of Egypt. His interest, while based on propaganda, shows his innocent and open nature as a child. 

[[Return to Game|P1PanD2MarketCFigurine]]

–––––––––––––––––
^^104^^ Nancy Shumate, //Nation, Empire, Decline: Studies in Rhetorical Continuity from the Romans to the Modern Era// (A&amp;C Black, 2013), 130.
^^105^^ Shumate, 132; Shumate, 145.
^^106^^ Shumate, 145.</tw-passagedata><tw-passagedata pid="302" name="P1PanD2MarketCGlossCP" tags="" position="1575,2625" size="100,100">Crafts were usually precious materials with metal containers and imitated favored works by Greek artists.^^101^^ Toreutics, which is the art of creating embossed metal containers, was a popular style in the Augustan period and was recreated through clay, ceramic, and glass mediums.^^102^^ Pieces were usually engraved with visual motifs of vines, animals, hunting scenes, and had distinctive stapes and leafy designs.^^103^^

This young boy works with clay, but follows the trends in crafts by relaying the visual motifs of vines, hunting, animals, and leaves, which was also common at the time.

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/250773/531215/main-image&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Terracotta bowl//; ca. 20 BCE – 10 CE; Rome
&lt;/center&gt;

The terracotta bowl with classical references, relates to Augustus‘s social and cultural changes in Rome. By blending Hellenistic artistic standards with motives of vegetation and hunting, amid scenes of classical reference, it reflects his ushering in a golden era for Rome, politically, economically, and most importantly culturally. The fused element of Hellenistic art with Roman values also speaks to Augustus’s changes in viewing the empire as a cohesive unit, which Anthony threatened to divide into related kingdom, dynasties through the donations of Alexandria. By using art to communicate a universal and new era, Augustus aligns himself with not only tradition, but a promise of Roman continuity and prosperity.

[[Return to Game|P1PanD2MarketCGloss]]

–––––––––––––––––
^^101^^ Ada Gabucci, //Ancient Rome: Art, Architecture and History// (Getty Publications, 2002), 20.
^^102^^ Gabucci, 20.
^^103^^ Gabucci, 20.</tw-passagedata><tw-passagedata pid="303" name="P1PanD2MarketJCP" tags="" position="950,2575" size="100,100">Jewelry was associated with women and they often wore necklaces, earrings, bracelets, and other types of rings.^^98^^ Men usually wore a signet ring or fastened cloaks with brooches.^^99^^ General adornment and jewelry was viewed as feminine and expected for women, but men wearing too many articles of jewelry was frowned upon and effeminate.^^100^^

&lt;center&gt; &lt;img src=&quot;https://media.britishmuseum.org/media/Repository/Documents/2022_7/19_11/ffd71abf_4659_4143_9a3e_aed700c1fc46/mid_GAA29736__1_.jpg&quot; width=&#39;300&#39;\&gt; &lt;img src=&quot;https://media.britishmuseum.org/media/Repository/Documents/2022_7/19_11/217e3735_f4a5_4723_9f9a_aed700c1fdf4/mid_GAA29736__2_.jpg
&quot; width=&#39;300&#39;\&gt; 
Unknown artist;// finger-ring//; c. 1st c BCE - 2nd c. CE
&lt;/center&gt;

Due to the gendered nature of jewelry, MC can only purchase a ring as it would have been the only appropriate for Maximinus to wear a ring.

[[Return to Game|P1PanD2MarketJRing]]

–––––––––––––––––
^^98^^ Davies and Llewellyn-Hones, “Gender and Sexuality,” 90.
^^99^^ Davies and Llewellyn-Hones, 90.
^^100^^ Davies and Llewellyn-Hones, 90; Aldrete, //Daily Life in the Roman City//, 249.</tw-passagedata><tw-passagedata pid="304" name="P1PanD2CP" tags="" position="1425,2350" size="100,100">Wall paintings were ornamental with various motifs related to //tryphe// and Egypt through cornucopias, eagles, lotus-buds, palmettes, rosettes, and Isis cult symbols.^^94^^ In addition, gardens in houses were elaborately landscaped with flower beds, shade trees, marble benches, artworks, ponds, and even had herbs, fruits, and vegetables.^^95^^ Augustan era domus changes emphasize views, one of the modifications was a cut through the peristyle that extended to the edge of the platform.^^96^^

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/247008/536446/main-image&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Wall painting from the west wall of Room L of the Villa of P. Fannius Synistor at Boscoreale//; ca. 50–40 BCE; Villa of P. Fannius Synistor Naples
&lt;/center&gt;

Within Maximinus’ villa, the walls follow second-style ornamentation which were more visually related to luxury and Egyptianizing elements, speaking to the trends and previously greater Roman societal attitudes. Nature and viewpoints were also important as the peristyle in the villa contains lush vegetation with sweeping panoramic views of the Sicilian coast. These details not only further align with the wall’s ornamentation, but also to the luxurious and expensive nature of the villa, contrasting with Rome’s more humble and modest approach. The villa is, in a sense, a time capsule of Rome’s past but also a site of opposition towards their contemporary cultural and societal changes.

The standard garment for Romans was a straight and baggy tunic, which was knee length or mid-calf length and belted at the waist for men and was ankle-length or longer and belted below the bust for women.^^97^^

As a perceived woman, MC would have been expected to wear a longer garment at a minimum to their ankles, however due to the active nature of their work, they wear a garment with “male” lengths of either knee or mid-calf. Despite the shortened nature of their clothes, they still wear the belt below the bust, complicating their gender expression by expressing both male and female fashion binaries.

[[Return to Game|P1PanD2]]

–––––––––––––––––
^^94^^ Clarke,// The Houses of Roman Italy, 100 B.C.- A.D. 250//, 47–48; Clarke, 52.
^^95^^ Aldrete, //Daily Life in the Roman City//, 107–8.
^^96^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 19–23.
^^97 ^^Davies and Llewellyn-Hones, “The Body,” 53; Davies and Llewellyn-Hones, “Gender and Sexuality,” 87.</tw-passagedata><tw-passagedata pid="305" name="P1PanN1dCP" tags="" position="1425,2200" size="100,100">Burial depended on economic status.^^84^^ Poor people were thrown into open pits called //puticuli// which were quite large.^^85^^ There were burial clubs which had a membership fee of about 100 sesterces along with other monthly fees.^^86^^ Upon death, other members pay the price for the funeral.^^87^^ These burial clubs had an almost cave-like structure where urns with cremated remains would be kept called //columbaria//.^^88^^ Within these cave-like structures were adjunct dining facilities which honored the dead through a series of monthly feasts.^^89^^ The wealthiest Romans had tombs, however, these were not extremely respected as the materials for these tombs had been found being used for public toilets.^^90^^

However, in the Aeneid, a character is sacrificed to Neptune by falling into the water, to which Aeneas cries out, “Oh, trusting victim of calm sea and sky, unburied on some strange shore, Palinurus.”^^91^^ Later, in the underworld, Aeneas looks upon the unburied who cannot go beyond the Styx, “(Charon) cannot bring them past the grisly banks And roaring stream until their bones find rest.”^^92^^ The sacrificed character later pleads to Aeneas, “Give me at least a place of peace in death” to which a priestess responds that he will be buried through a city being built.^^93^^

Being unburied did not allow a soul to rest, and further having lost a body to the sea made the process of body recovery more difficult, thus leaving more people vulnerable in the afterlife.

[[Return to Game|P1PanN1d]]

–––––––––––––––––
^^84^^ Aldrete, //Daily Life in the Roman City//, 83–86.
^^85^^ Aldrete, 83–86.
^^86^^ Aldrete, 83–86.
^^87^^ Aldrete, 83–86.
^^88^^ Aldrete, 83–86.
^^89^^ Aldrete, 83–86.
^^90^^ Aldrete, 83–86.
^^91^^ Vergil, //The Aeneid//, trans. Sarah Ruden (Yale University Press, 2021), l. V.870-71.
^^92^^ Vergil, l. VI.327-28.
^^93^^ Vergil, l. VI.372; Vergil, l. VI.379-81.</tw-passagedata><tw-passagedata pid="306" name="P1PanN1bCP" tags="" position="1425,2025" size="100,100">The dining room was called a //triclinium// where guests laid down on couches as they ate, leaning on their left elbows.^^75^^ Centered around a square table were low benches or beds called //triclinia// in a U-shape which could seat three people.^^76^^ Couches on the back wall were called the //medius//, the couch on the right was the //summus//, and the left was the //imus//.^^77^^ Due to eating on the left elbow, the guest of honor received the most desired space on the left of the central couch while the host sat on the right.^^78^^ Dinner was divided into three courses.^^79^^ Appetizers included olives, snails, eggs, lettuce, leeks, mint, other vegetables and herbs, and shellfish.^^80^^ Main courses were a variety of meats, fowls, and fish, including pig udders, boat meat, and delicacies like eels and lampreys.^^81^^ Dessert was nuts and fruits like apples, pears, and figs.^^82^^ Wine was diluted with water and enjoyed spiced and warmed.^^83^^

[[Return to Game|P1PanN1b]]

–––––––––––––––––
^^75^^ Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^76^^ Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^77^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 17; Aldrete, //Daily Life in the Roman City//, 112.
^^78^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 17.
^^79^^ Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^80^^ Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^81 ^^Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^82 ^^Aldrete, //Daily Life in the Roman City//, 112; Casson, //Everyday Life in Ancient Rome//, 19.
^^83^^ Aldrete, //Daily Life in the Roman City//, 113.</tw-passagedata><tw-passagedata pid="307" name="P1PanVilla2CP" tags="" position="1400,1775" size="100,100">Walls were painted black, gold, and a deep blood-red shade, but typically in second-style were primarily yellow and red.^^67^^ Second-style wall paintings had regularly intervaled columns with illusionistic panels that had a three-dimensional impression and depth, mimicking a window and stage painting.^^68^^ These styles of paintings were common in Hellenistic dynastic throne rooms; the introduction into Roman elite spaces was unpolitical and theatrical.^^69^^ The ornamental motifs were associated with dynastical power and //tryphe// with the cornucopias, gloves, and eagles and in late second-style wall paintings, Egyptian ornaments appeared with lotus-bud capitals and friezes, palmettes, rosettes, and Isis cult symbols.^^70^^ The decoration style revolved around privileged luxury with depictions of fictitious colonnades of fauces, atriums, and peristyle walls to more complex perspectives of public and private spaces like fantastical cityscapes, architectural vistas or arches, tripods, gardens, and buildings.^^71^^

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/247017/536525/main-image&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Cubiculum (bedroom) from the Villa of P. Fannius Synistor at Boscoreale//; ca. 50–40 BCE; Villa of P. Fannius Synistor in Naples.
&lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/247017/540536/main-image&quot; width=&#39;600&#39;\&gt; 
Unknown artist; //Cubiculum (bedroom) from the Villa of P. Fannius Synistor at Boscoreale//; ca. 50–40 BCE; Villa of P. Fannius Synistor in Naples.
&lt;/center&gt;

These grandiously painted walls depict the changing attitudes in the last 1st century BCE amongst elite Roman classes. These images were not just status symbols of wealth but served a social function of communicating cultural awareness and openness amidst the Greco-Roman world. Their wealth afforded them leisure and by depiccting imagined landscapes of natural and urban settings, viewers were almost transported into these spaces. The luxury of this seemingly otherwordly place also aligned with Ptolemaic and Hellenistic beliefs of tryphe. With the integration of such detailed and lavish home decorations amongst Roman elite society in the late Republic, the appeal of the Ptolemaic display of wealthy appears to have resonated amongst them. This makes the Augustan art changes more noticable and politically oriented as he established himself in terms of returning Rome to a more traditional, modest, and conservative place. 

[[Return to Game|P1PanVilla2]]

–––––––––––––––––
^^67^^ Aldrete, //Daily Life in the Roman City//, 77; Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 52.
^^68^^ Aldrete, //Daily Life in the Roman City//, 77; Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 47-48.
^^69^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 47-48.
^^70^^ Clarke, 47–48; Clarke, 52.
^^71^^ Aldrete, //Daily Life in the Roman City//, 77.</tw-passagedata><tw-passagedata pid="308" name="P1PanVilla2bedCP" tags="" position="900,1975" size="100,100">Roman bedchambers, //cubiculums//, were only for sleeping.^^72^^ They sometimes had a small window and if they did, they would only have shutters.^^73^^ Furniture was limited to a bed, chair, chest, and a chamber pot.^^74^^

[[Return to Game|P1PanVilla2bed]]

–––––––––––––––––
^^72^^ Casson,// Everyday Life in Ancient Rome//, 31.
^^73^^ Casson, 31.
^^74^^ Casson, 31.</tw-passagedata><tw-passagedata pid="309" name="P1PanVillaCP" tags="" position="775,1925" size="100,100">Summer villas had a reverse order of the domus, with the peristyle first and then the tablinum.^^64^^ There was a greater emphasis on view as homes had more windows and additional rooms for lounging or panoramic viewpoints.^^65^^

Roman houses were decorated with Greek art, famous paintings in fresco form on walls and niches, with corners and colonnades decorated with bronze or stone statue replicas, and also had busts of the greatest in the past for atrium display.^^66^^

[[Return to Game|P1PanVilla]]

–––––––––––––––––
^^64^^ John R. Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250: Ritual, Space, and Decoration// (University of California Press, 1991), 19–23.
^^65^^ Clarke, 19–23.
^^66^^ Casson, //Everyday Life in Ancient Rome//, 32; Casson, 68.</tw-passagedata><tw-passagedata pid="310" name="P1PanStart3CP" tags="" position="750,1750" size="100,100">Men’s colors were limited to dark, white, and natural colors of undyed wool.^^55^^ In grief, people wore black, dark blue, and gray.^^56^^ In warm weather, the toga was replaced with a //centatoria//, a status symbol outfit with a tunic and small wrap called a //pallium//. ^^57^^ Roman men were usually clean shaven.^^58^^

Maximinus wears a black summer outfit and has a full beard, despite the standard being clean shaven. As seen in Augustus’s coin with his profile in a short beard and the reverse of a temple to the divinized Julius Caesar, Augustus’s adoptive father. Beards were a sign of mourning.

&lt;center&gt; &lt;img src=&quot;https://www.cngcoins.com/photos/big/10100435.jpg&quot; width=&#39;600&#39;\&gt;
Unknown artist; //Denarius of Caesar Augustus with beard and reverse of Temple of Divus Iulius with 44 BC Come//t; Minted in Lyons or in Rome for Roman use; c. 36 BCE
&lt;/center&gt;

Aristocratic villas were made from white marble and had no windows facing the street.^^59^^ The home’s entrance was called the //vestibulum//, which connected to the //atrium//.^^60^^ The //atrium// had a pool of water called an //impluvium//.^^61^^ The //tablinum// was on a raised platform which opened onto the //atrium//.^^62^^ Roman houses were decorated with Greek art, copies of famous paintings through wall and niche frescoes, and corners and colonnades decorated with bronze or stone statue replicas.^^63^^

[[Return to Game|P1PanStart3]]

–––––––––––––––––
^^55^^ Glenys Davies and Lloyd Llewellyn-Hones, “Gender and Sexuality,” in //A Cultural History of Dress and Fashion in Antiquity//, ed. Mary Harlow (Bloomsbury Publishing, 2018), 88.
^^56^^ Glenys Davies and Lloyd Llewellyn-Hones, “The Body,” in //A Cultural History of Dress and Fashion in Antiquity//, ed. Mary Harlow (Bloomsbury Publishing, 2018), 68.
^^57^^ Kelly Olson, “Status,” in //A Cultural History of Dress and Fashion in Antiquity,// ed. Mary Harlow (Bloomsbury Publishing, 2018), 113.
^^58^^ Aldrete, //Daily Life in the Roman City//, 249.
^^59^^ Aldrete, 75–76; David Watkin, //The Roman Forum// (Harvard University Press, 2012), 22–23.
^^60^^ Aldrete, //Daily Life in the Roman City//, 75–76.
^^61^^ Aldrete, 75–76.
^^62^^ Aldrete, 75–76.
^^63^^ Casson, //Everyday Life in Ancient Rome//, 32.</tw-passagedata><tw-passagedata pid="311" name="P1PSPCargo2CP" tags="" position="1175,1625" size="100,100">Frankincense, myrrh, and black pepper were the three most commonly imported commodities from India and the East.^^50^^ Frankincense was more expensive in the first century and sold for about 3 to 6 denarii per pound, with the highest quality sold at 100 denarii per pound.^^51^^ Myrrh was sold at about 3 to 50 denarii per pound, while troglodytic myrrh was sold at a maximum price of 400 denarii per pound.^^52^^ Black pepper was lower priced in the first century at about 4 denarii per pound.^^53^^ Despite these costs, these three commodities seemed regular products and were used in food recipes, medicine, and religious and funerary contexts.^^54^^

While these products are common commodities in Rome, they teeter between being a general product to a luxury product. Either way, the popularity of these objects due to their widespread and varied usage as well as the price ranges highlights the value they had at the time, making them highly desirable goods.

[[Return to Game|P1PSPCargo2]]

–––––––––––––––––
^^50^^ Sidebotham, //Berenike and the Ancient Maritime Spice Route//, 247.
^^51^^ Sidebotham, 247.
^^52^^ Sidebotham, 248.
^^53^^ Sidebotham, 248.
^^54^^ Sidebotham, 250.</tw-passagedata><tw-passagedata pid="312" name="P1PSPFireCP" tags="" position="1450,1225" size="100,100">Greek Fire refers to a variety of flammable compositions used in warfare. It was coined by the Byzantine Greeks in the 7th century.^^43^^ The idea of Greek Fire came from ancient sources with references to flaming arrows, firepots, and substances made of pitch, which is a tar of a kind, a partially refined oil product or liquid natural gas called naphtha, sulfur, and charcoal.^^44^^ Later, saltpetre, a potassium nitrate found in gunpowder, and turpentine, distilled resin, were added.^^45^^ Greek fire is clearly a petroleum-based mixture and could be thrown in pots or discharged from tubes.^^46^^ Apparently, it could not be extinguished through water and would catch fire spontaneously, which made it especially deadly in naval and water combat.^^47^^ The recipe was so guarded that the exact composition is still unknown in contemporary times.^^48^^

At this time, Greek Fire in the sense as it is conceived, was not technologically available to those in the first century AD. With this added detail, the game alters the historical timeline, which is part of why it is explained in terms of being magical.

[[Return to Game|P1PSPFire]]

–––––––––––––––––
^^43^^ Britannica, T. Editors of Encyclopaedia. &quot;Greek fire.&quot; Encyclopedia Britannica, November 4, 2024. https://www.britannica.com/technology/Greek-fire.
^^44^^ James Speight, “Chapter 10 - Processing Oil from Tight Formations,” in //Shale Oil and Gas Production Processes//, ed. James Speight (Gulf Professional Publishing, 2020), 573–668, https://doi.org/10.1016/B978-0-12-813315-6.00010-5; Wikipedia contributors, &quot;Pitch (resin),&quot; Wikipedia, The Free Encyclopedia, https://en.wikipedia.org/w/index.php?title=Pitch_(resin)&amp;oldid=1258999893.
^^45^^ Britannica, T. Editors of Encyclopaedia. &quot;Greek fire.&quot; Encyclopedia Britannica, November 4, 2024. https://www.britannica.com/technology/Greek-fire.
^^46^^ Britannica, T. Editors of Encyclopaedia. &quot;Greek fire.&quot; Encyclopedia Britannica, November 4, 2024. https://www.britannica.com/technology/Greek-fire.
^^47^^ Britannica, T. Editors of Encyclopaedia. &quot;Greek fire.&quot; Encyclopedia Britannica, November 4, 2024. https://www.britannica.com/technology/Greek-fire.
^^48^^ Britannica, T. Editors of Encyclopaedia. &quot;Greek fire.&quot; Encyclopedia Britannica, November 4, 2024. https://www.britannica.com/technology/Greek-fire.</tw-passagedata><tw-passagedata pid="313" name="P1PSPStartCP" tags="" position="1050,1100" size="100,100">Piracy was a national threat in the Late Republic.^^35^^ In 67 BCE, the Roman Republic drafted the special law, Lex Gabinia which granted Pompey the Great absolute power over the entire Mediterranean shoreline and up to 50 miles inland from the coast.^^36^^ He was given 20 legions and 270 ships.^^37^^ Since the Second Punic War, Rome would commandeer the forces of Rhodes, Marseille, and Phonenincian cities, Pompey also followed this tradition as the special law also gave governmental approval and authority to relinquish control over men, ships, money, and other needed resources.^^38^^ He divided the Mediterranean sea in 13 regions, establishing blockades, and selecting a commander and fleet for each region.^^39^^ The plan was for a simultaneous attack on pirate strongholds throughout the region as Pompey with sixty ships sailed from the western point of Gibraltar, eventually herding pirates to Cilicia, a point north of the island of Cyprus.^^40^^ Following the round up of pirates, Pompey did not slaughter each leader, but chose ones capable of reform to an interior relocation away from the sea.^^41^^ Within forty days, Pompey succeeded in eliminating widespread piracy, which would only continue through sporadic outbursts as he also established Roman naval bases.^^42^^

[[Return to Game|P1PSPStart]]

–––––––––––––––––
^^35^^ Aldrete, //Daily Life in the Roman City//, 216; Casson, //The Ancient Mariners//, 204–5.
^^36^^ Aldrete, //Daily Life in the Roman City//, 216; Casson, //The Ancient Mariners//, 204–5.
^^37^^ Aldrete, //Daily Life in the Roman City//, 216.
^^38^^ Casson, //The Ancient Mariners//, 204–5.
^^39^^ Aldrete, //Daily Life in the Roman City//, 216; Casson,// The Ancient Mariners//, 204–5.
^^40^^ Casson, //The Ancient Mariners//, 204–5.
^^41^^ Casson, 204–5.
^^42^^ Aldrete, //Daily Life in the Roman City//, 216; Casson, //The Ancient Mariners//, 204–5.</tw-passagedata><tw-passagedata pid="314" name="P2JRomeN1BraceletsCP" tags="" position="1800,1200" size="100,100">It was considered dishonorable if a husband was deeply in love with his wife.^^116^^ Adamantios clearly demonstrates a deep devotion to his deceased wife, unbecoming of men, specifically Roman men. However, as a non-Roman, ethnic-Greek Egyptian, Adamantios functions beyond the expectation of Romans and due to the negative Egyptian stereotypes as being effeminate and and uncivilized, Adamantios can, in a sense, operate with free will and autonomy and not fear about being dishonorable and acting inappropriately for Roman men.^^117^^

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/547710/1220399/main-image&quot; width=&#39;600&#39;\&gt;
Unknown artist; //Snake bracelet//; A.D. 1st century; Lower Egypt
&lt;/center&gt;

Snake spiral bracelets became popular under the Ptolemaic period and remained in fashion into the Roman periods.^^118^^ They were usually worn in pairs on both arms either on the wrist or arm.^^119^^ The snake’s tail was carefully curved to imitate the animal and the head and tail were textured in a cross hatching as mimicry of the snake’s scales.^^120^^ The snake is associated with healing properties so it is possible these had a protective measure.^^121^^

These snake spiral bracelets were made of gold and required careful craftsmanship seen with it being made of thin gold, the curve of the bracelet and the tail, as well as the textured cross hatching on the head and tail. The significance of the snake itself aligns with Isis and Serapis symbols, who were also associated with healing, but in regard to images of pharaonic power, notably the cobra uraeus. One of Cleopatra’s distinctive features in her Egyptian images is the triple uraeus, the snake bracelets connect in part with the association to Isis but also as a distinctive animal closely associated with her ruling and divine power.

[[Return to Game|P2JRomeN1Bracelets]]

–––––––––––––––––
^^116^^  Aldrete, //Daily Life in the Roman City//, 113.
^^117^^ Shumate, //Nation, Empire, Decline//, 130.
^^118^^ Museum of Metropolitan Art, //Snake Bracelet//, A.D. 1st century, gold, Diam: 3 9/16 in. (9.1 cm), A.D. 1st century, https://www.metmuseum.org/art/collection/search/547710; Getty Museum, //Snake Bracelet//, https://www.getty.edu/art/collection/object/103VN1.
^^119^^ Getty Museum, //Snake Bracelet//.
^^120^^ Getty Museum.
^^121^^ Museum of Metropolitan Art, //Snake Bracelet//.</tw-passagedata><tw-passagedata pid="315" name="P2RomeD3HouseFRChestCP" tags="" position="2575,3875" size="100,100">Isis was usually attributed and associated with the god Serapis, their cults were widespread and would eventually compete with Christianity.^^248^^ Isis and Serapis shared maternal and paternal concerns, promised health, safety, welfare, salvation, comfort, and reassurance through their clerical practices, making their cults easily transferable as they functioned independent of national cults and did not have explicit political elements outside of Egypt.^^249^^ When the Ptolemies came into power, they hellenized Osiris into Serapis where he became the patron god of their dynasty.^^250^^ Serapis eventually became fused with Greek and Egyptian elements: he was the ruler of the underworld and as husband to Isis, his association with her bounty and prosperity posited him as a healer of the sick and injured.^^251^^ Another key religious political element the Ptolemies did is they divided Alexandria into fifteen regions (//demes//) and named them after both Greek and Egyptian deities where they patronized cults, asserted their line of divinity as rulers through Dionysis, and established an explicitly multicultural capital celebrating their Macedonian-Greek background and Egyptian background of their subjects.^^252^^

By the time Adamantios was born, Egypt had been a synchronized environment of Greek and native Egyptian culture for over 200 years. His background as a Macedonian Greek and his wife’s background as a Native Egyptian parallel the story of Isis and Serapis. Within practice, the husband-wife divine gods offer vast interest due to the almost all-encompassing nature and vast comfort as a divine Father-Mother healing and savior nature. When evaluating their origin myths, it functions in tandem with Adamantios’ love story with his wife: a Greek husband and an Egyptian wife.

[[Return to Game|P2RomeD3HouseFRChest]]

–––––––––––––––––
^^248^^ Morford and Lenardon, //Classical Mythology//, 388; Mikalson, Petrovic, and Petrovic, //Ancient Greek Religion//, 188.
^^249^^ Mikalson, Petrovic, and Petrovic, //Ancient Greek Religion//, 189; Casson, //Everyday Life in Ancient Rome//, 86–88.
^^250^^ Mikalson, Petrovic, and Petrovic, //Ancient Greek Religion//, 188.
^^251^^ Mikalson, Petrovic, and Petrovic, //Ancient Greek Religion//, 188.
^^252^^ Mikalson, Petrovic, and Petrovic, 189; Mikalson, Petrovic, and Petrovic, 196.</tw-passagedata><tw-passagedata pid="316" name="P2RomeD3IPWCP" tags="" position="2150,3875" size="100,100">Roman friezes are different from Hellenistic ones not just in form and content as Romans are concerned with a completed story, allowing for flexibility in terms of perspectives.^^238^^ Romans preferred continuous narrative which meant that friezes contained both linear and aerial perspectives, as art was an illustration and imitation of life’s reality.^^239^^ Additionally, triumphs were a ceremonial affair that commemorated a military accomplishment of over five thousand slain enemies by carrying and displaying prisoners and spoils of war with scenes from the campaign.^^240^^ The celebrated general rode in a chariot dressed as Jupiter Optimus Maximus (Best and Greatest) with his face painted red in reference to the terracotta statue of Jupiter, while a slave held a laurel wreath above his head, whispering reminders of his mortality.^^241^^ Following a triumph ceremony, generals had laurel wreaths carved into their houses as a permanent marking of their achievement.^^242^^

In August of 29 BCE, Augustus celebrated three triumphs: one for his victories in Illyricum, one for his decisive victory in Actium, and the final for the capture of Alexandria that carried an effigy of Cleopatra, and various accompanying images.^^243^^ Cleopatra’s effigy had two snakes which clarified her death as either a poisonous snakebite or in a more abstract sense, poison.^^244^^ Cleopatra’s decision to commit suicide over being paraded through Rome as a prisoner created an air of recognition for her courage from Romans as they admired the value even in enemies.^^245^^

When looking at the Battle of Actium friezes, the shallow carvings, as well as third-dimensional aspect of the image.

&lt;center&gt; &lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/c/c5/Medinaceli_Actium_reliefs_02.jpg&quot; width=&#39;600&#39;\&gt; 
Unknown artist; //Roman marble relief depicting the naval battle at Actium.//; first half of the 1st century A.D.; Rome
&lt;/center&gt;

With the information on friezes and triumphs, a fictionalized element is added to the Curia Julia’s walls that depicts Augustus’s triumphs, notably his final defeat of Cleopatra and Antony through the annexation of Alexandria and Egypt. Using the context of the breastplate of the Prima Porta and the Ara Pacis, these fictionalized wall friezes create a powerful site for relaying Augustan political values and evaluate the reception of the defeat of a charged and personal enemy such as Antony and Cleopatra. I picture that these friezes are subtle in their political nature, with slight details suggesting an “Other” of Cleopatra and Antony through relying on //tryphe//, excess, vast ornamentation, grandeur, and explicitly Egyptian details. These motifs would communicate Antony and Cleopatra as incompatible with Augustus’s traditional and conservative Rome while depicting Augustus with Roman themes of victory, military achievement, statesmanship, and even draw upon his persona in the Prima Porta. 

[[Return to Game|P2RomeD3IPW]]

–––––––––––––––––
^^238^^ Peter von Blanckenhagen, “Narration in Hellenistic and Roman Art,” in //The Garland Library of the History of Art: Ancient Art: Roman Art and Architecture//, vol. 67 (Archaeological Institute of America, 1957), 82–83.
^^239^^ von Blanckenhagen, 82–83.
^^240^^ Goldsworthy, //Antony and Cleopatra//, 33.
^^241^^ Goldsworthy, 33.
^^242^^ Goldsworthy, 34.
^^243^^ Goldsworthy, 388.
^^244^^ Goldsworthy, 388.
^^245^^ Goldsworthy, 388.</tw-passagedata><tw-passagedata pid="317" name="P2RomeD3IPPPCA" tags="" position="2025,3875" size="100,100">After the civil war with Antony, Augustus reinvented himself from a warring general to a humble public figure restoring traditional mortality, family, and peace, a model citizen.^^231^^ His legislation reflected his values of tradition and family, notably by expanding legitimate marriage to former foreign slaves, he created a new pathway for citizenship leading to reliefs that celebrated the legitimacy of families and a shared Roman identity.^^232^^ Augustus had different representations, depending on his title and specific role.^^233^^ One method of representing himself was as a model statesman, war hero, and commander.^^234^^ By utilizing Greek artistic techniques to depict the body, Augustus aligns with his fused visual dictionary and specifically bases his statue on the famous Greek Doryphoros by Polyclitus.^^235^^ In this pose, Augustus raises his arm out to silence as the role in which he was representing himself implies public speaking.^^236^^ The appropriation of this Greek statue became the standard for Roman figures wearing breastplate armor.^^237^^

&lt;center&gt; &lt;img src=&quot;https://smarthistory.org/wp-content/uploads/2020/10/primaporta-tall.jpg&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Prima Porta Augustus//; Villa of Livia, Rome; early 1 century CE copy of a 20 BCE bronze original
&lt;/center&gt;

The breastplate is richly decorated with visual motives related to his rule, images of conquered lands through the submissively posed figures implied specific kingdoms and the sphinxes on the shoulder, which speak to the defeat of Egypt, as well as the created tradition of Egyptianizing motives in Roman art.^^238^^ 

The breast plate has different registers. The upper register aligns with the divine, specifically the gods related to the sun and sky, each are in action, implying a connection between the gods and Augustus whereas they bring about the days, Augustus brings about a new era. Apollo and Diana appear which is important because Augustus viewed himself as the son of Apollo. This relation to Apollo, as well as his sister, Diana, who are complementary gods of the sun and the moon further imply a divine order and inherent balance cultivated and restored under Augustus’s rule. The bottom of the breast plate has a figure lounging with a cornucopia which implies a prosperity and a newfound ability to have leisure and experience ease of mind which is supported and established under Augustus. The center of the breast plate has a Roman general receiving the Roman standards from a Parthian King, this connection between enemy states and a return of an important object speaks to Pax Romana, and the respect and restoration of Roman tradition that Augustus provides.

&lt;center&gt; &lt;img src=&quot;https://smarthistory.org/wp-content/uploads/2020/10/primaporta-breastplatefull.jpg&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Prima Porta Augustus//; Villa of Livia, Rome; early 1 century CE copy of a 20 BCE bronze original
&lt;/center&gt;

The breastplate of the Prima Porta depicts the various elements and layers that Augustus uses when representing his power and dedication to Rome. Not only does he showcase the expansion of empire, he also creates an everlasting and foundational peace to a Republic that has been warring and unstable. He further asserts his power through the divine, by explicit connection to ideas of divine and natural cosmic balance and harmony and a new era of prosperity and bounty that all exist under his peace. 

[[Return to Game|P2RomeD3IPPP]]

–––––––––––––––––
^^231^^ Gabucci, 12–13; Susan Walker, “The Moral Museum: Augustus and the City of Rome,” in //Ancient Rome: The Archaeology of the Eternal City//, ed. John Coulston and Hazel Dodge (Oxbow Books, 2000), 70.
^^232^^  Walker, “The Moral Museum: Augustus and the City of Rome,” 70.
^^233^^ Gabucci, //Ancient Rome//, 16.
^^234^^ Gabucci, //Ancient Rome//, 16.
^^235^^  Walker, “The Moral Museum: Augustus and the City of Rome,” 69; Gabucci, //Ancient Rome//, 16.
^^236^^ Gabucci, //Ancient Rome//, 16.
^^237^^ Gabucci, //Ancient Rome//, 16.
^^238^^ Peter von Blanckenhagen, “Narration in Hellenistic and Roman Art,” in T//he Garland Library of the History of Art: Ancient Art: Roman Art and Architecture//, vol. 67 (Archaeological Institute of America, 1957), 82–83.</tw-passagedata><tw-passagedata pid="318" name="P2RomeD3IPBustsCP" tags="" position="1875,3825" size="100,100">Augustan-era aristocratic and impersonal art looked to perfect technique and form through mixing general Italic elements with Hellenistic artistic trends, namely from the fifth and fourth century BCE, creating art that was coldly elegant.^^226^^ There was also an emphasis on Republican religious tradition and an abandonment of Hellenistic dynastic heroic images.^^227^^ Augustus established a visual dictionary for representing the imperial family in order to establish a dynasty, images were idealized and matched one another, creating a visual harmony that showcased the family’s legitimate power and functioned to indicate heirs through resemblance to emperors, calm facial expressions, and the same hairstyle.^^228^^ While there were individualized elements done by accentuating a specific trait for noticeable identification, these elements also showcase character traits as representation was not merely physical but reflective of one’s values.^^229^^

&lt;center&gt; &lt;img src=&quot;https://i.pinimg.com/474x/18/28/d6/1828d6c0673b75068ec7832cddc4ff52.jpg&quot; width=&#39;300&#39;\&gt;
Unknown artist; //Basanite portrait of Livia, Augustus’ wife with nodus//; c. 31 BCE.; Rome.
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Bust_of_Augustus_wearing_the_Corona_Civica%2C_ca._29_BC%2C_found_in_Rome%2C_Moi%2C_Auguste%2C_Empereur_de_Rome_exhibition%2C_Grand_Palais%2C_Paris_-_14464577048.jpg/740px-Bust_of_Augustus_wearing_the_Corona_Civica%2C_ca._29_BC%2C_found_in_Rome%2C_Moi%2C_Auguste%2C_Empereur_de_Rome_exhibition%2C_Grand_Palais%2C_Paris_-_14464577048.jpg?20200904065104&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Bust of Augustus wearing the Corona Civica//; ca. 29 BC; Rome
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/%28Toulouse%29_Portrait_de_Julie_Mus%C3%A9e_Saint-Raymond_Ra_338.jpg/800px-%28Toulouse%29_Portrait_de_Julie_Mus%C3%A9e_Saint-Raymond_Ra_338.jpg?20220310200935&quot; width=&#39;300&#39;\&gt;
Unknown artist; //Portrait of Julia the Elder//; 11 BC/12 BC; Rome
&lt;/center&gt;

Augustus, Livia, and other family members used their portraits to align with political agendas. For example, Livia’s hair contains a knot in the front which was introduced to counteract the gaudy hairstyles at the time.^^230^^ The women in Augustus’s family are depicted as youthful, idealized, conservative, and modest. They are model mothers and wives, supportive to their husbands and carefully chaste with their virtue, intellect, and sexuality. Their simplistic hair and clothes as well as the light realism with the loose hair strand in the back depict them as common, relatable, and humble, heavily contrasted with the tryphe, excessively accessorized, and liberal Egyptians, notably Cleopatra VII, who depicted herself as also youthful and idealized, but central in power. The women in Augustus’s family are connected to power, but by no means are they the sole practitioners of it, they support and nurture the powered body but do not possess it themselves. Augustus further represented himself by fusing traditional Roman portraiture that emphasized wisdom and virtue with the divinized visual elements of Hellenistic portraiture, specifically Alexander the Great’s youth, ideal, and slightly turned head to reflect power and divine status. Augustus carefully depicts himself as a youthful but attentive leader who is returning Rome to its traditions while ushering in a new era of unprecedented peace and prosperity across all of Rome’s vast territories, echoing the story and conquest of Alexander himself.

[[Return to Game|P2RomeD3IPBusts]]

–––––––––––––––––
^^226^^ Gabucci, //Ancient Rome//, 14.
^^227^^ Gabucci, 27.
^^228^^ Gabucci, 26–27.
^^229^^ Gabucci, 26–27; George Hanfmann, “Observations on Roman Portraiture,” in //The Garland Library of the History of Art: Ancient Art: Roman Art and Architectur//e, vol. 11 (La Societe d’Etudes Latines de Bruxelles, 1952), 345; Hanfmann, 459.
^^230^^ Gabucci, //Ancient Rome//, 16.</tw-passagedata><tw-passagedata pid="319" name="P2RomeD2BathhouseCP" tags="" position="1975,2925" size="100,100">The first major public bath in Rome was built by Agrippa in the Campus Martius before 19 BCE.^^201^^ This large complex required a water source, which caused Agrippa to build the 20 km long aqueduct, Aqua Virgo, that brought water from the north rather than the usual eastern source, Anio Valley.^^202^^ The public baths were vast structures that covered multiple city blocks, and depending on the size could contain gardens, meeting rooms, recital and lecture halls, shops for beauty treatments and massages, libraries, and exercise courts.^^203^^ The central halls in these facilities were covered by three soaring cross vaults.^^204^^ The bath was a social, educational, sexual, business, relaxing, and active environment due to the vastness of the facilities.^^205^^ The process of a Roman bath began with removing clothes in a dressing room as bathing usually occurred in the nude.^^206^^ There were three basic rooms which also show the proceeding: the //tepidarium// which had warm water, the //caldarium// which was a pool or tub of hot water, and the //frigidarium// which was a pool of cold water.^^207^^ It was possible for mixed gender bathing facilities.^^208^^ The cleaning occurred through rubbing olive oil over one’s body before scraping it off using a strigil which is a curved metal tool.^^209^^ Towels, oils, and strigils were either brought by people or could be rented.^^210^^

By the time MC overhears the two men, their presence in the bath as a perceived woman implies a mixed gendered facility. Further, enjoying the water implies being in the //caldarium// as they quickly leave after listening to the conversation, meaning they would plunge into the cold water and leave to return to the villa.

[[Return to Game|P2RomeD2Bathhouse]]

–––––––––––––––––
^^201^^ Aldrete, //Daily Life in the Roman City//, 28; Casson, //Everyday Life in Ancient Rome//, 42.
^^202^^ Aldrete, //Daily Life in the Roman City//, 28.
^^203^^ Casson, //Everyday Life in Ancient Rome//, 42.
^^204^^ Casson, 132.
^^205^^ Aldrete, //Daily Life in the Roman City//, 108.
^^206^^ Aldrete, 109; Aldrete, 111.
^^207^^ Aldrete, //Daily Life in the Roman City,// 109.
^^208^^ Aldrete, 111.
^^209^^ Aldrete, 111.
^^210^^ Aldrete, 111.</tw-passagedata><tw-passagedata pid="320" name="P2RomeD2RFAPCP" tags="" position="1750,2800" size="100,100">Augustus returned to Rome after a three year absence in Spain and Gaul in July of 13 BCE in which the Senate voted to authorize the Ara Pacis Augustae. In January of 12 BCE, Augustus succeeded as the Pontifex Maximus and represented himself in that capacity through the frieze depiction of the altar deduction on January 30 9 BCE.^^193^^

While the game takes place in 13 BCE and the Ara Pacis was not technically completed, for the sake of the story, the timeline for this has been accelerated, allowing MC to view the reliefs on the Ara Pacis.

The Ara Pacis, altar of peace, was made by Greek sculptors and is fundamental to understanding Augustan politics, ideologies, and art.^^194^^ The four panels retell Rome’s founding myth with Aeneas, Romulus, Remus, and the Julio family in allegorical scenes.^^195^^ Furthermore, the procession scene with the imperial family leading visually aligns them with filial piety and upholding Roman tradition through the Pontifex Maximus title, power, and ritual.^^196^^ Following Augustus’s assumption of the Pontifex Maximus role, succeeding emperors held this office until the fourth century.^^197^^ A notable detail with the imperial family leading the procession is the Ara Pacis friezes are the first to depict children outside funerary art, and their inclusion and centrality are political and intentional.^^198^^ Augustus enacted various family and child-centric laws offering more political and financial power to women and men who were married with multiple children.^^199^^ The children’s focus in the Ara Pacis friezes also portrays them with sympathy as they tug their clothes and accompanying nurses quietly hush them.^^200^^

&lt;center&gt; &lt;img src=&quot;https://ka-perseus-images.s3.amazonaws.com/5e89190a0946ee00bae5b7a20828d94cbd6b52f2.jpg&quot; width=&#39;500&#39;\&gt;
Unknown artist; //Ara Pacis Augustae, Altar of Augustan peace south relief frieze//; 13 BCE–9BCE; Campus Martius, Rome.
&lt;/center&gt;

These humanizing details coupled with the emphasis on Roman religious tradition and the theme of family through marriage and children aligns Augustus further with his propagandic imaginations as the First Citizen of Rome, a model for the people bearing the burden of leading the “Republic” and directly opposes Marc Antony’s vision of Rome’s future as a series of related dynastic kingdoms through the union of Egypt and Rome. This direct opposition also subtly indicates the positioning of Marc Antony and Cleopatra as antitheses to true and good Roman values, and by extension Egypt and Egyptian cultural, religious, and political practices, while placating Augustus in a virtuous and morally superior position with a Roman-centric and perfected cultural, religious, and political practices.

[[Return to Game|P2RomeD2RFAP]]

–––––––––––––––––
^^193^^ Gabucci, //Ancient Rome//, 18–19; Timothy Peter Wiseman, //Classics in Progress: Essays on Ancient Greece and Rome //(OUP/British Academy, 2006), 318.
^^194^^ Gabucci, //Ancient Rome//, 18–19.
^^195^^ Gabucci, 18–19.
^^196^^ J. A. North, //Roman Religion// (Cambridge University Press, 2000), 33–34; Coulston and Dodge, Ancient Rome, 69–70.
^^197^^ North, //Roman Religion,// 33–34.
^^198^^ Susan Walker, “The Moral Museum: Augustus and the City of Rome,” in //Ancient Rome: The Archaeology of the Eternal City,// ed. John Coulston and Hazel Dodge (Oxbow Books, 2000), 69–70.
^^199^^ Walker, 69–70.
^^200^^ Walker, 69–70.</tw-passagedata><tw-passagedata pid="321" name="P2RomeD2RFVGCP" tags="" position="1850,2900" size="100,100">A //templum// is a sacred site where augers look for divine signs through bird patterns.^^185^^ A building constructed within a templum was an aedes, which in contemporary times are called temples.^^186^^ //Aedes// included altars for sacrifice and had the cult statue or a collection of sacred objects.^^187^^ Altars, which were called //ara//, were located outside buildings usually on the front steps rather than inside the //aedes//.^^188^^ The public-facing nature of the ara spoke to the public nature of Roman religious practices.^^189^^

The Temple of Venus Genetrix contained a cult statue of either Venus modeled after Cleopatra VII, or a central statue of Venus accompanied by a golden Isis statue modeled after Cleopatra VII.^^190^^ In //Winds of Actium//, the Temple of Venus Genetrix contains one statue of Venus modeled after Cleopatra VII. Due to the close association of Cleopatra VII with Isis, MC views this statue as not just Cleopatra VII but Isis herself, the two figures are meshed into one. 

&lt;center&gt; &lt;img src=&quot;https://i.pinimg.com/736x/08/a5/23/08a523968b9908a9d7aead768e9b4193.jpg&quot; width=&#39;500&#39;\&gt;
Unknown artist; //Statue of Aphrodite (Venus Genetrix type)//; 2nd century A.D.; Roman Empire
&lt;/center&gt;

Isis had already been a synchronism goddess by the time Cleopatra VII died, she had been fused with Demeter, Aphrodite, Artemis, and various other goddesses in the Mediterranean. The easily transferable and fused nature of Isis in comparison with other Greco-Roman goddesses as well as her systemic worship banishment by Augustus and Agrippa in Rome () also adds a degree of ambiguity to the Venus statue at the Temple of Venus Genetrix: do other worshippers perceive the Roman Venus, the Greco-Egyptian-Roman infused Isis, or a third more obscure divine female goddess? Either way, the layers of obscurity allow for MC to interpret this statue as Isis and subsequently a cult image of Cleopatra-Isis while subtly circumventing the exile of Isis worship in Rome.

[[Return to Game|P2RomeD2RFVG]]

–––––––––––––––––
^^185^^ Aldrete,// Daily Life in the Roman City//, 150.
^^186^^ Aldrete, 150.
^^187^^ Aldrete, 150.
^^188^^ Aldrete, 150.
^^189^^ Aldrete, 150.
^^190^^ Joyce Tyldesley, //Cleopatra: Last Queen of Egypt// (Profile Books, 2011), 6; Tyldesley, 106.</tw-passagedata><tw-passagedata pid="322" name="P2RomeD1HGuestRoom2CP" tags="" position="2425,2300" size="100,100">For dinner, men replaced the toga with the //centatoria// (an outfit consisting of a tunic and a small wrap called a //pallium//), and women did a similar outfit replacement of the //stola//.^^163^^ Women wore a variety of colors on their clothes, notably sky or sea blue, marigold or a golden yellow, red-orange, dark-green, amethyst, or pale pink, sometimes clothes were multicolored.^^164^^ Yellow and purple were feminine and despite purple also containing a wealth connotation, men had to strategically use it or else be considered effeminate.^^165^^ Silk was a fabric associated with femininity and could be either wild or Coan silk or Chinese silk, however similar with men and purple, women had to be careful with wearing this fabric as it was associated with a doubtful reputation.^^166^^

I picture the MC wearing a more-feminizing dress due to the banquet’s nature and Maximinus providing their outfit. Due to the theme of the sea, MC’s hybrid Greek-Egyptian identity and upbringing, as well as their dubious status as a (perceived) working woman, MC is a more provocative individual. The outfit being made of silk speaks to their doubtful and questionable reputation as a woman who works within merchant trade, is unmarried, non-Roman, and highly educated. I also think that the outfit’s color being sea blue and dark green visually aligns MC with the sea and water, which are close aspects of their identity and upbringing. 

Banquets were not simply a dinner party, but were a six-hour minimum spectacle expected to be expensive, entertaining, luxurious, and provocative through food, modes of entertainment, and games.^^167^^ Differing from the courses offered in triclinium dining settings, banquets also included the following exotic and expensive courses: sliced egg, snails, sea urchins, oysters, pheasant, goose, peacock, goat kid meat, lobster, mullet, lamprey, or turbot.^^168^^ Wine was imported from Greece or sourced from Roman or Napoli vineyards.^^169^^ Similar to a guest hierarchy in the triclinium dinner, hosts could circumvent extraneous expenses through limiting more luxurious dishes and wines to certain guests.^^170^^ During the eating process, guests heard poetry recitals from the host’s slave, music with either singers accompanied by flute or lyre or just instruments, or even stories from professional storytellers.^^171^^ At more elaborate banquets, there could even be acrobats, dangers, and actors, which after a certain point would become more sexual through seductive dances by chorus men and women, vulgar comedy shows, and violent gladiatorial contests.^^172^^ A notable game was dice and knucklebones, which are comparable to playing cards.^^173^^ Augustus was apparently skilled in this game and as a dutiful host, would throw games to his guests.^^174^^ (Or perhaps he was quite bad and just played it off in a farce!) Some games used boards and aristocrats had tables fitted for the two most popular board games.^^175^^ While games were a mode of entertainment in daily life, they were quite serious and could condemn people to death.^^176^^

In the banquet scene, the MC can see people playing dice and knucklebones in a corner, there is music with a singer and accompanies by flute and lyre, as well as dancers in the center of the room. Due to MC entering the banquet shortly after full festivities have occurred, dances have not yet become sexual and guests are still eating and drinking.

[[Return to Game|P2RomeD1HGuestRoom2]]

–––––––––––––––––
^^163^^ Casson, //Everyday Life in Ancient Rome//, 33; Olson, “Status,” 113.
^^164^^ Olson, “Status,” 114.
^^165^^ Olson, 114.
^^166^^ Olson, 114.
^^167^^ Casson, //Everyday Life in Ancient Rome//, 19–20; Casson, 21; Casson, 98–99.
^^168^^ Casson, //Everyday Life in Ancient Rome//, 19–20
^^169^^ Casson, 19–20.
^^170^^ Casson, 19–20.
^^171^^ Casson, 21.
^^172^^ Casson, 21.
^^173^^ Casson, 98–99.
^^174^^ Casson, 98–99.
^^175^^ Casson, 98–99.
^^176^^ Casson, 98–99.</tw-passagedata><tw-passagedata pid="323" name="P2RomeD1HMosaic2CP" tags="" position="2375,2175" size="100,100">There are three proposed mosaic styles: standard geometric variations, repeated combination of geometric forms, and themes of iconography.^^151^^ Floor mosaics are compositions of small pieces of colored stones pressed into a wet mortar, creating an image and depending on the mosaic style, could be monochrome or colorful with depictions of historical, mythological, sea, or natural scenes.^^152^^ Similar to wall paintings, mosaics can be divided into first, second, or third styles. First-style mosaics were black and red geometric designs imitating carpets and centered in rooms or bordering the walls.^^153^^ Second-style mosaics were illusionary and colorful with three-dimensional decorative motifs.^^154^^ Third-style mosaics return to two-dimensional monochrome images.^^155^^

Atriums were decorated to indicate familial connections and histories through family trees, ancestral wax masks, portraits and archival records of achievements.^^156^^ Sometimes the atriums included battle spoils which could be an heirloom or testament to the house’s previous tenants.^^157^^ With this information in mind, I picture the mosaics in the atrium to contain information about Maximinus’ family history through more abstracted means. With second-style mosaics specifically in mind, specific historical scenes or mythological stories could reveal familial achievements in military and politics or indicate religious connections to specific cults or stories.

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/254535/1735201/main-image&quot; width=&#39;600&#39;\&gt; 
Unknown artist; //Mosaic floor with Egyptianizing scene//; ca. 130–150 CE; villa in Via Flaminia, near Prima Porta, not far from Rome
&lt;/center&gt;

While the mosaic was created in 130 to 150, its Egyptian element highlights the Roman interest and exoticism of Egypt as well as the fabricated air of mystery, fantasy, and mythology in depictions of Egypt under Roman frameworks. Within the context of Maximinus’ family history, it could depict a religious dedication as the scene in the mosaic is of a priest making an offering to Isis. Furthermore, the medium itself is Roman so the fusion of an Egyptian scene within a Roman artistic medium and expression speaks to the fusion and vast cultural connections within the Greco-Roman world. The religious element of this mosaic coupled with the in-game context, creates a history related to religious devotion while through the inclusion of Egyptian religious rituals, the mosaic hints at a relationship between Egypt and Maximinus&#39; family, as well as an implied devotion to the figure, Isis.

[[Return to Game|P2RomeD1HMosaic2]]

–––––––––––––––––
^^151^^ Birte Poulsen, “Identifying Mosaic Workships in Late Antiquity: Epigraphic Evidence and a Case Study,” in //Ateliers and Artisans in Roman Art and Archaeology// 129-142: Journal of Roman Archaeology, 2012, 135.
^^152^^ Aldrete, //Daily Life in the Roman City//, 77.
^^153^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 40.
^^154^^ Clarke, 61; Clarke, 126.
^^155^^ Clarke, 61; Clarke, 126.
^^156^^ John Patterson, “Living and Dying in the City of Rome: Houses and Tombs,” in //Ancient Rome: The Archaeology of the Eternal City//, ed. John Coulston and Hazel Dodge (Oxbow Books, 2000), 260–62.
^^157^^ Patterson, 260–62.</tw-passagedata><tw-passagedata pid="324" name="P2JRomeD1aCP" tags="" position="2400,225" size="100,100">Ostia, the port city for Rome, was rudimentary.^^122^^ Larger ships had to unload their cargo and then ride offshore.^^123^^ Part of the reason why ships could not remain docked in Ostia is because where Tiber flowed into the Mediterranean created an exposure to wind and poor weather and also made the area prone to silting.^^124^^ There was no natural protected inlet where ships could safely dock either.^^125^^

After //The Akhet// docks and unloads, Cheops and the crew will be required to ride offshore, but remain close to receive notice from Adamantios for returning.

[[Return to Game|P2JRomeD1a]]

–––––––––––––––––
^^122^^ Aldrete, //Daily Life in the Roman City//, 199.
^^123^^ Aldrete, 199.
^^124^^ Aldrete, 203; Casson, //Everyday Life in Ancient Rome//, 73.
^^125^^ Aldrete, //Daily Life in the Roman City//, 203.</tw-passagedata><tw-passagedata pid="325" name="P2JRomeD1eCP" tags="" position="2400,350" size="100,100">After defeating Carthage, Rome became the dominant naval power in the Mediterranean despite being largely uninterested and not raising a vessel to their name for a century.^^126^^ This piece of information stereotypes Romans as being anti-navy and maintaining a disinterested attitude in naval power. However, by the time Augustus came into power, he created both a standing army and navy.^^127^^

Sternposts were usually high and had a downward curve, sometimes bearing the vessel’s name.^^128^^ In this case, //The Akhet// bears its name on the sternpost. Further, ships had encaustic paint of either purple, blue, white, yellow, and green.^^129^^ The hull was usually done in red and dark blue bands while the stern gallery, trim, and steering doors were yellow.^^130^^ //The Akhet// has a blue paint for its main body while following the painting traditions for the other ship’s parts. 

[[Return to Game|P2JRomeD1e]]

–––––––––––––––––
^^126^^ Casson, //The Ancient Mariners//, 157.
^^127^^ Casson, //Everyday Life in Ancient Rome//, 5.
^^128^^ Casson, //The Ancient Mariners//, 216.
^^129^^ Casson, 218.
^^130^^ Casson, 218.</tw-passagedata><tw-passagedata pid="326" name="End" tags="" position="3750,3400" size="100,100">If you want more information on all of the cited passages, &lt;a href=&quot;https://docs.google.com/document/d/1yUr-twIimqnqRcam3YcookHkYmELiJFrZVICGpQlR8s/edit?usp=sharing&quot;&gt;click or right click here to open a new tab&lt;/a&gt;.

If you want to see the full bibliography,  &lt;a href=&quot;https://docs.google.com/document/d/1faiVBAFP7OgprQMgZ436J5Ou-_1drhlaBczoW3c6lIc/edit?usp=sharing&quot;&gt;click or right click here to open a new tab&lt;/a&gt;.

Thank you for playing //Winds of Actium//!</tw-passagedata><tw-passagedata pid="327" name="P2JiRomeD1HillCP" tags="" position="2325,1675" size="100,100">The most desired address was Palatine Hill as it houses aristocratic residences and was near to the center of political activity in the city.^^135^^ Through time, aristocrats eventually spread beyond Palatine Hill.^^136^^ However, the wealthy home remained a politically important space for the patronage system as the reception of clients was necessary for social relations. Spacious and impressive homes and atriums were required to impress visitors.^^137^^

[[Return to Game|P2JiRomeD1Hill]]

–––––––––––––––––
^^135^^ John Patterson, “Living and Dying in the City of Rome: Houses and Tombs,” in //Ancient Rome: The Archaeology of the Eternal City//, ed. John Coulston and Hazel Dodge (Oxbow Books, 2000), 260; Aldrete, //Daily Life in the Roman City//, 167.
^^136^^ Patterson, “Living and Dying in the City of Rome: Houses and Tombs,” 261.
^^137^^ Patterson, 262.</tw-passagedata><tw-passagedata pid="328" name="P2RomeD1MarFoodCP" tags="" position="1700,1950" size="100,100">//Macellum//, or a marketplace, was a space where goods and foodstuffs were bought and sold. Northeast to the forum was a grand //macellum//.^^138^^

Red meat was rare but pork, poultry, and fish were common and available food options that had garum within a barrel or pot where it fermented in the sun.^^139^^ These pots and barrels were fast food as people could purchase a bowl with bread.^^140^^

[[Return to Game|P2RomeD1MarFood]]

–––––––––––––––––
^^138^^ Aldrete, //Daily Life in the Roman City//, 192.
^^139^^ Aldrete, 112.
^^140^^ Aldrete, 112.</tw-passagedata><tw-passagedata pid="329" name="P2RomeD1MarClothCP" tags="" position="1800,2075" size="100,100">Men wore thick wool and linen whereas women wore fine linen and silk.^^141^^ Silk was closely associated with women and was either wild, or Coan silk, or Chinese.^^142^^ Within wool, some types were luxury, finer, softer, and whiter than others.^^143^^ Women’s clothing had a lot of color and hues compared to men’s monochrome coloring.^^144^^

MC&#39;s ambiguous gender identity as expressing both male and female traits caused the vendor to mistake them as a woman, then a man, before resigning themselves. MC finds interest in the cloths associated with women, as well as the dyed nature. This detail relates more to MC&#39;s visual interest rather than an explicit gender expression. However, they are also aware of the rigid and strict gender binary in Rome and could look at more female-presenting pieces in an attempt to blend in more.

[[Return to Game|P2RomeD1MarCloth]]

–––––––––––––––––
^^141^^ Davies and Llewellyn-Hones, “Gender and Sexuality,” 88.
^^142^^ Olson, “Status,” 114.
^^143^^ Olson, 112.
^^144^^ Davies and Llewellyn-Hones, “Gender and Sexuality,” 88.</tw-passagedata><tw-passagedata pid="330" name="P2RomeD1HCourtCACP" tags="" position="1875,2200" size="100,100">Girls were ready for marriage at age 12 and those not married by 20 were considered deviants.^^148^^ Augustus in his social reform heavily penalized unmarried women over 20 and men over 25.^^149^^

In this case, Daria is close in age to the MC, between 20 and 21, meaning she is unnecessarily old for a first-time marriage. However, in this game, by relying on the fictitious aspect, Daria is still prime marriage material as Augustus is heavily involved in her marriage prospects. However, the penalty remains a threat over her and Maximinus.

[[Return to Game|P2RomeD1HCourtCA]]

–––––––––––––––––
^^148^^ Aldrete, //Daily Life in the Roman City//, 59.
^^149^^ Aldrete, 59.</tw-passagedata><tw-passagedata pid="331" name="P2RomeD1HCourtCP" tags="" position="1925,2075" size="100,100">The //paterfamilias// had //pater potestas//, or paternal power, over his family and he arranged marriages for his of-age children.^^145^^ Roman wives were expected to provide strong support for their //paterfamilias// and remain humble and modest.^^146^^ In the case of Daria functioning in proxy to a Roman matron, she would have been expected to support her father’s decisions while maintaining humility and modesty.^^147^^

[[Return to Game|P2RomeD1HCourt]]

–––––––––––––––––
^^145^^ Casson, //Everyday Life in Ancient Rome//, 11; Aldrete, //Daily Life in the Roman City//, 55.
^^146^^ Aldrete, //Daily Life in the Roman City//, 55.
^^147^^ Aldrete, 55.</tw-passagedata><tw-passagedata pid="332" name="P2RomeD1HGuestRoomCP" tags="" position="2000,2300" size="100,100">Unlike the yellow, red, and sometimes black painted walls in second-style rooms that were entirely painted black, this shift marks the third-style paintings that emerged around 20 BCE and continued in popularity until 20 AD.^^157^^ These walls either had rectangular frames which contained mythological scenes and human figures, mimicking a framed decoration.^^158^^ Further, these all black-rooms had a central aedicule, or a specific focal point, miniaturist details, Egyptian motifs, painted architectural forms like columns which were closely detailed, and painted imitations of art pieces.^^159^^ Due to the sharp black wall, details with delicate blues, pinks, purples, and greens were added after a partial drying of the plaster.^^160^^ With this specific process of detailing, vertical and horizontal palmettes, gems framed by heart-shaped volutes (curved spiral ornamentation), lotuses, and rosettes have been lost to time.^^161^^

&lt;center&gt; &lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/250940/536570/main-image&quot; width=&#39;300&#39;\&gt;
Unknown artist; //Wall painting on black ground: cornice fragment, from the imperial villa at Boscotrecase//; last decade of the 1st century BCE; Pompeii
&lt;img src=&quot;https://collectionapi.metmuseum.org/api/collection/v1/iiif/250931/536566/main-image&quot; width=&#39;300&#39;\&gt;
Unknown artist; //Wall painting on black ground: Egyptianizing scene and pair of swans, from the imperial villa at Boscotrecase//; last decade of the 1st century BCE; Pompeii
&lt;/center&gt;

In this guest room, due to the popular nature of these wall paintings and the location in Rome, Daria as the de facto matron of the household redecorated to accommodate the trends. The MC notices the differences between the Panormus Villa walls and the Roman walls, and finds that the subtlety of the wall’s detailings are fascinating, along with recognizing Egyptian motifs in specific plants like palmettes and lotuses and Egyptianizing scenes. In a sense, third-style wall decorations reflect Augustan political values, a return to a more traditional and simplistic method, which outwardly opposes the vast luxurious and excessive decorations prior to his ascension as first citizen, and by extension, the //tryphe// of the East. He orients a Roman-dominant visual but maintains elegance through subtle and miniscule ornaments along with motifs of empire and conquest through the appropriation and exaggerated Egyptian motifs through plants and cult symbols. 

[[Return to Game|P2RomeD1HGuestRoom]]

–––––––––––––––––
^^157^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 52.
^^158^^ Aldrete, //Daily Life in the Roman City//, 77.
^^159^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 52.
^^160^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 134.
^^161^^ Clarke, //The Houses of Roman Italy, 100 B.C.- A.D. 250//, 134.</tw-passagedata><tw-passagedata pid="333" name="P2RomeD1HBanquetDariaCP" tags="" position="1850,2400" size="100,100">Wealthy Roman women had specific hair and makeup routines.^^176^^ Their makeup, a combination of a white foundation finished with either chalk or lead-based powder, created a white face.^^177^^ The foundation was a secret recipe that could contain egg, barley, antler, honey, flowers, lead, wheat, or crushed beans.^^178^^ Eyes were decorated with black pigments made by ashes or a powdered antimony, while a red lead or plant-based dye was used as blush and lipstick.^^179^^

Daria follows these Roman beauty standards, wearing a white face with blackened eyeshadow, and red lips and blush. The MC, as a non-Roman does not follow these standards and appears bare-faced, further visually aligning themselves outside of Roman expected behavior and standards and not following specific gender behaviors and appearances expected of Roman women.

[[Return to Game|P2RomeD1HBanquetDaria]]

–––––––––––––––––
^^176^^ Aldrete, //Daily Life in the Roman City//, 247.
^^177^^ Aldrete, 247.
^^178^^ Aldrete, 247.
^^179^^ Aldrete, 247; Casson, //Everyday Life in Ancient Rome//, 32.</tw-passagedata><tw-passagedata pid="334" name="P2RomeD1HBanquetMarcusesCP" tags="" position="2450,2425" size="100,100">Augustus replaced the Republican //toga exigua// (short toga) with a refined, Imperial toga that draped over the left shoulder, leaving a cloth train called a //sinus// that was tucked at the waist, called an //umbo//.^^180^^ The //sinus// bore a stripe that indicated wealth and status, senators had a noticeable wide purple stripe called a //latus clavus// (broad stripe).^^181^^

MC recognizes Marcus I and II as senators due to their wide purple stripe as well as time-appropriate fashion trends and changes to dress.

Furthermore, the draping of a toga prevented specific movements, with reduced mobility due to the length of the garment, and controlled gesturing as the sinus limited the left arm’s movement, allowing the right arm to gesture.^^182^^ The imperial toga was larger, thicker, and had no fastening due to the draping, the complicated nature of the toga required assistance from slaves and practice with maintaining drapery.^^183^^

MC notes two people hovering near these men that continually approach and fix Marcus I and II’s toga drapings, this is intentional due to the nature of the toga’s specific complexities and as Marcus I and II become more inhibited by the wine and more dramatic with their gesturing despite their thick and restraining togas.

[[Return to Game|P2RomeD1HBanquetMarcuses]]

–––––––––––––––––
^^180^^ Susan Walker, “The Moral Museum: Augustus and the City of Rome,” in //Ancient Rome: The Archaeology of the Eternal City//, ed. John Coulston and Hazel Dodge (Oxbow Books, 2000), 69–70.
^^181^^ Aldrete, //Daily Life in the Roman City//, 245.
^^182^^ Davies and Llewellyn-Hones, “The Body,” 57–58.
^^183^^ Davies and Llewellyn-Hones, 54.</tw-passagedata><tw-passagedata pid="335" name="P2RomeN2CP" tags="" position="2450,2700" size="100,100">The dining room was called a //triclinium// where guests laid down on couches as they ate, leaning on their left elbows.^^210^^ As mentioned earlier, dinner was divided into three courses and included a variety of foods like olives, snails, eggs, lettuce, leeks, mint, other vegetables and herbs, meats, fowls, and fish, nuts and fruits.^^211^^ Due to the nature of lounging on the couches and eating at one’s ease, the dinner in this scene is a relatively casual affair and follows the typical procession.^^212^^

[[Return to Game|P2RomeN2]]

–––––––––––––––––
^^210^^ Casson, //Everyday Life in Ancient Rome//, 19; Aldrete, //Daily Life in the Roman City//, 112.
^^211^^Casson, 19; Aldrete, 112.
^^212^^ Casson, 19.</tw-passagedata><tw-passagedata pid="336" name="P2RomeN2Talk2CP" tags="" position="2250,2925" size="100,100">In the Republic, wealthy young men were recruited as equipment needed to be purchased by the individual themselves.^^214^^ They were usually in their 20s when they joined and needed to provide documentation proving their citizenship, eligibility for regions or provincial and eligibility for auxiliaries of the navy.^^215^^ Men needed to be at least 5’8 and pass a physical examination.^^216^^ The most wealthy were eligible for being part of the cavalry as they could afford horses.^^217^^ The motivation for service was the Republic itself and people were willing to serve through the military and endure brutal, harsh discipline and training.^^218^^ Their training included learning to swim, marching, necessary battle movements, pitching camps including digging trenches, mastering the short sword, and being able to carry their full 60 pound equipment pack that contained weapons, tools, and rations.^^219^^

Maximinus as a young patrician-class man during the Republic would have been motivated to serve the military aspirations of Rome and with his wealth, been able to fund the necessary and required equipment. His experience in the Roman Army coincided with Julius Caesar’s campaign in Gaul and the civil war between Pompey, which granted him the opportunity to be in Alexandria. Furthermore, his military service also would have granted him political connections through commanders and other high-ranking military officials, and gave him a positive reputation amongst Romans.

[[Return to Game|P2RomeN2Talk2]]

–––––––––––––––––
^^214^^ Adrian Goldsworthy, //Antony and Cleopatra// (Yale University Press, 2010), 30.
^^215^^ Casson, //Everyday Life in Ancient Rome//, 79–80.
^^216^^ Casson, 79–80.
^^217^^ Goldsworthy, //Antony and Cleopatra//, 30.
^^218^^ Goldsworthy, 30.
^^219^^ Casson, //Everyday Life in Ancient Rome//, 79–80.</tw-passagedata><tw-passagedata pid="337" name="P2RomeN2SneakOfficeDCP" tags="" position="2600,3125" size="100,100">Marriage eligibility for girls began at twelve and they usually married sometime between then and fifteen.^^220^^ Unmarried women by twenty were considered deviant and heavily penalized under Augustan social reforms.^^221^^ Despite one of the duties of the //paterfamilias// being the power to arrange marriages for his of-age children, couples could marry if a father was judged to be insane.^^222^^ Arranged marriages were powerful because they offered political and financial advantages through legacy and property preservation.^^223^^

The letter that pushes Daria to marry another elite is political. Augustus wants to maintain the elite circles of Rome and grant favor to the groom’s family by offering a conduit of legacy continuation and familial inherited property through Daria as women could inherit and bequeath property. In addition, the letter subtly hints that if Maximinus does not “arrange” this marriage and partake in his duty as the father of the household, Augustus will move to have him socially ostracized and labeled insane, granting Augustus leave to marry Daria off to whomever he pleases. The usage of social rules against his adversaries also engages with the continual political nature of Augustus regarding his image cultivation as maintaining Roman tradition and appearing not as a tyrant, but as a model First Citizen, despite moving Rome from a Republic to a dynastic monarchy.

[[Return to Game|P2RomeN2SneakOfficeD]]

–––––––––––––––––
^^220^^ Aldrete, //Daily Life in the Roman City//, 59; Casson, //Everyday Life in Ancient Rome//, 11.
^^221^^ Aldrete, 59.
^^222^^ Aldrete, 59; Casson, //Everyday Life in Ancient Rome//, 11.
^^223^^ Casson, 11.</tw-passagedata><tw-passagedata pid="338" name="P2RomeD3PH2CP" tags="" position="2275,3875" size="100,100">This anecdote comes directly from Plutarch’s Life of Antony, verse 29 lines 1-2 where he discusses the playful nature of Cleopatra and Antony’s relationship.^^246^^ He also notes that Antony would dress as a servant and go into the city by night where he would, essentially, argue and fight with Alexandrians, who seemed to enjoy the abuse as he appeared relatable, humorous, and lighthearted.^^247^^
(align:&quot;&lt;==&quot;)+(box:&quot;===XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=======&quot;)[//(Cleopatra) played at dice with him, drank with him, hunted with him, and watched him as he exercised himself in arms; and when by night he would station himself at the doors or windows of the common folk and scoff at those within, she would go with him on his round of mad follies, wearing the garb of a serving maiden. For Antony also would try to array himself like a servant. Therefore he always reaped a harvest of abuse, and often of blows, before coming back home; though most people suspected who he was. However, the Alexandrians took delight in their graceful and cultivated way; they liked him, and said that he used the tragic mask with the Romans, but the comic mask with them.^^248^^//]
[[Return to Game|P2RomeD3PH2]]

–––––––––––––––––
^^246^^ Plutarch, //Life of Mark Antony// 29.1-2.
^^247^^ Plutarch, //Life of Mark Antony// 29.1-2.
^^248^^ Plutarch, //Life of Mark Antony// 29.1-2.</tw-passagedata><tw-passagedata pid="339" name="P3RomeDisLieCP" tags="" position="4375,675" size="100,100">In populated Rome, fire was a constant threat and concern due to the hazardous charcoal braziers and oil lamps.^^257^^ It was easy for fire to spread due to the flammable elements of buildings with the wooden support beams, rafters, balconies, wooden furniture, bed and couch spreads.^^258^^ Furthermore, buildings were very close to one another, creating concern with the fire spreading rapidly across the city.^^259^^ Addressing this concern, Augustus created police and firefighter departments.^^260^^ During the day, police patrolled the city and were three thousand men strong.^^261^^ At night, seven thousand volunteer freed men called //vigiles// patrolled the city to specifically address the fire concern.^^262^^ Their presence did also function to deter crime, but ultimately, they were concerned with preventing fire spread.^^263^^ There were seven firefighting stations which were responsible for maintaining two city regions, totaling up to the fourteen Augustan regions of Rome.^^264^^ Their equipment included buckets, vinegar-soaked blankets, mattresses to catch falling people, ladders, axes, and a siphon device to spray water, as well as artillery pieces to destroy buildings in an attempt to create firebreaks.^^265^^

[[Return to Game|P3RomeDisLie]]

–––––––––––––––––
^^257^^ Aldrete, //Daily Life in the Roman City//, 93; Casson, //Everyday Life in Ancient Rome//, 38.
^^258^^ Aldrete, 93; Casson, 38.
^^259^^ Aldrete, 93.
^^260^^ Aldrete, 93; Casson, //Everyday Life in Ancient Rome//, 40.
^^261^^ Casson, 40.
^^262^^ Casson, 40; Aldrete, //Daily Life in the Roman City//, 93.
^^263^^ Aldrete, 94.
^^264^^ Aldrete, 19; Aldrete, 94; Casson, //Everyday Life in Ancient Rome//, 40.
^^265^^ Casson, 40; Aldrete, 94.</tw-passagedata><tw-passagedata pid="340" name="P3RomeDisTruthCP" tags="" position="4225,675" size="100,100">In populated Rome, fire was a constant threat and concern due to the hazardous charcoal braziers and oil lamps.^^257^^ It was easy for fire to spread due to the flammable elements of buildings with the wooden support beams, rafters, balconies, wooden furniture, bed and couch spreads.^^258^^ Furthermore, buildings were very close to one another, creating concern with the fire spreading rapidly across the city.^^259^^ Addressing this concern, Augustus created police and firefighter departments.^^260^^ During the day, police patrolled the city and were three thousand men strong.^^261^^ At night, seven thousand volunteer freed men called //vigiles// patrolled the city to specifically address the fire concern.^^262^^ Their presence did also function to deter crime, but ultimately, they were concerned with preventing fire spread.^^263^^ There were seven firefighting stations which were responsible for maintaining two city regions, totaling up to the fourteen Augustan regions of Rome.^^264^^ Their equipment included buckets, vinegar-soaked blankets, mattresses to catch falling people, ladders, axes, and a siphon device to spray water, as well as artillery pieces to destroy buildings in an attempt to create firebreaks.^^265^^

[[Return to Game|P3RomeDisTruth]]

–––––––––––––––––
^^257^^ Aldrete, //Daily Life in the Roman City//, 93; Casson, //Everyday Life in Ancient Rome//, 38.
^^258^^ Aldrete, 93; Casson, 38.
^^259^^ Aldrete, 93.
^^260^^ Aldrete, 93; Casson, //Everyday Life in Ancient Rome//, 40.
^^261^^ Casson, 40.
^^262^^ Casson, 40; Aldrete, //Daily Life in the Roman City//, 93.
^^263^^ Aldrete, 94.
^^264^^ Aldrete, 19; Aldrete, 94; Casson, //Everyday Life in Ancient Rome//, 40.
^^265^^ Casson, 40; Aldrete, 94.</tw-passagedata><tw-passagedata pid="341" name="P3RomeAgreeNo5CP" tags="" position="3750,1025" size="100,100">In populated Rome, fire was a constant threat and concern due to the hazardous charcoal braziers and oil lamps.^^257^^ It was easy for fire to spread due to the flammable elements of buildings with the wooden support beams, rafters, balconies, wooden furniture, bed and couch spreads.^^258^^ Furthermore, buildings were very close to one another, creating concern with the fire spreading rapidly across the city.^^259^^ Addressing this concern, Augustus created police and firefighter departments.^^260^^ During the day, police patrolled the city and were three thousand men strong.^^261^^ At night, seven thousand volunteer freed men called //vigiles// patrolled the city to specifically address the fire concern.^^262^^ Their presence did also function to deter crime, but ultimately, they were concerned with preventing fire spread.^^263^^ There were seven firefighting stations which were responsible for maintaining two city regions, totaling up to the fourteen Augustan regions of Rome.^^264^^ Their equipment included buckets, vinegar-soaked blankets, mattresses to catch falling people, ladders, axes, and a siphon device to spray water, as well as artillery pieces to destroy buildings in an attempt to create firebreaks.^^265^^

[[Return to Game|P3RomeAgreeNo5]]

–––––––––––––––––
^^257^^ Aldrete, //Daily Life in the Roman City//, 93; Casson, //Everyday Life in Ancient Rome//, 38.
^^258^^ Aldrete, 93; Casson, 38.
^^259^^ Aldrete, 93.
^^260^^ Aldrete, 93; Casson, //Everyday Life in Ancient Rome//, 40.
^^261^^ Casson, 40.
^^262^^ Casson, 40; Aldrete, //Daily Life in the Roman City//, 93.
^^263^^ Aldrete, 94.
^^264^^ Aldrete, 19; Aldrete, 94; Casson, //Everyday Life in Ancient Rome//, 40.
^^265^^ Casson, 40; Aldrete, 94.</tw-passagedata><tw-passagedata pid="342" name="P3RomeAgreeYes4CP" tags="" position="3350,925" size="100,100">In populated Rome, fire was a constant threat and concern due to the hazardous charcoal braziers and oil lamps.^^257^^ It was easy for fire to spread due to the flammable elements of buildings with the wooden support beams, rafters, balconies, wooden furniture, bed and couch spreads.^^258^^ Furthermore, buildings were very close to one another, creating concern with the fire spreading rapidly across the city.^^259^^ Addressing this concern, Augustus created police and firefighter departments.^^260^^ During the day, police patrolled the city and were three thousand men strong.^^261^^ At night, seven thousand volunteer freed men called //vigiles// patrolled the city to specifically address the fire concern.^^262^^ Their presence did also function to deter crime, but ultimately, they were concerned with preventing fire spread.^^263^^ There were seven firefighting stations which were responsible for maintaining two city regions, totaling up to the fourteen Augustan regions of Rome.^^264^^ Their equipment included buckets, vinegar-soaked blankets, mattresses to catch falling people, ladders, axes, and a siphon device to spray water, as well as artillery pieces to destroy buildings in an attempt to create firebreaks.^^265^^

[[Return to Game|P3RomeAgreeYes4]]

–––––––––––––––––
^^257^^ Aldrete, //Daily Life in the Roman City//, 93; Casson, //Everyday Life in Ancient Rome//, 38.
^^258^^ Aldrete, 93; Casson, 38.
^^259^^ Aldrete, 93.
^^260^^ Aldrete, 93; Casson, //Everyday Life in Ancient Rome//, 40.
^^261^^ Casson, 40.
^^262^^ Casson, 40; Aldrete, //Daily Life in the Roman City//, 93.
^^263^^ Aldrete, 94.
^^264^^ Aldrete, 19; Aldrete, 94; Casson, //Everyday Life in Ancient Rome//, 40.
^^265^^ Casson, 40; Aldrete, 94.</tw-passagedata><tw-passagedata pid="343" name="itemjewelryCP" tags="" position="425,1325" size="100,100">Ancient jewelry was both decorative and meaningful (Moroney, n.d.). Color and material of jewelry could protect the wearer due to their symbolic qualities (Moroney, n.d.; Brooklyn Museum ca. 3300–3100 B.C.E.). The Book of the Dead delineated different colored materials to different gods and goddesses when placing them on the deceased body (Moroney, n.d.). Red jasper on the throat appeased Isis while a heart scarab amulet could aid in the weighing of the heart with Maat (Moroney, n.d.). While this is dated to the New Kingdom through the Book of the Dead, jewelry was an essential aspect of religious expression (Moroney, n.d.). It was used for offerings, buried with the deceased, gifted, and worn to specific places (Moroney, n.d.).

&lt;center&gt; &lt;img src=&quot;https://arce.org/wp-content/uploads/files-imported/2019-02/DP348622.jpg&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Cowrie Shell Girdle of Sithathoryunet//; ca. 1887–1813 B.C.; Egypt, Fayum Entrance Area, Lahun, Tomb of Sithathoryunet 
&lt;img src=&quot;https://d1lfxha3ugu3d4.cloudfront.net/images/opencollection/objects/size2/CUR.09.889.302_erg3.jpg&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Beaded Necklace//;  ca. 3300–3100 B.C.E.; Abu Zaidan, Egypt &lt;/center&gt;

With this framework in mind, the beaded necklace bears specific color and material associations with certain deities to provide protection in varying aspects. MC’s mother knew that her husband, Adamantios, was a merchant on the seas, so by offering this protective necklace to her child, she could feel a peace of mind knowing that the gods, especially ones related to the sea, travel, and warding off danger could keep them safe.

The beaded necklace functions as a site of religious expression and belief in higher powers. It also speaks to the power of religion in emotional reckoning in the face of the unknown. The act of giving the necklace with its powerful, protective, and divine elements also speaks to the maternal care and concern of MC’s mother. This itself aligns with her Isis worship as well as the appealing nature of Isis herself. As a mortal mother, MC’s mother cannot affect the uncontrollable parts of life, but a divine and all-powerful immortal mother, who relates to concerns of child-safety through the protection and hiding of Horus from Seth, could influence the uncontrollable.

[[Return to Game|itemjewelry]]

–––––––––––––––––
Brooklyn Museum. ca. 3300–3100 B.C.E. //Beaded Necklace//. Shell, faience, clay. ](align:&quot;&lt;==&quot;)+(box:&quot;===XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=======&quot;)[https://www.brooklynmuseum.org/opencollection/objects/32
73.]
Moroney, Morgan. n.d. “Egyptian Jewelry: A Window into Ancient Culture.” 
(align:&quot;&lt;==&quot;)+(box:&quot;===XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=======&quot;)[//ARCE// (blog). https://arce.org/resource/egyptian-jewelry-window-ancient-culture/.]</tw-passagedata><tw-passagedata pid="344" name="P1PanD2Tav5aCP" tags="" position="600,3000" size="100,100">&lt;center&gt; &lt;img src=&quot;https://studylib.net/flashcards/cardimage2/add6cafc/568/8568031_face.png&quot; width=&#39;300&#39;\&gt; 
Unknown artist; //Silver tetradrachm of Marc Antony and Cleopatra as joint sovereigns//; Eastern mint, possibly Antioch; c. 36–33 BCE.
&lt;/center&gt;

In this coin, Antony articulates his political vision of Rome’s future. The Roman Republic was anti-monarchical and viewed kings and queens as tyrannical. Despite this political attitude, by including Cleopatra on the reverse with his image, Antony communicates a pro-monarchical view. While his monarchical vision was more explicit that Augustus’, this coin along with the Donations of Alexandria informs Roman subjects of his intentions to establish various dynastic kingdoms through his children with Cleopatra. These territorial divisions amongst their three children, Caesarion and Cleopatra, and Antony establishes a strong connection between these kingdoms as they are related to one another but each have their own source of power, reducing familial murder which was common with Ptolemaic family members. The separated territories under Roman acquisition and control alienated Antony further from the Roman people, granting Augustus evidence and proof of Antony as a Roman who has lost his way and become fallible to the influence of a non-Roman woman. This in-group and out-group binary further positioned Augustus as a true Roman who held the rightful and just intentions for the Republic, granting him further influence and power to strengthen his claim as the singular remaining triumvir and subsequent title, Augustus.

[[Return to Game|P1PanD2Tav5a]]</tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">(function(){"use strict";
var require,define;!function(){var e={},r={};require=function(i){var n=e[i];return n&&(r[i]=n[1].apply(void 0,n[0].map(require)),e[i]=void 0),r[i]},(define=function(r,i,n){if("function"==typeof r)return r();e[r]=[i,n]}).amd=!0}();/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.join);var A=Function.call.bind(Array.prototype.shift);var _=Math.max;var R=Math.min;var k=Math.floor;var L=Math.abs;var F=Math.exp;var D=Math.log;var z=Math.sqrt;var q=Function.call.bind(Object.prototype.hasOwnProperty);var W;var G=function(){};var H=S.Map;var V=H&&H.prototype["delete"];var B=H&&H.prototype.get;var U=H&&H.prototype.has;var $=H&&H.prototype.set;var J=S.Symbol||{};var X=J.species||"@@species";var K=Number.isNaN||function isNaN(e){return e!==e};var Z=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Y=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(K(t)){return t}return t<0?-1:1};var Q=function log1p(e){var t=Number(e);if(t<-1||K(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(D(1+t)/(1+t-1))};var ee=function isArguments(e){return g(e)==="[object Arguments]"};var te=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var re=ee(arguments)?ee:te;var ne={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var oe=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var ie=typeof J==="function"&&typeof J["for"]==="function"&&ne.symbol(J());var ae=ne.symbol(J.iterator)?J.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ae="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ue=S.Reflect;var fe=String;var se=typeof document==="undefined"||!document?null:document.all;var ce=se==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==se};var le={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!le.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(ce(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===se},ToObject:function(e,t){return Object(le.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return le.IsCallable(e)},ToInt32:function(e){return le.ToNumber(e)>>0},ToUint32:function(e){return le.ToNumber(e)>>>0},ToNumber:function(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=le.ToNumber(e);if(K(t)){return 0}if(t===0||!Z(t)){return t}return(t>0?1:-1)*k(L(t))},ToLength:function(e){var t=le.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},GetIterator:function(e){if(re(e)){return new W(e,"value")}var t=le.GetMethod(e,ae);if(!le.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=le.Call(t,e);if(!le.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=le.ToObject(e)[t];if(ce(r)){return void 0}if(!le.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=le.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=le.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!le.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!le.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=le.IteratorNext(e);var r=le.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ue.construct){return ue.construct(e,t,o)}var i=o.prototype;if(!le.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=le.Call(e,a,t);return le.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!le.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[X];if(ce(n)){return t}if(!le.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=le.ToString(e);var i="<"+t;if(r!==""){var a=le.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!le.TypeIsObject(e)){return false}var t=e[J.match];if(typeof t!=="undefined"){return!!t}return ne.regex(e)},ToString:function ToString(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return fe(e)}};if(s&&ie){var pe=function defineWellKnownSymbol(e){if(ne.symbol(J[e])){return J[e]}var t=J["for"]("Symbol."+e);Object.defineProperty(J,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!ne.symbol(J.search)){var ve=pe("search");var ye=String.prototype.search;h(RegExp.prototype,ve,function search(e){return le.Call(ye,e,[this])});var he=function search(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,ve);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(ye,t,[le.ToString(e)])};oe(String.prototype,"search",he)}if(!ne.symbol(J.replace)){var be=pe("replace");var ge=String.prototype.replace;h(RegExp.prototype,be,function replace(e,t){return le.Call(ge,e,[this,t])});var de=function replace(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,be);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(ge,r,[le.ToString(e),t])};oe(String.prototype,"replace",de)}if(!ne.symbol(J.split)){var me=pe("split");var Oe=String.prototype.split;h(RegExp.prototype,me,function split(e,t){return le.Call(Oe,e,[this,t])});var we=function split(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,me);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(Oe,r,[le.ToString(e),t])};oe(String.prototype,"split",we)}var je=ne.symbol(J.match);var Se=je&&function(){var e={};e[J.match]=function(){return 42};return"a".match(e)!==42}();if(!je||Se){var Te=pe("match");var Ie=String.prototype.match;h(RegExp.prototype,Te,function match(e){return le.Call(Ie,e,[this])});var Ee=function match(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,Te);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(Ie,t,[le.ToString(e)])};oe(String.prototype,"match",Ee)}}var Pe=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in G||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in G||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Ce=function(){return this};var Me=function(e){if(s&&!q(e,X)){m.getter(e,X,Ce)}};var xe=function(e,t){var r=t||function iterator(){return this};h(e,ae,r);if(!e[ae]&&ne.symbol(ae)){e[ae]=r}};var Ne=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ae=function createDataPropertyOrThrow(e,t,r){Ne(e,t,r);if(!le.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var _e=function(e,t,r,n){if(!le.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!le.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(q(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;oe(String,"fromCodePoint",function fromCodePoint(e){return le.Call(Re,this,arguments)})}var ke={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!le.SameValue(r,le.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return N(t,"")},raw:function raw(e){var t=arguments.length-1;var r=le.ToObject(e,"bad template");var raw=le.ToObject(r.raw,"bad raw value");var n=raw.length;var o=le.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=le.ToString(a);s=le.ToString(raw[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=le.ToString(f);M(i,c);a+=1}return N(i,"")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){oe(String,"raw",ke.raw)}b(String,ke);var Le=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Fe=Infinity;var De={repeat:function repeat(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);if(r<0||r>=Fe){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return Le(t,r)},startsWith:function startsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=le.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=_(le.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=le.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:le.ToInteger(o);var a=R(_(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(le.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=le.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){oe(String.prototype,"includes",De.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var ze=i(function(){return"/a/".startsWith(/a/)});var qe=a(function(){return"abc".startsWith("a",Infinity)===false});if(!ze||!qe){oe(String.prototype,"startsWith",De.startsWith);oe(String.prototype,"endsWith",De.endsWith)}}if(ie){var We=a(function(){var e=/a/;e[J.match]=false;return"/a/".startsWith(e)});if(!We){oe(String.prototype,"startsWith",De.startsWith)}var Ge=a(function(){var e=/a/;e[J.match]=false;return"/a/".endsWith(e)});if(!Ge){oe(String.prototype,"endsWith",De.endsWith)}var He=a(function(){var e=/a/;e[J.match]=false;return"/a/".includes(e)});if(!He){oe(String.prototype,"includes",De.includes)}}b(String.prototype,De);var Ve=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Be=new RegExp("(^["+Ve+"]+)|(["+Ve+"]+$)","g");var Ue=function trim(){return le.ToString(le.RequireObjectCoercible(this)).replace(Be,"")};var $e=["\x85","\u200b","\ufffe"].join("");var Je=new RegExp("["+$e+"]","g");var Xe=/^[-+]0x[0-9a-f]+$/i;var Ke=$e.trim().length!==$e.length;h(String.prototype,"trim",Ue,Ke);var Ze=function(e){return{value:e,done:arguments.length===0}};var Ye=function(e){le.RequireObjectCoercible(e);h(this,"_s",le.ToString(e));h(this,"_i",0)};Ye.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ze()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ze(e.substr(t,o))};xe(Ye.prototype);xe(String.prototype,function(){return new Ye(this)});var Qe={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!le.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(re(e)||le.GetMethod(e,ae))!=="undefined";var u,f,s;if(a){f=le.IsConstructor(r)?Object(new r):[];var c=le.GetIterator(e);var l,p;s=0;while(true){l=le.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){le.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=le.ToObject(e);u=le.ToLength(y.length);f=le.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ae(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!le.IsCallable(t)?new Array(e):le.Construct(t,[e]);for(var o=0;o<e;++o){Ae(n,o,arguments[o])}n.length=e;return n}};b(Array,Qe);Me(Array);W=function(e,t){h(this,"i",0);h(this,"array",e);h(this,"kind",t)};b(W.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof W)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=le.ToLength(t.length);if(e<r){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ze(o)}}this.array=void 0;return Ze()}});xe(W.prototype);var et=Array.of===Qe.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!et){oe(Array,"of",Qe.of)}var tt={copyWithin:function copyWithin(e,t){var r=le.ToObject(this);var n=le.ToLength(r.length);var o=le.ToInteger(e);var i=le.ToInteger(t);var a=o<0?_(n+o,0):R(o,n);var u=i<0?_(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:le.ToInteger(f);var c=s<0?_(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=le.ToObject(this);var o=le.ToLength(n.length);t=le.ToInteger(typeof t==="undefined"?0:t);r=le.ToInteger(typeof r==="undefined"?o:r);var i=t<0?_(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new W(this,"key")},values:function values(){return new W(this,"value")},entries:function entries(){return new W(this,"entry")}};if(Array.prototype.keys&&!le.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!le.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ae]){b(Array.prototype,{values:Array.prototype[ae]});if(ne.symbol(J.unscopables)){Array.prototype[J.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var rt=Array.prototype.values;oe(Array.prototype,"values",function values(){return le.Call(rt,this,arguments)});h(Array.prototype,ae,Array.prototype.values,true)}b(Array.prototype,tt);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}xe(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){var nt=Object.getPrototypeOf([].values());if(nt){xe(nt)}}var ot=function(){return a(function(){return Array.from({length:-1}).length===0})}();var it=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!ot||!it){oe(Array,"from",Qe.from)}var at=function(){return a(function(){return Array.from([0],void 0)})}();if(!at){var ut=Array.from;oe(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return le.Call(ut,this,arguments)}return t(ut,this,e)})}var ft=-(Math.pow(2,32)-1);var st=function(e,r){var n={length:ft};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!st(Array.prototype.forEach)){var ct=Array.prototype.forEach;oe(Array.prototype,"forEach",function forEach(e){return le.Call(ct,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.map)){var lt=Array.prototype.map;oe(Array.prototype,"map",function map(e){return le.Call(lt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.filter)){var pt=Array.prototype.filter;oe(Array.prototype,"filter",function filter(e){return le.Call(pt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.some)){var vt=Array.prototype.some;oe(Array.prototype,"some",function some(e){return le.Call(vt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.every)){var yt=Array.prototype.every;oe(Array.prototype,"every",function every(e){return le.Call(yt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduce)){var ht=Array.prototype.reduce;oe(Array.prototype,"reduce",function reduce(e){return le.Call(ht,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduceRight,true)){var bt=Array.prototype.reduceRight;oe(Array.prototype,"reduceRight",function reduceRight(e){return le.Call(bt,this.length>=0?this:[],arguments)})}var gt=Number("0o10")!==8;var dt=Number("0b10")!==2;var mt=y($e,function(e){return Number(e+0+e)===0});if(gt||dt||mt){var Ot=Number;var wt=/^0b[01]+$/i;var jt=/^0o[0-7]+$/i;var St=wt.test.bind(wt);var Tt=jt.test.bind(jt);var It=function(e,t){var r;if(typeof e.valueOf==="function"){r=e.valueOf();if(ne.primitive(r)){return r}}if(typeof e.toString==="function"){r=e.toString();if(ne.primitive(r)){return r}}throw new TypeError("No default value")};var Et=Je.test.bind(Je);var Pt=Xe.test.bind(Xe);var Ct=function(){var e=function Number(t){var r;if(arguments.length>0){r=ne.primitive(t)?t:It(t,"number")}else{r=0}if(typeof r==="string"){r=le.Call(Ue,r);if(St(r)){r=parseInt(C(r,2),2)}else if(Tt(r)){r=parseInt(C(r,2),8)}else if(Et(r)||Pt(r)){r=NaN}}var n=this;var o=a(function(){Ot.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new Ot(r)}return Ot(r)};return e}();Pe(Ot,Ct,{});b(Ct,{NaN:Ot.NaN,MAX_VALUE:Ot.MAX_VALUE,MIN_VALUE:Ot.MIN_VALUE,NEGATIVE_INFINITY:Ot.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ot.POSITIVE_INFINITY});Number=Ct;m.redefine(S,"Number",Ct)}var Mt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Mt,MIN_SAFE_INTEGER:-Mt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Z,isInteger:function isInteger(e){return Z(e)&&le.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&L(e)<=Number.MAX_SAFE_INTEGER},isNaN:K});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){oe(Array.prototype,"find",tt.find)}if([,1].findIndex(function(){return true})!==0){oe(Array.prototype,"findIndex",tt.findIndex)}var xt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Nt=function ensureEnumerable(e,t){if(s&&xt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var At=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var _t=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var Rt=function(e,t){var r=n(Object(t));var o;if(le.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),xt(t))}return p(P(r,o||[]),_t(t),e)};var kt={assign:function(e,t){var r=le.ToObject(e,"Cannot convert undefined or null to object");return p(le.Call(At,1,arguments),Rt,r)},is:function is(e,t){return le.SameValue(e,t)}};var Lt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Lt){oe(Object,"assign",kt.assign)}b(Object,kt);if(s){var Ft={setPrototypeOf:function(e){var r;var n=function(e,t){if(!le.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||le.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var o=function(e,o){n(e,o);t(r,e,o);return e};try{r=e.getOwnPropertyDescriptor(e.prototype,"__proto__").set;t(r,{},null)}catch(i){if(e.prototype!=={}.__proto__){return}r=function(e){this.__proto__=e};o.polyfill=o(o({},null),e.prototype)instanceof e}return o}(Object)};b(Object,Ft)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Dt=!i(function(){return Object.keys("foo")});if(!Dt){var zt=Object.keys;oe(Object,"keys",function keys(e){return zt(le.ToObject(e))});n=Object.keys}var qt=i(function(){return Object.keys(/a/g)});if(qt){var Wt=Object.keys;oe(Object,"keys",function keys(e){if(ne.regex(e)){var t=[];for(var r in e){if(q(e,r)){M(t,r)}}return t}return Wt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var Gt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!Gt){var Ht=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Vt=Object.getOwnPropertyNames;oe(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=le.ToObject(e);if(g(t)==="[object Window]"){try{return Vt(t)}catch(r){return P([],Ht)}}return Vt(t)})}}if(Object.getOwnPropertyDescriptor){var Bt=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Bt){var Ut=Object.getOwnPropertyDescriptor;oe(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ut(le.ToObject(e),t)})}}if(Object.seal){var $t=!i(function(){return Object.seal("foo")});if(!$t){var Jt=Object.seal;oe(Object,"seal",function seal(e){if(!le.TypeIsObject(e)){return e}return Jt(e)})}}if(Object.isSealed){var Xt=!i(function(){return Object.isSealed("foo")});if(!Xt){var Kt=Object.isSealed;oe(Object,"isSealed",function isSealed(e){if(!le.TypeIsObject(e)){return true}return Kt(e)})}}if(Object.freeze){var Zt=!i(function(){return Object.freeze("foo")});if(!Zt){var Yt=Object.freeze;oe(Object,"freeze",function freeze(e){if(!le.TypeIsObject(e)){return e}return Yt(e)})}}if(Object.isFrozen){var Qt=!i(function(){return Object.isFrozen("foo")});if(!Qt){var er=Object.isFrozen;oe(Object,"isFrozen",function isFrozen(e){if(!le.TypeIsObject(e)){return true}return er(e)})}}if(Object.preventExtensions){var tr=!i(function(){return Object.preventExtensions("foo")});if(!tr){var rr=Object.preventExtensions;oe(Object,"preventExtensions",function preventExtensions(e){if(!le.TypeIsObject(e)){return e}return rr(e)})}}if(Object.isExtensible){var nr=!i(function(){return Object.isExtensible("foo")});if(!nr){var or=Object.isExtensible;oe(Object,"isExtensible",function isExtensible(e){if(!le.TypeIsObject(e)){return false}return or(e)})}}if(Object.getPrototypeOf){var ir=!i(function(){return Object.getPrototypeOf("foo")});if(!ir){var ar=Object.getPrototypeOf;oe(Object,"getPrototypeOf",function getPrototypeOf(e){return ar(le.ToObject(e))})}}var ur=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&le.IsCallable(e.get)}();if(s&&!ur){var fr=function flags(){if(!le.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",fr)}var sr=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var cr=ie&&s&&function(){var e=/./;e[J.match]=false;return RegExp(e)===e}();var lr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var pr=lr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!lr||!pr){var vr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=le.RequireObjectCoercible(this);if(ne.regex(e)){return t(vr,e)}var r=fe(e.source);var n=fe(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,vr);RegExp.prototype.toString.prototype=void 0}if(s&&(!sr||cr)){var yr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var hr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var br=function(){return this.source};var gr=le.IsCallable(hr.get)?hr.get:br;var dr=RegExp;var mr=function(){return function RegExp(e,t){var r=le.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(ne.regex(e)){o=le.Call(gr,e);i=typeof t==="undefined"?le.Call(yr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new dr(e,t)}}();Pe(dr,mr,{$input:true});RegExp=mr;m.redefine(S,"RegExp",mr)}if(s){var Or={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Or),function(e){if(e in RegExp&&!(Or[e]in RegExp)){m.getter(RegExp,Or[e],function get(){return RegExp[e]})}})}Me(RegExp);var wr=1/Number.EPSILON;var jr=function roundTiesToEven(e){return e+wr-wr};var Sr=Math.pow(2,-23);var Tr=Math.pow(2,127)*(2-Sr);var Ir=Math.pow(2,-126);var Er=Math.E;var Pr=Math.LOG2E;var Cr=Math.LOG10E;var Mr=Number.prototype.clz;delete Number.prototype.clz;var xr={acosh:function acosh(e){var t=Number(e);if(K(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Q(t-1+z(1-r)*t)}var n=t/2;return Q(n+z(1-r)*n-1)+1/Pr},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=L(t);var n=r*r;var o=Y(t);if(r<1){return o*Q(r+n/(z(n+1)+1))}return o*(Q(r/2+z(1+1/n)*r/2-1)+1/Pr)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(K(t)||t<-1||t>1){return NaN}var r=L(t);return Y(t)*Q(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(D(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=le.ToUint32(t);if(r===0){return 32}return Mr?le.Call(Mr,r):31-k(D(r+.5)*Pr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(K(t)){return NaN}if(!T(t)){return Infinity}var r=F(L(t)-1);return(r+1/(r*Er*Er))*(Er/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(L(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=L(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*z(r)},log2:function log2(e){return D(e)*Pr},log10:function log10(e){return D(e)*Cr},log1p:Q,sign:Y,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=L(t);if(r<1){var n=Math.expm1(r);return Y(t)*n*(1+1/(n+1))/2}var o=F(r-1);return Y(t)*(o-1/(o*Er*Er))*(Er/2)},tanh:function tanh(e){var t=Number(e);if(K(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-k(-t):k(t)},imul:function imul(e,t){var r=le.ToUint32(e);var n=le.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||K(t)){return t}var r=Y(t);var n=L(t);if(n<Ir){return r*jr(n/Ir/Sr)*Ir*Sr}var o=(1+Sr/Number.EPSILON)*n;var i=o-(o-n);if(i>Tr||K(i)){return r*Infinity}return r*i}};var Nr=function withinULPDistance(e,t,r){return L(1-e/t)/Number.EPSILON<(r||8)};b(Math,xr);h(Math,"sinh",xr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",xr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",xr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",xr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));
h(Math,"asinh",xr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",xr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",xr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",xr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",xr.acosh,!Nr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",xr.cbrt,!Nr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",xr.sinh,Math.sinh(-2e-17)!==-2e-17);var Ar=Math.expm1(10);h(Math,"expm1",xr.expm1,Ar>22025.465794806718||Ar<22025.465794806718);h(Math,"hypot",xr.hypot,Math.hypot(Infinity,NaN)!==Infinity);var _r=Math.round;var Rr=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var kr=wr+1;var Lr=2*wr-1;var Fr=[kr,Lr].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=k(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Rr||!Fr);m.preserveToString(Math.round,_r);var Dr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=xr.imul;m.preserveToString(Math.imul,Dr)}if(Math.imul.length!==2){oe(Math,"imul",function imul(e,t){return le.Call(Dr,Math,arguments)})}var zr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}le.IsPromise=function(e){if(!le.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!le.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(le.IsCallable(t.resolve)&&le.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&le.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=A(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=le.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(le.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!le.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!le.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!le.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=_e(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=le.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=le.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(le.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!le.IsPromise(n)){throw new TypeError("not a promise")}var o=le.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=le.IsCallable(e)?e:a;var d=le.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof zr==="function"){b(S,{Promise:zr});var qr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var Wr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,G)});var Gr=i(function(){return S.Promise.call(3,G)});var Hr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,G).then(null,G)}catch(n){return true}return t===r}(S.Promise);var Vr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Br=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Br.prototype=Promise.prototype;Br.all=Promise.all;var Ur=a(function(){return!!Br.all([1,2])});if(!qr||!Wr||!Gr||Hr||!Vr||Ur){Promise=zr;oe(S,"Promise",zr)}if(Promise.all.length!==1){var $r=Promise.all;oe(Promise,"all",function all(e){return le.Call($r,this,arguments)})}if(Promise.race.length!==1){var Jr=Promise.race;oe(Promise,"race",function race(e){return le.Call(Jr,this,arguments)})}if(Promise.resolve.length!==1){var Xr=Promise.resolve;oe(Promise,"resolve",function resolve(e){return le.Call(Xr,this,arguments)})}if(Promise.reject.length!==1){var Kr=Promise.reject;oe(Promise,"reject",function reject(e){return le.Call(Kr,this,arguments)})}Nt(Promise,"all");Nt(Promise,"race");Nt(Promise,"resolve");Nt(Promise,"reject");Me(Promise)}var Zr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Yr=Zr(["z","a","bb"]);var Qr=Zr(["z",1,"a","3",2]);if(s){var en=function fastkey(e,t){if(!t&&!Yr){return null}if(ce(e)){return"^"+le.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Qr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var tn=function emptyObject(){return Object.create?Object.create(null):{}};var rn=function addIterableToMap(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){if(!le.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!ce(o)){a=n.set;if(!le.IsCallable(a)){throw new TypeError("bad map")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!le.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){le.IteratorClose(i,true);throw s}}}}};var nn=function addIterableToSet(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!ce(o)){a=n.add;if(!le.IsCallable(a)){throw new TypeError("bad set")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){le.IteratorClose(i,true);throw s}}}}};var on={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!le.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+le.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");h(this,"head",e._head);h(this,"i",this.head);h(this,"kind",t)};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ze()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ze(n)}}this.i=void 0;return Ze()}};xe(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=_e(this,Map,a,{_es6map:true,_head:null,_map:H?new H:null,_size:0,_storage:tn()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){rn(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=en(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}return}if(this._map){t=B.call(this._map,e);if(t){return t.value}return}var n=this._head;var i=n;while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=en(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return U.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(le.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=en(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}a=this._storage[u]=new r(e,t);i=n.prev}else if(this._map){if(U.call(this._map,e)){B.call(this._map,e).value=t}else{a=new r(e,t);$.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(le.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=en(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!U.call(this._map,t)){return false}n=B.call(this._map,t).prev;V.call(this._map,t)}while((n=n.next)!==r){if(le.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=H?new H:null;this._size=0;this._storage=tn();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});xe(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!le.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+le.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=_e(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:tn()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){nn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new on.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=en(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=en(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=en(e))!==null){var n=q(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=tn()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);xe(i.prototype,i.prototype.values);var f=function SetIterator(e){h(this,"it",e)};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};xe(f.prototype);return i}()};var an=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(an){S.Set=on.Set}if(S.Map||S.Set){var un=a(function(){return new Map([[1,2]]).get(1)===2});if(!un){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(H.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var fn=new Map;var sn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var cn=fn.set(1,2)===fn;if(!sn||!cn){oe(Map.prototype,"set",function set(e,r){t($,this,e===0?0:e,r);return this})}if(!sn){b(Map.prototype,{get:function get(e){return t(B,this,e===0?0:e)},has:function has(e){return t(U,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,B);m.preserveToString(Map.prototype.has,U)}var ln=new Set;var pn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(ln);var vn=ln.add(1)===ln;if(!pn||!vn){var yn=Set.prototype.add;Set.prototype.add=function add(e){t(yn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,yn)}if(!pn){var hn=Set.prototype.has;Set.prototype.has=function has(e){return t(hn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,hn);var bn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(bn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],bn)}var gn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var dn=Object.setPrototypeOf&&!gn;var mn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||dn||!mn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=H.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var On=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var wn=Object.setPrototypeOf&&!On;var jn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||wn||!jn){var Sn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new Sn;if(arguments.length>0){nn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=Sn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,Sn)}var Tn=new S.Map;var In=!a(function(){return Tn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||Tn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof Tn.keys().next!=="function"||In||!gn){b(S,{Map:on.Map,Set:on.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}xe(Object.getPrototypeOf((new S.Map).keys()));xe(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var En=S.Set.prototype.has;oe(S.Set.prototype,"has",function has(e){return t(En,this,e)})}}b(S,on);Me(S.Map);Me(S.Set)}var Pn=function throwUnlessTargetIsObject(e){if(!le.TypeIsObject(e)){throw new TypeError("target must be an object")}};var Cn={apply:function apply(){return le.Call(le.Call,null,arguments)},construct:function construct(e,t){if(!le.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!le.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return le.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){Pn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){Pn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(Cn,{ownKeys:function ownKeys(e){Pn(e);var t=Object.getOwnPropertyNames(e);if(le.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Mn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(Cn,{isExtensible:function isExtensible(e){Pn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){Pn(e);return Mn(function(){return Object.preventExtensions(e)})}})}if(s){var xn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return xn(o,t,r)}if("value"in n){return n.value}if(n.get){return le.Call(n.get,r)}return void 0};var Nn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Nn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!le.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ue.defineProperty(o,r,{value:n})}return ue.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}if(i.set){t(i.set,o,n);return true}return false};Object.assign(Cn,{defineProperty:function defineProperty(e,t,r){Pn(e);return Mn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){Pn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){Pn(e);var r=arguments.length>2?arguments[2]:e;return xn(e,t,r)},set:function set(e,t,r){Pn(e);var n=arguments.length>3?arguments[3]:e;return Nn(e,t,r,n)}})}if(Object.getPrototypeOf){var An=Object.getPrototypeOf;Cn.getPrototypeOf=function getPrototypeOf(e){Pn(e);return An(e)}}if(Object.setPrototypeOf&&Cn.getPrototypeOf){var _n=function(e,t){var r=t;while(r){if(e===r){return true}r=Cn.getPrototypeOf(r)}return false};Object.assign(Cn,{setPrototypeOf:function setPrototypeOf(e,t){Pn(e);if(t!==null&&!le.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ue.getPrototypeOf(e)){return true}if(ue.isExtensible&&!ue.isExtensible(e)){return false}if(_n(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Rn=function(e,t){if(!le.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){oe(S.Reflect,e,t)}}};Object.keys(Cn).forEach(function(e){Rn(e,Cn[e])});var kn=S.Reflect.getPrototypeOf;if(c&&kn&&kn.name!=="getPrototypeOf"){oe(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(kn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){oe(S.Reflect,"setPrototypeOf",Cn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){oe(S.Reflect,"defineProperty",Cn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){oe(S.Reflect,"construct",Cn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Ln=Date.prototype.toString;var Fn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return le.Call(Ln,this)};oe(Date.prototype,"toString",Fn)}var Dn={anchor:function anchor(e){return le.CreateHTML(this,"a","name",e)},big:function big(){return le.CreateHTML(this,"big","","")},blink:function blink(){return le.CreateHTML(this,"blink","","")},bold:function bold(){return le.CreateHTML(this,"b","","")},fixed:function fixed(){return le.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return le.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return le.CreateHTML(this,"font","size",e)},italics:function italics(){return le.CreateHTML(this,"i","","")},link:function link(e){return le.CreateHTML(this,"a","href",e)},small:function small(){return le.CreateHTML(this,"small","","")},strike:function strike(){return le.CreateHTML(this,"strike","","")},sub:function sub(){return le.CreateHTML(this,"sub","","")},sup:function sub(){return le.CreateHTML(this,"sup","","")}};l(Object.keys(Dn),function(e){var r=String.prototype[e];var n=false;if(le.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){oe(String.prototype,e,Dn[e])}});var zn=function(){if(!ie){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(J())!=="undefined"){return true}if(e([J()])!=="[null]"){return true}var t={a:J()};t[J()]=true;if(e(t)!=="{}"){return true}return false}();var qn=a(function(){if(!ie){return true}return JSON.stringify(Object(J()))==="{}"&&JSON.stringify([Object(J())])==="[{}]"});if(zn||!qn){var Wn=JSON.stringify;oe(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=le.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(ne.symbol(n)){return _t({})(n)}return n}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Wn.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(ie,e){"use strict";var oe=[],r=Object.getPrototypeOf,ae=oe.slice,g=oe.flat?function(e){return oe.flat.call(e)}:function(e){return oe.concat.apply([],e)},s=oe.push,se=oe.indexOf,n={},i=n.toString,ue=n.hasOwnProperty,o=ue.toString,a=o.call(Object),le={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},C=ie.document,u={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in u)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e}var t="3.7.1",l=/HTML$/i,ce=function(e,t){return new ce.fn.init(e,t)};function c(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function fe(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}ce.fn=ce.prototype={jquery:t,constructor:ce,length:0,toArray:function(){return ae.call(this)},get:function(e){return null==e?ae.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ce.each(this,e)},map:function(n){return this.pushStack(ce.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(ce.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(ce.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:oe.sort,splice:oe.splice},ce.extend=ce.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(ce.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||ce.isPlainObject(n)?n:{},i=!1,a[t]=ce.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},ce.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==i.call(e))&&(!(t=r(e))||"function"==typeof(n=ue.call(t,"constructor")&&t.constructor)&&o.call(n)===a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(c(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=ce.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?ce.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!l.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(c(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:le}),"function"==typeof Symbol&&(ce.fn[Symbol.iterator]=oe[Symbol.iterator]),ce.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var pe=oe.pop,de=oe.sort,he=oe.splice,ge="[\\x20\\t\\r\\n\\f]",ve=new RegExp("^"+ge+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ge+"+$","g");ce.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var f=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function p(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}ce.escapeSelector=function(e){return(e+"").replace(f,p)};var ye=C,me=s;!function(){var e,b,w,o,a,T,r,C,d,i,k=me,S=ce.expando,E=0,n=0,s=W(),c=W(),u=W(),h=W(),l=function(e,t){return e===t&&(a=!0),0},f="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",p="\\["+ge+"*("+t+")(?:"+ge+"*([*^$|!~]?=)"+ge+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+ge+"*\\]",g=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+p+")*)|.*)\\)|)",v=new RegExp(ge+"+","g"),y=new RegExp("^"+ge+"*,"+ge+"*"),m=new RegExp("^"+ge+"*([>+~]|"+ge+")"+ge+"*"),x=new RegExp(ge+"|>"),j=new RegExp(g),A=new RegExp("^"+t+"$"),D={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+p),PSEUDO:new RegExp("^"+g),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ge+"*(even|odd|(([+-]|)(\\d*)n|)"+ge+"*(?:([+-]|)"+ge+"*(\\d+)|))"+ge+"*\\)|)","i"),bool:new RegExp("^(?:"+f+")$","i"),needsContext:new RegExp("^"+ge+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ge+"*((?:-\\d)?\\d*)"+ge+"*\\)|)(?=[^-]|$)","i")},N=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,L=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,H=/[+~]/,O=new RegExp("\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\([^\\r\\n\\f])","g"),P=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},M=function(){V()},R=J(function(e){return!0===e.disabled&&fe(e,"fieldset")},{dir:"parentNode",next:"legend"});try{k.apply(oe=ae.call(ye.childNodes),ye.childNodes),oe[ye.childNodes.length].nodeType}catch(e){k={apply:function(e,t){me.apply(e,ae.call(t))},call:function(e){me.apply(e,ae.call(arguments,1))}}}function I(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(V(e),e=e||T,C)){if(11!==p&&(u=L.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return k.call(n,a),n}else if(f&&(a=f.getElementById(i))&&I.contains(e,a)&&a.id===i)return k.call(n,a),n}else{if(u[2])return k.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&e.getElementsByClassName)return k.apply(n,e.getElementsByClassName(i)),n}if(!(h[t+" "]||d&&d.test(t))){if(c=t,f=e,1===p&&(x.test(t)||m.test(t))){(f=H.test(t)&&U(e.parentNode)||e)==e&&le.scope||((s=e.getAttribute("id"))?s=ce.escapeSelector(s):e.setAttribute("id",s=S)),o=(l=Y(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+Q(l[o]);c=l.join(",")}try{return k.apply(n,f.querySelectorAll(c)),n}catch(e){h(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return re(t.replace(ve,"$1"),e,n,r)}function W(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function F(e){return e[S]=!0,e}function $(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function B(t){return function(e){return fe(e,"input")&&e.type===t}}function _(t){return function(e){return(fe(e,"input")||fe(e,"button"))&&e.type===t}}function z(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&R(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function X(a){return F(function(o){return o=+o,F(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function U(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function V(e){var t,n=e?e.ownerDocument||e:ye;return n!=T&&9===n.nodeType&&n.documentElement&&(r=(T=n).documentElement,C=!ce.isXMLDoc(T),i=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&ye!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",M),le.getById=$(function(e){return r.appendChild(e).id=ce.expando,!T.getElementsByName||!T.getElementsByName(ce.expando).length}),le.disconnectedMatch=$(function(e){return i.call(e,"*")}),le.scope=$(function(){return T.querySelectorAll(":scope")}),le.cssHas=$(function(){try{return T.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}}),le.getById?(b.filter.ID=function(e){var t=e.replace(O,P);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(O,P);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},b.find.CLASS=function(e,t){if("undefined"!=typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},d=[],$(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"' href='' disabled='disabled'></a><select id='"+S+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+ge+"*(?:value|"+f+")"),e.querySelectorAll("[id~="+S+"-]").length||d.push("~="),e.querySelectorAll("a#"+S+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=T.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),r.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+ge+"*name"+ge+"*="+ge+"*(?:''|\"\")")}),le.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),l=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!le.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument==ye&&I.contains(ye,e)?-1:t===T||t.ownerDocument==ye&&I.contains(ye,t)?1:o?se.call(o,e)-se.call(o,t):0:4&n?-1:1)}),T}for(e in I.matches=function(e,t){return I(e,null,null,t)},I.matchesSelector=function(e,t){if(V(e),C&&!h[t+" "]&&(!d||!d.test(t)))try{var n=i.call(e,t);if(n||le.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){h(t,!0)}return 0<I(t,T,null,[e]).length},I.contains=function(e,t){return(e.ownerDocument||e)!=T&&V(e),ce.contains(e,t)},I.attr=function(e,t){(e.ownerDocument||e)!=T&&V(e);var n=b.attrHandle[t.toLowerCase()],r=n&&ue.call(b.attrHandle,t.toLowerCase())?n(e,t,!C):void 0;return void 0!==r?r:e.getAttribute(t)},I.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ce.uniqueSort=function(e){var t,n=[],r=0,i=0;if(a=!le.sortStable,o=!le.sortStable&&ae.call(e,0),de.call(e,l),a){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)he.call(e,n[r],1)}return o=null,e},ce.fn.uniqueSort=function(){return this.pushStack(ce.uniqueSort(ae.apply(this)))},(b=ce.expr={cacheLength:50,createPseudo:F,match:D,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(O,P),e[3]=(e[3]||e[4]||e[5]||"").replace(O,P),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||I.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&I.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return D.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&j.test(n)&&(t=Y(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(O,P).toLowerCase();return"*"===e?function(){return!0}:function(e){return fe(e,t)}},CLASS:function(e){var t=s[e+" "];return t||(t=new RegExp("(^|"+ge+")"+e+"("+ge+"|$)"))&&s(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=I.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(v," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(d,e,t,h,g){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),m="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u=v!==y?"nextSibling":"previousSibling",l=e.parentNode,c=m&&e.nodeName.toLowerCase(),f=!n&&!m,p=!1;if(l){if(v){while(u){o=e;while(o=o[u])if(m?fe(o,c):1===o.nodeType)return!1;s=u="only"===d&&!s&&"nextSibling"}return!0}if(s=[y?l.firstChild:l.lastChild],y&&f){p=(a=(r=(i=l[S]||(l[S]={}))[d]||[])[0]===E&&r[1])&&r[2],o=a&&l.childNodes[a];while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if(1===o.nodeType&&++p&&o===e){i[d]=[E,a,p];break}}else if(f&&(p=a=(r=(i=e[S]||(e[S]={}))[d]||[])[0]===E&&r[1]),!1===p)while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if((m?fe(o,c):1===o.nodeType)&&++p&&(f&&((i=o[S]||(o[S]={}))[d]=[E,p]),o===e))break;return(p-=g)===h||p%h==0&&0<=p/h}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||I.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?F(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=se.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:F(function(e){var r=[],i=[],s=ne(e.replace(ve,"$1"));return s[S]?F(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:F(function(t){return function(e){return 0<I(t,e).length}}),contains:F(function(t){return t=t.replace(O,P),function(e){return-1<(e.textContent||ce.text(e)).indexOf(t)}}),lang:F(function(n){return A.test(n||"")||I.error("unsupported lang: "+n),n=n.replace(O,P).toLowerCase(),function(e){var t;do{if(t=C?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=ie.location&&ie.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===function(){try{return T.activeElement}catch(e){}}()&&T.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:z(!1),disabled:z(!0),checked:function(e){return fe(e,"input")&&!!e.checked||fe(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return N.test(e.nodeName)},button:function(e){return fe(e,"input")&&"button"===e.type||fe(e,"button")},text:function(e){var t;return fe(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:X(function(){return[0]}),last:X(function(e,t){return[t-1]}),eq:X(function(e,t,n){return[n<0?n+t:n]}),even:X(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:X(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:X(function(e,t,n){var r;for(r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:X(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=B(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=_(e);function G(){}function Y(e,t){var n,r,i,o,a,s,u,l=c[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=y.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=m.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ve," ")}),a=a.slice(n.length)),b.filter)!(r=D[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?I.error(e):c(e,s).slice(0)}function Q(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function J(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=n++;return e.first?function(e,t,n){while(e=e[s])if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[E,f];if(n){while(e=e[s])if((1===e.nodeType||c)&&a(e,t,n))return!0}else while(e=e[s])if(1===e.nodeType||c)if(i=e[S]||(e[S]={}),u&&fe(e,u))e=e[s]||e;else{if((r=i[l])&&r[0]===E&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=a(e,t,n))return!0}return!1}}function K(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Z(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function ee(d,h,g,v,y,e){return v&&!v[S]&&(v=ee(v)),y&&!y[S]&&(y=ee(y,e)),F(function(e,t,n,r){var i,o,a,s,u=[],l=[],c=t.length,f=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)I(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),p=!d||!e&&h?f:Z(f,u,d,n,r);if(g?g(p,s=y||(e?d:c||v)?[]:t,n,r):s=p,v){i=Z(s,l),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(s[l[o]]=!(p[l[o]]=a))}if(e){if(y||d){if(y){i=[],o=s.length;while(o--)(a=s[o])&&i.push(p[o]=a);y(null,s=[],i,r)}o=s.length;while(o--)(a=s[o])&&-1<(i=y?se.call(e,a):u[o])&&(e[i]=!(t[i]=a))}}else s=Z(s===t?s.splice(c,s.length):s),y?y(null,t,s,r):k.apply(t,s)})}function te(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=J(function(e){return e===i},a,!0),l=J(function(e){return-1<se.call(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!=w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[J(K(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return ee(1<s&&K(c),1<s&&Q(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ve,"$1"),t,s<n&&te(e.slice(s,n)),n<r&&te(e=e.slice(n)),n<r&&Q(e))}c.push(t)}return K(c)}function ne(e,t){var n,v,y,m,x,r,i=[],o=[],a=u[e+" "];if(!a){t||(t=Y(e)),n=t.length;while(n--)(a=te(t[n]))[S]?i.push(a):o.push(a);(a=u(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=E+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==T||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==T||(V(o),n=!C);while(s=v[a++])if(s(o,t||T,n)){k.call(r,o);break}i&&(E=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=pe.call(r));f=Z(f)}k.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&ce.uniqueSort(r)}return i&&(E=h,w=p),c},m?F(r):r))).selector=e}return a}function re(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&Y(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&C&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(O,P),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=D.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(O,P),H.test(o[0].type)&&U(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&Q(o)))return k.apply(n,r),n;break}}}return(l||ne(e,c))(r,t,!C,n,!t||H.test(e)&&U(t.parentNode)||t),n}G.prototype=b.filters=b.pseudos,b.setFilters=new G,le.sortStable=S.split("").sort(l).join("")===S,V(),le.sortDetached=$(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))}),ce.find=I,ce.expr[":"]=ce.expr.pseudos,ce.unique=ce.uniqueSort,I.compile=ne,I.select=re,I.setDocument=V,I.tokenize=Y,I.escape=ce.escapeSelector,I.getText=ce.text,I.isXML=ce.isXMLDoc,I.selectors=ce.expr,I.support=ce.support,I.uniqueSort=ce.uniqueSort}();var d=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&ce(e).is(n))break;r.push(e)}return r},h=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=ce.expr.match.needsContext,w=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,n,r){return v(n)?ce.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?ce.grep(e,function(e){return e===n!==r}):"string"!=typeof n?ce.grep(e,function(e){return-1<se.call(n,e)!==r}):ce.filter(n,e,r)}ce.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ce.find.matchesSelector(r,e)?[r]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},ce.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=0;t<r;t++)if(ce.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)ce.find(e,i[t],n);return 1<r?ce.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&b.test(e)?ce(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ce.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||k,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:S.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ce?t[0]:t,ce.merge(this,ce.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),w.test(r[1])&&ce.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=C.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(ce):ce.makeArray(e,this)}).prototype=ce.fn,k=ce(C);var E=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){while((e=e[t])&&1!==e.nodeType);return e}ce.fn.extend({has:function(e){var t=ce(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ce.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&ce(e);if(!b.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&ce.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?ce.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(ce(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ce.uniqueSort(ce.merge(this.get(),ce(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return h((e.parentNode||{}).firstChild,e)},children:function(e){return h(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(fe(e,"template")&&(e=e.content||e),ce.merge([],e.childNodes))}},function(r,i){ce.fn[r]=function(e,t){var n=ce.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=ce.filter(t,n)),1<this.length&&(j[r]||ce.uniqueSort(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function N(e){return e}function q(e){throw e}function L(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}ce.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},ce.each(e.match(D)||[],function(e,t){n[t]=!0}),n):ce.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){ce.each(e,function(e,t){v(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==x(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return ce.each(arguments,function(e,t){var n;while(-1<(n=ce.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<ce.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ce.extend({Deferred:function(e){var o=[["notify","progress",ce.Callbacks("memory"),ce.Callbacks("memory"),2],["resolve","done",ce.Callbacks("once memory"),ce.Callbacks("once memory"),0,"resolved"],["reject","fail",ce.Callbacks("once memory"),ce.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return ce.Deferred(function(r){ce.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?s?t.call(e,l(u,o,N,s),l(u,o,q,s)):(u++,t.call(e,l(u,o,N,s),l(u,o,q,s),l(u,o,N,o.notifyWith))):(a!==N&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){ce.Deferred.exceptionHook&&ce.Deferred.exceptionHook(e,t.error),u<=i+1&&(a!==q&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(ce.Deferred.getErrorHook?t.error=ce.Deferred.getErrorHook():ce.Deferred.getStackHook&&(t.error=ce.Deferred.getStackHook()),ie.setTimeout(t))}}return ce.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:N,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:N)),o[2][3].add(l(0,e,v(n)?n:q))}).promise()},promise:function(e){return null!=e?ce.extend(e,a):a}},s={};return ce.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=ae.call(arguments),o=ce.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?ae.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(L(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||v(i[t]&&i[t].then)))return o.then();while(t--)L(i[t],a(t),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ce.Deferred.exceptionHook=function(e,t){ie.console&&ie.console.warn&&e&&H.test(e.name)&&ie.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ce.readyException=function(e){ie.setTimeout(function(){throw e})};var O=ce.Deferred();function P(){C.removeEventListener("DOMContentLoaded",P),ie.removeEventListener("load",P),ce.ready()}ce.fn.ready=function(e){return O.then(e)["catch"](function(e){ce.readyException(e)}),this},ce.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ce.readyWait:ce.isReady)||(ce.isReady=!0)!==e&&0<--ce.readyWait||O.resolveWith(C,[ce])}}),ce.ready.then=O.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?ie.setTimeout(ce.ready):(C.addEventListener("DOMContentLoaded",P),ie.addEventListener("load",P));var M=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)M(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(ce(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},R=/^-ms-/,I=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function F(e){return e.replace(R,"ms-").replace(I,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function B(){this.expando=ce.expando+B.uid++}B.uid=1,B.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[F(t)]=n;else for(r in t)i[F(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][F(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(F):(t=F(t))in r?[t]:t.match(D)||[]).length;while(n--)delete r[t[n]]}(void 0===t||ce.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ce.isEmptyObject(t)}};var _=new B,z=new B,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/[A-Z]/g;function V(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(U,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:X.test(i)?JSON.parse(i):i)}catch(e){}z.set(e,t,n)}else n=void 0;return n}ce.extend({hasData:function(e){return z.hasData(e)||_.hasData(e)},data:function(e,t,n){return z.access(e,t,n)},removeData:function(e,t){z.remove(e,t)},_data:function(e,t,n){return _.access(e,t,n)},_removeData:function(e,t){_.remove(e,t)}}),ce.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=z.get(o),1===o.nodeType&&!_.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=F(r.slice(5)),V(o,r,i[r]));_.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){z.set(this,n)}):M(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=z.get(o,n))?t:void 0!==(t=V(o,n))?t:void 0;this.each(function(){z.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){z.remove(this,e)})}}),ce.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=_.get(e,t),n&&(!r||Array.isArray(n)?r=_.access(e,t,ce.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),r=n.length,i=n.shift(),o=ce._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ce.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return _.get(e,n)||_.access(e,n,{empty:ce.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",n])})})}}),ce.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ce.queue(this[0],t):void 0===n?this:this.each(function(){var e=ce.queue(this,t,n);ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ce.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=_.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),Q=["Top","Right","Bottom","Left"],J=C.documentElement,K=function(e){return ce.contains(e.ownerDocument,e)},Z={composed:!0};J.getRootNode&&(K=function(e){return ce.contains(e.ownerDocument,e)||e.getRootNode(Z)===e.ownerDocument});var ee=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&K(e)&&"none"===ce.css(e,"display")};function te(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return ce.css(e,t,"")},u=s(),l=n&&n[3]||(ce.cssNumber[t]?"":"px"),c=e.nodeType&&(ce.cssNumber[t]||"px"!==l&&+u)&&Y.exec(ce.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)ce.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,ce.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ne={};function re(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=_.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ee(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ne[s])||(o=a.body.appendChild(a.createElement(s)),u=ce.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ne[s]=u)))):"none"!==n&&(l[c]="none",_.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}ce.fn.extend({show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?ce(this).show():ce(this).hide()})}});var xe,be,we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;xe=C.createDocumentFragment().appendChild(C.createElement("div")),(be=C.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),xe.appendChild(be),le.checkClone=xe.cloneNode(!0).cloneNode(!0).lastChild.checked,xe.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!xe.cloneNode(!0).lastChild.defaultValue,xe.innerHTML="<option></option>",le.option=!!xe.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Se(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&fe(e,t)?ce.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)_.set(e[n],"globalEval",!t||_.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,le.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var je=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))ce.merge(p,o.nodeType?[o]:o);else if(je.test(o)){a=a||f.appendChild(t.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),u=ke[s]||ke._default,a.innerHTML=u[1]+ce.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;ce.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<ce.inArray(o,r))i&&i.push(o);else if(l=K(o),a=Se(f.appendChild(o),"script"),l&&Ee(a),n){c=0;while(o=a[c++])Ce.test(o.type||"")&&n.push(o)}return f}var De=/^([^.]*)(?:\.(.+)|)/;function Ne(){return!0}function qe(){return!1}function Le(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Le(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=qe;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return ce().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ce.guid++)),e.each(function(){ce.event.add(this,t,i,r,n)})}function He(e,r,t){t?(_.set(e,r,!1),ce.event.add(e,r,{namespace:!1,handler:function(e){var t,n=_.get(this,r);if(1&e.isTrigger&&this[r]){if(n)(ce.event.special[r]||{}).delegateType&&e.stopPropagation();else if(n=ae.call(arguments),_.set(this,r,n),this[r](),t=_.get(this,r),_.set(this,r,!1),n!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else n&&(_.set(this,r,ce.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Ne)}})):void 0===_.get(e,r)&&ce.event.add(e,r,Ne)}ce.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.get(t);if($(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&ce.find.matchesSelector(J,i),n.guid||(n.guid=ce.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ce&&ce.event.triggered!==e.type?ce.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(D)||[""]).length;while(l--)d=g=(s=De.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=ce.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=ce.event.special[d]||{},c=ce.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ce.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),ce.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.hasData(e)&&_.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(D)||[""]).length;while(l--)if(d=g=(s=De.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=ce.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||ce.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)ce.event.remove(e,d+t[l],n,r,!0);ce.isEmptyObject(u)&&_.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=ce.event.fix(e),l=(_.get(this,"events")||Object.create(null))[u.type]||[],c=ce.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=ce.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((ce.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<ce(i,this).index(l):ce.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(ce.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[ce.expando]?e:new ce.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&fe(t,"input")&&_.get(t,"click")||fe(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ce.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ce.Event=function(e,t){if(!(this instanceof ce.Event))return new ce.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ne:qe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ce.expando]=!0},ce.Event.prototype={constructor:ce.Event,isDefaultPrevented:qe,isPropagationStopped:qe,isImmediatePropagationStopped:qe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ce.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},ce.event.addProp),ce.each({focus:"focusin",blur:"focusout"},function(r,i){function o(e){if(C.documentMode){var t=_.get(this,"handle"),n=ce.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,t(e),n.target===n.currentTarget&&t(n)}else ce.event.simulate(i,e.target,ce.event.fix(e))}ce.event.special[r]={setup:function(){var e;if(He(this,r,!0),!C.documentMode)return!1;(e=_.get(this,i))||this.addEventListener(i,o),_.set(this,i,(e||0)+1)},trigger:function(){return He(this,r),!0},teardown:function(){var e;if(!C.documentMode)return!1;(e=_.get(this,i)-1)?_.set(this,i,e):(this.removeEventListener(i,o),_.remove(this,i))},_default:function(e){return _.get(e.target,r)},delegateType:i},ce.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i);n||(C.documentMode?this.addEventListener(i,o):e.addEventListener(r,o,!0)),_.set(t,i,(n||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i)-1;n?_.set(t,i,n):(C.documentMode?this.removeEventListener(i,o):e.removeEventListener(r,o,!0),_.remove(t,i))}}}),ce.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){ce.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||ce.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),ce.fn.extend({on:function(e,t,n,r){return Le(this,e,t,n,r)},one:function(e,t,n,r){return Le(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ce(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=qe),this.each(function(){ce.event.remove(this,e,n,t)})}});var Oe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Re(e,t){return fe(e,"table")&&fe(11!==t.nodeType?t:t.firstChild,"tr")&&ce(e).children("tbody")[0]||e}function Ie(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(_.hasData(e)&&(s=_.get(e).events))for(i in _.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)ce.event.add(t,i,s[i][n]);z.hasData(e)&&(o=z.access(e),a=ce.extend({},o),z.set(t,a))}}function $e(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!le.checkClone&&Pe.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),$e(t,r,i,o)});if(f&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=ce.map(Se(e,"script"),Ie)).length;c<f;c++)u=e,c!==p&&(u=ce.clone(u,!0,!0),s&&ce.merge(a,Se(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,ce.map(a,We),c=0;c<s;c++)u=a[c],Ce.test(u.type||"")&&!_.access(u,"globalEval")&&ce.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?ce._evalUrl&&!u.noModule&&ce._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):m(u.textContent.replace(Me,""),u,l))}return n}function Be(e,t,n){for(var r,i=t?ce.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ce.cleanData(Se(r)),r.parentNode&&(n&&K(r)&&Ee(Se(r,"script")),r.parentNode.removeChild(r));return e}ce.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=K(e);if(!(le.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(a=Se(c),r=0,i=(o=Se(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||Se(e),a=a||Se(c),r=0,i=o.length;r<i;r++)Fe(o[r],a[r]);else Fe(e,c);return 0<(a=Se(c,"script")).length&&Ee(a,!f&&Se(e,"script")),c},cleanData:function(e){for(var t,n,r,i=ce.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[_.expando]){if(t.events)for(r in t.events)i[r]?ce.event.remove(n,r):ce.removeEvent(n,r,t.handle);n[_.expando]=void 0}n[z.expando]&&(n[z.expando]=void 0)}}}),ce.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return M(this,function(e){return void 0===e?ce.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return $e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ce.cleanData(Se(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return M(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=ce.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ce.cleanData(Se(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return $e(this,arguments,function(e){var t=this.parentNode;ce.inArray(this,n)<0&&(ce.cleanData(Se(this)),t&&t.replaceChild(e,this))},n)}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ce.fn[e]=function(e){for(var t,n=[],r=ce(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),ce(r[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var _e=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=ie),t.getComputedStyle(e)},Ue=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ve=new RegExp(Q.join("|"),"i");function Ge(e,t,n){var r,i,o,a,s=ze.test(t),u=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(ve,"$1")||void 0),""!==a||K(e)||(a=ce.style(e,t)),!le.pixelBoxStyles()&&_e.test(a)&&Ve.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",J.appendChild(u).appendChild(l);var e=ie.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),J.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=C.createElement("div"),l=C.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle="content-box"===l.style.backgroundClip,ce.extend(le,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=C.createElement("table"),t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",J.appendChild(e).appendChild(t).appendChild(n),r=ie.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,J.removeChild(e)),a}}))}();var Qe=["Webkit","Moz","ms"],Je=C.createElement("div").style,Ke={};function Ze(e){var t=ce.cssProps[e]||Ke[e];return t||(e in Je?e:Ke[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Qe.length;while(n--)if((e=Qe[n]+t)in Je)return e}(e)||e)}var et=/^(none|table(?!-c[ea]).+)/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=Y.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=ce.css(e,n+Q[a],!0,i)),r?("content"===n&&(u-=ce.css(e,"padding"+Q[a],!0,i)),"margin"!==n&&(u-=ce.css(e,"border"+Q[a]+"Width",!0,i))):(u+=ce.css(e,"padding"+Q[a],!0,i),"padding"!==n?u+=ce.css(e,"border"+Q[a]+"Width",!0,i):s+=ce.css(e,"border"+Q[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u+l}function ot(e,t,n){var r=Xe(e),i=(!le.boxSizingReliable()||n)&&"border-box"===ce.css(e,"boxSizing",!1,r),o=i,a=Ge(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(_e.test(a)){if(!n)return a;a="auto"}return(!le.boxSizingReliable()&&i||!le.reliableTrDimensions()&&fe(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===ce.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===ce.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=F(t),u=ze.test(t),l=e.style;if(u||(t=Ze(s)),a=ce.cssHooks[t]||ce.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=Y.exec(n))&&i[1]&&(n=te(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(ce.cssNumber[s]?"":"px")),le.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=F(t);return ze.test(t)||(t=Ze(s)),(a=ce.cssHooks[t]||ce.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ge(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ce.each(["height","width"],function(e,u){ce.cssHooks[u]={get:function(e,t,n){if(t)return!et.test(ce.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,u,n):Ue(e,tt,function(){return ot(e,u,n)})},set:function(e,t,n){var r,i=Xe(e),o=!le.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===ce.css(e,"boxSizing",!1,i),s=n?it(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-it(e,u,"border",!1,i)-.5)),s&&(r=Y.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=ce.css(e,u)),rt(0,t,s)}}}),ce.cssHooks.marginLeft=Ye(le.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ge(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ce.each({margin:"",padding:"",border:"Width"},function(i,o){ce.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Q[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(ce.cssHooks[i+o].set=rt)}),ce.fn.extend({css:function(e,t){return M(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;a<i;a++)o[t[a]]=ce.css(e,t[a],!1,r);return o}return void 0!==n?ce.style(e,t,n):ce.css(e,t)},e,t,1<arguments.length)}}),((ce.Tween=at).prototype={constructor:at,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||ce.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ce.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}}).init.prototype=at.prototype,(at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ce.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):1!==e.elem.nodeType||!ce.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:ce.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ce.fx=at.prototype.init,ce.fx.step={};var st,ut,lt,ct,ft=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function dt(){ut&&(!1===C.hidden&&ie.requestAnimationFrame?ie.requestAnimationFrame(dt):ie.setTimeout(dt,ce.fx.interval),ce.fx.tick())}function ht(){return ie.setTimeout(function(){st=void 0}),st=Date.now()}function gt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Q[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function yt(o,e,t){var n,a,r=0,i=yt.prefilters.length,s=ce.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=st||ht(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{},easing:ce.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||ht(),duration:t.duration,tweens:[],createTween:function(e,t){var n=ce.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=F(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ce.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=yt.prefilters[r].call(l,o,c,l.opts))return v(n.stop)&&(ce._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return ce.map(c,vt,l),v(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ce.fx.timer(ce.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}ce.Animation=ce.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return te(n.elem,e,Y.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(D);for(var n,r=0,i=e.length;r<i;r++)n=e[r],yt.tweeners[n]=yt.tweeners[n]||[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ee(e),v=_.get(e,"fxshow");for(r in n.queue||(null==(a=ce._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ce.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ft.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||ce.style(e,r)}if((u=!ce.isEmptyObject(t))||!ce.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=_.get(e,"display")),"none"===(c=ce.css(e,"display"))&&(l?c=l:(re([e],!0),l=e.style.display||l,c=ce.css(e,"display"),re([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ce.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=_.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&re([e],!0),p.done(function(){for(r in g||re([e]),_.remove(e,"fxshow"),d)ce.style(e,r,d[r])})),u=vt(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),ce.speed=function(e,t,n){var r=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return ce.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in ce.fx.speeds?r.duration=ce.fx.speeds[r.duration]:r.duration=ce.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&ce.dequeue(this,r.queue)},r},ce.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ce.isEmptyObject(t),o=ce.speed(e,n,r),a=function(){var e=yt(this,ce.extend({},t),o);(i||_.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ce.timers,r=_.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&pt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||ce.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=_.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=ce.timers,o=n?n.length:0;for(t.finish=!0,ce.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),ce.each(["toggle","show","hide"],function(e,r){var i=ce.fn[r];ce.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(gt(r,!0),e,t,n)}}),ce.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ce.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ce.timers=[],ce.fx.tick=function(){var e,t=0,n=ce.timers;for(st=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ce.fx.stop(),st=void 0},ce.fx.timer=function(e){ce.timers.push(e),ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){ut||(ut=!0,dt())},ce.fx.stop=function(){ut=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fn.delay=function(r,e){return r=ce.fx&&ce.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=ie.setTimeout(e,r);t.stop=function(){ie.clearTimeout(n)}})},lt=C.createElement("input"),ct=C.createElement("select").appendChild(C.createElement("option")),lt.type="checkbox",le.checkOn=""!==lt.value,le.optSelected=ct.selected,(lt=C.createElement("input")).value="t",lt.type="radio",le.radioValue="t"===lt.value;var mt,xt=ce.expr.attrHandle;ce.fn.extend({attr:function(e,t){return M(this,ce.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})}}),ce.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?ce.prop(e,t,n):(1===o&&ce.isXMLDoc(e)||(i=ce.attrHooks[t.toLowerCase()]||(ce.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void ce.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=ce.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!le.radioValue&&"radio"===t&&fe(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(D);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),mt={set:function(e,t,n){return!1===t?ce.removeAttr(e,n):e.setAttribute(n,n),n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ce.find.attr;xt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=xt[o],xt[o]=r,r=null!=a(e,t,n)?o:null,xt[o]=i),r}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;function Tt(e){return(e.match(D)||[]).join(" ")}function Ct(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(D)||[]}ce.fn.extend({prop:function(e,t){return M(this,ce.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[ce.propFix[e]||e]})}}),ce.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ce.isXMLDoc(e)||(t=ce.propFix[t]||t,i=ce.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),le.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.fn.extend({addClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).addClass(t.call(this,e,Ct(this)))}):(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).removeClass(t.call(this,e,Ct(this)))}):arguments.length?(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return v(t)?this.each(function(e){ce(this).toggleClass(t.call(this,e,Ct(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=kt(t),this.each(function(){if(s)for(o=ce(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=Ct(this))&&_.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":_.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+Tt(Ct(n))+" ").indexOf(t))return!0;return!1}});var St=/\r/g;ce.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=v(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,ce(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=ce.map(t,function(e){return null==e?"":e+""})),(r=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=ce.valHooks[t.type]||ce.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(St,""):null==e?"":e:void 0}}),ce.extend({valHooks:{option:{get:function(e){var t=ce.find.attr(e,"value");return null!=t?t:Tt(ce.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!fe(n.parentNode,"optgroup"))){if(t=ce(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=ce.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<ce.inArray(ce.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<ce.inArray(ce(e).val(),t)}},le.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et=ie.location,jt={guid:Date.now()},At=/\?/;ce.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new ie.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||ce.error("Invalid XML: "+(n?ce.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};ce.extend(ce.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||C],d=ue.call(e,"type")?e.type:e,h=ue.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||C,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(d+ce.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[ce.expando]?e:new ce.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ce.makeArray(t,[e]),c=ce.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!y(n)){for(s=c.delegateType||d,Dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||C)&&p.push(a.defaultView||a.parentWindow||ie)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&$(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!$(n)||u&&v(n[d])&&!y(n)&&((a=n[u])&&(n[u]=null),ce.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,Nt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,Nt),ce.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=ce.extend(new ce.Event,n,{type:e,isSimulated:!0});ce.event.trigger(r,null,t)}}),ce.fn.extend({trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var qt=/\[\]$/,Lt=/\r?\n/g,Ht=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function Pt(n,e,r,i){var t;if(Array.isArray(e))ce.each(e,function(e,t){r||qt.test(n)?i(n,t):Pt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==x(e))i(n,e);else for(t in e)Pt(n+"["+t+"]",e[t],r,i)}ce.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){i(this.name,this.value)});else for(n in e)Pt(n,e[n],t,i);return r.join("&")},ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&Ot.test(this.nodeName)&&!Ht.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:Array.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}}):{name:t.name,value:n.replace(Lt,"\r\n")}}).get()}});var Mt=/%20/g,Rt=/#.*$/,It=/([?&])_=[^&]*/,Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt={},_t={},zt="*/".concat("*"),Xt=C.createElement("a");function Ut(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(D)||[];if(v(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Vt(t,i,o,a){var s={},u=t===_t;function l(e){var r;return s[e]=!0,ce.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var n,r,i=ce.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&ce.extend(!0,e,r),e}Xt.href=Et.href,ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,ce.ajaxSettings),t):Gt(ce.ajaxSettings,e)},ajaxPrefilter:Ut(Bt),ajaxTransport:Ut(_t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=ce.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?ce(y):ce.event,x=ce.Deferred(),b=ce.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Wt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Et.href)+"").replace($t,Et.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||[""],null==v.crossDomain){r=C.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Xt.protocol+"//"+Xt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=ce.param(v.data,v.traditional)),Vt(Bt,v,t,T),h)return T;for(i in(g=ce.event&&v.global)&&0==ce.active++&&ce.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ft.test(v.type),f=v.url.replace(Rt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Mt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(At.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(It,"$1"),o=(At.test(f)?"&":"?")+"_="+jt.guid+++o),v.url=f+o),v.ifModified&&(ce.lastModified[f]&&T.setRequestHeader("If-Modified-Since",ce.lastModified[f]),ce.etag[f]&&T.setRequestHeader("If-None-Match",ce.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+zt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Vt(_t,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=ie.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&ie.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<ce.inArray("script",v.dataTypes)&&ce.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(ce.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(ce.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--ce.active||ce.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,t){return ce.get(e,void 0,t,"script")}}),ce.each(["get","post"],function(e,i){ce[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),ce.ajax(ce.extend({url:e,type:i,dataType:r,data:t,success:n},ce.isPlainObject(e)&&e))}}),ce.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),ce._evalUrl=function(e,t,n){return ce.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){ce.globalEval(e,t,n)}})},ce.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=ce(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){ce(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ce(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){ce(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ce(this).replaceWith(this.childNodes)}),this}}),ce.expr.pseudos.hidden=function(e){return!ce.expr.pseudos.visible(e)},ce.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ce.ajaxSettings.xhr=function(){try{return new ie.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Qt=ce.ajaxSettings.xhr();le.cors=!!Qt&&"withCredentials"in Qt,le.ajax=Qt=!!Qt,ce.ajaxTransport(function(i){var o,a;if(le.cors||Qt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Yt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&ie.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),ce.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ce.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=ce("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Jt,Kt=[],Zt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kt.pop()||ce.expando+"_"+jt.guid++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ce.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=ie[r],ie[r]=function(){o=arguments},n.always(function(){void 0===i?ce(ie).removeProp(r):ie[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Kt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),le.createHTMLDocument=((Jt=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),ce.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(le.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),o=!n&&[],(i=w.exec(e))?[t.createElement(i[1])]:(i=Ae([e],t,o),o&&o.length&&ce(o).remove(),ce.merge([],i.childNodes)));var r,i,o},ce.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&ce.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?ce("<div>").append(ce.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},ce.expr.pseudos.animated=function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length},ce.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=ce.css(e,"position"),c=ce(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=ce.css(e,"top"),u=ce.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),v(t)&&(t=t.call(e,n,ce.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},ce.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ce.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===ce.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===ce.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=ce(e).offset()).top+=ce.css(e,"borderTopWidth",!0),i.left+=ce.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-ce.css(r,"marginTop",!0),left:t.left-i.left-ce.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===ce.css(e,"position"))e=e.offsetParent;return e||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;ce.fn[t]=function(e){return M(this,function(e,t,n){var r;if(y(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),ce.each(["top","left"],function(e,n){ce.cssHooks[n]=Ye(le.pixelPosition,function(e,t){if(t)return t=Ge(e,n),_e.test(t)?ce(e).position()[n]+"px":t})}),ce.each({Height:"height",Width:"width"},function(a,s){ce.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){ce.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return M(this,function(e,t,n){var r;return y(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?ce.css(e,t,i):ce.style(e,t,n,i)},s,n?e:void 0,n)}})}),ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),ce.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){ce.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var en=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;ce.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=ae.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(ae.call(arguments)))}).guid=e.guid=e.guid||ce.guid++,i},ce.holdReady=function(e){e?ce.readyWait++:ce.ready(!0)},ce.isArray=Array.isArray,ce.parseJSON=JSON.parse,ce.nodeName=fe,ce.isFunction=v,ce.isWindow=y,ce.camelCase=F,ce.type=x,ce.now=Date.now,ce.isNumeric=function(e){var t=ce.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},ce.trim=function(e){return null==e?"":(e+"").replace(en,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce});var tn=ie.jQuery,nn=ie.$;return ce.noConflict=function(e){return ie.$===ce&&(ie.$=nn),e&&ie.jQuery===ce&&(ie.jQuery=tn),ce},"undefined"==typeof e&&(ie.jQuery=ie.$=ce),ce});
"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n,r,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return r=!(n=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){r=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(r)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}define("engine",["jquery","utils","state","section","passages"],function(N,j,P,R,I){var t,V=j.impossible,M=j.passageSelector,D=j.transitionOut,F=j.options;function L(e,t,n){var r,a,o;if(n?(n=n.get("name"),(a=I.getTree(n)).children.length&&(r={type:"include",tag:t,name:n,children:a.children,text:a.text})):r=I.getTree(t),r){for(;(o=e[e.length-1])&&("root"===o.type||"include"===o.type)&&o.children.some(function(e){return e.type.startsWith("unclosed")});)e[e.length-1]=Object.create(o),e=e[e.length-1].children=o.children.slice();e.push(r)}}function n(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.loadedGame,a=I.get(e),o=j.storyElement,i=o.parent(),s=n.stretch,n=n.transition,n=void 0===n?{}:n,c=n.depart,c=void 0===c?"instant":c,l=n.arrive,l=void 0===l?"dissolve":l,u=n.departOrigin,p=n.arriveOrigin,n=n.time,d=(i.findAndFilter("tw-enchantment").each(function(e,t){var n=(t=N(t)).data("enchantedProperties");n&&o.css(n.reduce(function(e,t){return e[t]="",e},{})),t[0]===i[0]&&(i=o.unwrap().parent())}),I.hasValid(e)||V("Engine.showPassage","There's no passage with the name \""+e+'"!'),o.children(M).not(".transition-out, .transition-out *")),a=(a.get("tags")||[]).join(" "),f=(t=N("<tw-passage><tw-sidebar>"),f=t.children("tw-sidebar"),h=N('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),g=N('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),P.pastLength<=0&&h.css("visibility","hidden"),P.futureLength<=0&&g.css("visibility","hidden"),f.append(h,g),t),h=("function"==typeof u&&(u=u.call(d)),"function"==typeof p&&(p=p.call(f)),!s&&c),m=h&&d.css("width"),g=(j.detachStoryElement(),f.appendTo(o).attr({tags:a}),h&&(D(d,c,n,0,0,0,u),d.css({position:"absolute",width:function(){return"0px"!==m?m:"100%"}})),o.attr({tags:a}),R.create(f)),y=(r&&(g.loadedGame=!0),[]);if(P.pastLength<=0&&1===P.turns){var b,v=_createForOfIteratorHelper(I.getTagged("startup"));try{for(v.s();!(b=v.n()).done;)L(y,"startup",b.value)}catch(e){v.e(e)}finally{v.f()}if(F.debug){var w,k=_createForOfIteratorHelper(I.getTagged("debug-startup"));try{for(k.s();!(w=k.n()).done;)L(y,"debug-startup",w.value)}catch(e){k.e(e)}finally{k.f()}}}var S,T=_createForOfIteratorHelper(I.getTagged("header"));try{for(T.s();!(S=T.n()).done;)L(y,"header",S.value)}catch(e){T.e(e)}finally{T.f()}if(F.debug){var _,x=_createForOfIteratorHelper(I.getTagged("debug-header"));try{for(x.s();!(_=x.n()).done;)L(y,"debug-header",_.value)}catch(e){x.e(e)}finally{x.f()}}L(y,e);var O,A=_createForOfIteratorHelper(I.getTagged("footer"));try{for(A.s();!(O=A.n()).done;)L(y,"footer",O.value)}catch(e){A.e(e)}finally{A.f()}if(F.debug){var C,E=_createForOfIteratorHelper(I.getTagged("debug-footer"));try{for(E.s();!(C=E.n()).done;)L(y,"debug-footer",C.value)}catch(e){E.e(e)}finally{E.f()}}g.renderInto(y,f,{transition:l,transitionTime:n,transitionOrigin:p}),g.loadedGame=!1,j.reattachStoryElement(),scroll(0,s?f.offset().top-.05*N(window).height():o[0].getBoundingClientRect().top+document.body.scrollTop)}return Object.freeze({goBack:function(e){P.rewind()&&n(P.passage,e)},goForward:function(e){P.fastForward()&&n(P.passage,e)},goToPassage:function(e,t){P.play(e),n(e,t)},redirect:function(e,t){P.redirect(e),n(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:n,enableDebugMode:function(){t&&t()},registerDebugMode:function(e){t=t||e}})}),define("harlowe",["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","utils/jqueryplugins","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref,VarScope){var dialog=_ref.dialog;function __HarloweEval(text){eval(text+"")}function printJSError(e){var t,n="".concat(e.name,": ").concat(e.message);return e.stack&&(t=(e=e.stack.split("\n")).findIndex(function(e){return e.includes("__HarloweEval")}),n+="\n".concat(e.slice(0,t).join("\n").replace(/\([^)]+\)/g,""))),"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+n+"```</div>"}!function(o){window.onerror=function(e,t,n,r,a){window.onerror=o,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n".concat(printJSError(a),"\n(This is probably due to a bug in the Harlowe game engine.)")}).addClass("harlowe-crash")),"function"==typeof o&&o.apply(void 0,arguments)}}(window.onerror),Utils.onStartup(function(){var n,e,t,r,a=$("tw-storydata");0!==a.length&&(Utils.options.ifid=a.attr("ifid"),(a.attr("tags")||"").split(/\s/).forEach(function(e){"uncompressed-pure-values"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedPureValues=!0),"uncompressed-structures"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedStructures=!0)}),(a.attr("options")||"").split(/\s/).forEach(function(e){e&&(Utils.options[e]=!0),"debug"===e&&DebugMode()}),a=(a=a.attr("startnode"))||[].reduce.call($("tw-passagedata"),function(e,t){t=t.getAttribute("pid");return t<e?t:e},1/0),a=$("tw-passagedata[pid='"+a+"']").attr("name"),$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),n=!1,$("[role=script]").each(function(t){try{__HarloweEval($(this).html())}catch(e){n||(n=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(t+1)+" script:\n\n"+printJSError(e)}))}}),$("[role=stylesheet]").each(function(e,t){$(document.head).append("<style data-title=\"Story stylesheet '".concat(e+1,"'\">").concat($(t).html()))}),(e=Section.create()).stack=[{tempVariables:Object.create(VarScope)}],(r=Passages.loadMetadata(e)).length&&(t=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"}),r.forEach(function(e){return t.find("p").append(e.render())})),(r=!Utils.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session"))&&!0===State.deserialise(e,r)?Engine.showPassage(State.passage):Engine.goToPassage(a))})}),define("macros",["utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/twineerror"],function(g,e,t,o,r,y,b,p,v){var w=e.insensitiveName,k=e.nth,S=e.andList,T=t.objectName,_=t.typeName,d=t.toSource,x=Array.isArray,i={};function O(e){return e===s.TypeSignature.Any||(x(e.innerType)?e.innerType.some(O):!!e.innerType&&O(e.innerType))}function a(e,t,n,r){var a,o,i,s,c,l,u,p,d=t.fn,f=t.typeSignature,h=t.returnType,m=(r=function(e){for(var t,n,r,a=[],o=0;o<e.length;o+=1)o in e&&(!0===(null==(t=e[o])?void 0:t.spreader)?(n=t.value,(r=v.containsError(n))?a.push(r):x(n)||"string"==typeof n?a.push.apply(a,_toConsumableArray(n)):n instanceof Set?a.push.apply(a,_toConsumableArray(Array.from(n).sort(g("en")))):a.push(v.create("operation","I can't spread out "+T(n)+", because it is not a string, dataset, or array."))):a.push(t));return a}(r),"string"!=typeof e&&(a=e,e=""),a?"":"("+(x(e)&&1<e.length?e[0]:e)+":)");for(e=a?a.TwineScript_KnownName?"the custom macro, ".concat(a.TwineScript_KnownName):"an unnamed custom macro":"the ".concat(m," macro"),o=0<f.length?1===f.length&&O(f[0])?1===r.length?"That value can't be given to macros as-is.":"Give only a single value to this macro.":e+" must only be given "+S(f.map(_))+(1<f.length?", in that order":"."):e+" must not be given any data."+(a?"":" Just write "+m),s=0,c=Math.max(r.length,f.length);s<c;s+=1){if(p=f[s],l=r[s],v.containsError(l))return l;if(s>=f.length&&!i)return v.create("datatype",r.length-f.length+" too many values were given to "+e+".",o);if(!(p=p||i).innerType||"rest"!==p.pattern&&"zero or more"!==p.pattern||(i=p.innerType,"rest"===p.pattern&&(p=p.innerType)),!function e(t,n){if(null===n)return void 0===t;var r=_typeof(t);if("function"!=typeof n&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern){for(var a=0;a<n.innerType.length;a+=1)if(e(t,n.innerType[a]))return!0;return!1}if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")===("where"in t||"each"in t)&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(w(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?"string"===r:n===Boolean?"boolean"===r:n===parseInt?"number"===r&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?"number"===r&&!Number.isNaN(t):n===Array?x(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))}(l,p))return void 0===l?(u=f.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length,v.create("datatype","".concat(e," was given ").concat(r.length?S(r.map(T)):"nothing",", but needs ").concat(u-s," more value").concat(1<u-s?"s":"","."),o)):null!=(u=l)&&u.TwineScript_Unstorable&&O(p)?v.create("datatype",e+"'s "+k(s+1)+" value, "+T(l)+", is not valid data for this macro.",o):b.isPrototypeOf(l)&&"Changer"===h?v.create("syntax","Please put this hook outside the parentheses of "+e+", not inside it.","Hooks should appear after a macro"+(a?".":": "+m+"[Some text]")):l&&y.isPrototypeOf(l)&&"lambda"===p.pattern?v.create("datatype",e+"'s "+k(s+1)+" value (a lambda) should have "+S(["where","when","making","via","with"].filter(function(e){return p.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+S(["where","when","making","via","with"].filter(function(e){return e in l}).map(function(e){return"a '"+e+"' clause"}))+"."):"insensitive set"===p.pattern?v.create("datatype",T(l)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+S(p.innerType)+"."):v.create("datatype","".concat(e,"'s ").concat(k(s+1)," value is ").concat(T(l),", but should be ").concat(_(p),"."),p.message||o)}return d.apply(null,[n].concat(r))}function f(e,t,n,r){var a={fn:n,typeSignature:r=[].concat(r||[]),returnType:t};Object.freeze(a),[].concat(e).forEach(function(e){return Object.defineProperty(i,w(e),{value:a})})}var s={has:function(e){return e=w(e),hasOwnProperty.call(i,e)},get:function(e){return e=w(e),hasOwnProperty.call(i,e)&&i[e]},add:function e(t,n,r,a){return f(t,n,r,a),e},addChanger:function e(t,n,r,a){return f(t,"Changer",n,a),o.register(x(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var s,c,l,u,o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=[].concat(t)[0];return f(t,"Command",(s=i,c=n,l=r,u=o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i=c.apply(void 0,n);return i||(a=p.create(),o=_objectSpread({TwineScript_TypeID:"command",TwineScript_ObjectName:"a (".concat(s,":) command"),TwineScript_TypeName:"a (".concat(s,":) command"),TwineScript_Print:function(){return"`[A (".concat(s,":) command]`")},TwineScript_ToSource:function(){return"(".concat(s,":").concat(n.map(d),")")},TwineScript_is:function(e){return d(this)===d(e)}},u?{TwineScript_Attach:function(e,t){return a.section=e,t.run(a),o},TwineScript_Run:function(e){e=l.apply(void 0,[a,e].concat(n));return a=p.create(),e}}:{TwineScript_Run:function(e){return l.apply(void 0,[e].concat(n))}}))}),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:t,max:n,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&t<=e&&e<=n}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&0<=e&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&1<=e&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t,n){return s.has(e)?a(e,s.get(e),t,n):v.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t,n){return r.isPrototypeOf(e)?a(e,e,t,n):v.containsError(e)?e:v.create("macrocall","I can't call ".concat(T(e)," because it isn't a custom macro."))}};return Object.assign(s.TypeSignature,{positiveNumber:s.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:s.TypeSignature.numberRange(0,1/0),percent:s.TypeSignature.numberRange(0,1)}),Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","internaltypes/twineerror"],function(t,s,e,c,l){var u=e.insensitiveName,p=e.unescape,n=e.onStartup,o=e.impossible,d=Object.assign,f=RegExp(c.Patterns.macroFront+c.Patterns.macroName,"ig");function r(e){var t,r,a,o,n=e.attr("name"),i=p(e.html()),s=(t=n,o=["metadata","storylet","exclusivity","urgency"],((s=i).match(f)||[]).some(function(t){return o.some(function(e){return u(t.slice(1,-1))===e})})?(r=!1,a={},c.lex(s,t).children.forEach(function e(t){if("macro"===t.type){var n=u(t.name);if(o.some(function(e){return n===e})){if(l.isPrototypeOf(a[n]))return;if(r)return void(a[n]=l.create("syntax","The (".concat(t.name,":) macro can't appear after non-metadata macros.")));if(a[n])return void(a[n]=l.create("syntax","There is more than one (".concat(t.name,":) macro.")));a[n]=t}else r=!0;t.children.forEach(function e(t){var n=u(t.name);"macro"===t.type&&o.some(function(e){return n===e})?a[n]=l.create("syntax","The (".concat(t.name,":) macro can't be inside another macro.")):t.children.forEach(e)})}else t.children.forEach(e)}),a):{});return d(new Map([["source",i],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",n]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:s,tree:null})}var a=Object.create(null),i=[],h=null,m=d(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(n){var e,r;return a[n]||(e=s("en",function(e){return e.get("name")}),r=[],this.forEach(function(e){var t=e instanceof Map&&e.get("tags");Array.isArray(t)&&t.includes(n)&&r.push(e)}),r.sort(e),a[n]=r)},clearTagCache:function(){a=Object.create(null)},clear:function(){Map.prototype.clear.call(this),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},delete:function(){var e;(e=Map.prototype.delete).call.apply(e,[this].concat(Array.prototype.slice.call(arguments))),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},getTree:function(e){if(!this.has(e))return o("Passages.getTree","No passage name?"),[];var t=this.get(e),n=t.get("tags");if(n.includes("header")||n.includes("footer")||n.includes("debug-header")||n.includes("debug-footer"))return t.tree||(t.tree=c.lex(t.get("source"),e)),t.tree;for(var r,a=0;a<i.length;a+=1)if(i[a]&&i[a].place===e)return r=i.splice(a,1)[0],i.unshift(r),r;n=c.lex(t.get("source"),e);return i.unshift(n),16<i.length&&i.pop(),n},clearTreeCache:function(){i=[]},getStorylets:function(r,e){var a,o,i,e=e?e.filter(r,_toConsumableArray(m.values())):_toConsumableArray(m.values());return l.containsError(e)?e:(a=[],o=-1/0,e.reduce(function(e,t){if(e)return e;e=t.get("storylet");if(e){var n=r.speculate(e,t.get("name"),"a (storylet:) macro");if(l.containsError(n))return n.message="There's an error in the storylet passage \""+t.get("name")+'":\n'+n.message,n.source=e.TwineScript_ToSource(),n;n&&(e=t.get("exclusivity"),o=Math.max(o,"number"==typeof e?e:0),a.push(t))}},void 0)||(i=s("en"),a.filter(function(e){e=e.get("exclusivity");return("number"==typeof e?e:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:i(e.get("name"),t.get("name"))})))},allStorylets:function(){return h=h||_toConsumableArray(m.values()).filter(function(e){return e.get("storylet")})},clearStoryletCache:function(){h=null},loadMetadata:function(i){var s=[];return m.forEach(function(o){o.metadata&&Object.keys(o.metadata).forEach(function(e){var t,n,r;function a(e,t){o.has(e)?s.push(l.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):o.set(e,t)}l.containsError(o.metadata[e])?s.push(o.metadata[e]):(t=o.metadata[e],n=i.speculate(t,o.get("name"),"a ("+e+":) macro"),r='In "'+o.get("name")+'":\n',l.containsError(n)?(n.message=r+n.message,n.source=t.text,s.push(n)):n instanceof Map?n.forEach(function(e,t){return a(t,e)}):a(e,n))}),o.metadata=void 0}),s},hasValid:function(e){e=this.get(e);return e&&e instanceof Map&&e.has("source")},create:r});return n(function(){t("tw-storydata > tw-passagedata").get().forEach(function(e){e=t(e),m.set(e.attr("name"),new r(e))})}),m}),define("renderer",["jquery","utils","markup","internaltypes/twineerror"],function(a,e,S,T){var _=e.escape,x=e.insensitiveName,O=e.options;function A(e,t,n){n=2<arguments.length&&void 0!==n?n:"";return"<"+t+(n?" "+n:"")+">"+e+"</"+t+">"}var C="text-align: center; max-width:50%; ";function E(m,g){function y(e,t,n){e=E(e.children,g);return e&&A(e,t,n)}var b="",v=[];if(m)for(var e,w=(m=Array.isArray(m)?m:[m]).length,k=0;k<w;k+=1)if(e=function(e){var n=m[e];switch(n.type){case"include":b+=y(n,"tw-"+n.type,'type="'.concat(n.tag,'" name="').concat(n.name,'"'));break;case"error":b+=T.create("syntax",n.message,n.explanation).render(_(n.text))[0].outerHTML;break;case"numbered":case"bulleted":for(var t="numbered"===n.type?"ol":"ul",r=(b+="<"+t+">",1);e<w&&m[e];){if("br"===m[e].type){if(b+="</li>",!m[e+1]||m[e+1].type!==n.type)break}else m[e].type===n.type?(b=(b+=("<"+t+">").repeat(Math.max(0,m[e].depth-r)))+("</"+t+">").repeat(Math.max(0,r-m[e].depth))+"<li>",r=m[e].depth):b+=E([m[e]],g);e+=1}b+=("</"+t+">").repeat(r+1);break;case"align":for(;n&&"align"===n.type;){var a=n.align,o=e+=1;if("left"===a){--e;break}for(;e<w&&m[e]&&"align"!==m[e].type;)e+=1;var o=E(m.slice(o,e),g),i="";switch(a){case"center":i+=C+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":i+="text-align: "+a+";";break;default:+a&&(i+=C+"margin-left: "+a+"%;")}b+="<tw-align "+(i?'style="'+i+'"':"")+">"+o+"</tw-align>\n",n=m[e]}break;case"column":for(var s,c=[];n&&"column"===n.type;){var l=n.column,u=e+=1;if("none"===l){--e;break}for(;e<w&&m[e]&&"column"!==m[e].type;)e+=1;c.push({text:n.text,type:l,body:E(m.slice(u,e),g),width:n.width,marginLeft:n.marginLeft,marginRight:n.marginRight}),n=m[e]}c.length&&(s=c.reduce(function(e,t){return e+t.width},0),b+="<tw-columns>"+c.map(function(e){return"<tw-column type=".concat(e.type," ",' style="width:').concat(e.width/s*100,"%; margin-left: ").concat(e.marginLeft,"em; margin-right: ").concat(e.marginRight,'em;">').concat(e.body,"</tw-column>\n")}).join("")+"</tw-columns>");break;case"heading":for(b+="<h"+n.depth+">";++e<w&&m[e];){if("br"===m[e].type){b+="</h"+n.depth+">";break}b+=E([m[e]],g)}break;case"br":if(!v.length||/td|th/.test(v[0])){b+="<br>";for(var p=m[e+1];p&&("br"===p.type||"tag"===p.type&&/^<br\b/i.test(p.text));)b+="<tw-consecutive-br"+("tag"===p.type?" data-raw":"")+"></tw-consecutive-br>",p=m[(e+=1)+1]}break;case"hr":b+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":b+='<a class="link" href="'+_(n.text)+'">'+n.text+"</a>";break;case"scriptStyleTag":case"tag":var d=n.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th|svg)\b/.test(d)&&!n.text.endsWith("/>")&&v[n.text.startsWith("</")?"shift":"unshift"](d),b+=n.text.startsWith("</")?n.text:n.text.replace(/(\/)?>$/,function(e,t){return" data-raw".concat(t?"></".concat(n.text.match(/[\w-]+/)):"",">")});break;case"sub":case"sup":case"strong":case"em":b+=y(n,n.type);break;case"strike":b+=y(n,"s");break;case"bold":b+=y(n,"b");break;case"italic":b+=y(n,"i");break;case"twineLink":d=_slicedToArray(S.lex("(link-goto:"+JSON.stringify(n.innerText)+","+JSON.stringify(n.passage)+")").children,1)[0];b+='<tw-expression type="macro" name="link-goto"'+(O.debug?' title="'+_(n.text)+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(d);break;case"hook":b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+(O.debug&&n.name?' title="Hook: ?'+n.name+'"':"")+' source="'+g.source.length+'"></tw-hook>',g.source.push(n.children);break;case"unclosedHook":return b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+'source="'+g.source.length+'"></tw-hook>',g.source.push(m.slice(e+1,w)),{v:b};case"verbatim":b+=A(_(n.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":b+=y(n,"tw-collapsed");break;case"unclosedCollapsed":return{v:b+="<tw-collapsed>"+E(m.slice(e+1,w),g)+"</tw-collapsed>"};case"variable":case"tempVariable":case"macro":var f=[],h=[];if("macro"===n.type&&!function e(t){"string"!==t.type&&"hook"!==t.type&&t.children.every(e);var n=x(t.name);if("macro"!==t.type||"prompt"!==n&&"confirm"!==n){if("hook"===t.type&&!t.everyLeaf(function(e){return"error"!==e.type||(h.push(e),!1)}))return!1}else f.push(t);return!0}(n),h.length)return{v:T.create("syntax","This code hook's markup contained "+h.length+" error"+(h.length?"s":"")+":<br>\u2014"+h.map(function(e){return e.message}).join("<br>\u2014")).render(_(n.text))[0].outerHTML};d=f.map(function(e){return e.blockerTree=g.blockers.length,g.blockers.push(e),e.blockerTree});b+='<tw-expression type="'+n.type+'" name="'+_(n.name||n.text)+'"'+(O.debug?' title="'+_(n.text)+'"':"")+(d.length?' blockers="'+d+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(n);break;default:b+=n.children&&n.children.length?E(n.children,g):n.text}k=e}(k))return e.v;return b}return Object.freeze({exec:function(e){var r={code:[],blockers:[],source:[]},e=E(e="string"==typeof e?S.lex(e).children:e,r),e=a(a.parseHTML(e,document,!0));return e.findAndFilter("script:not([src])").each(function(e,t){var n=t.getAttribute("type");n&&"text/javascript"!==n.toLowerCase()||t.setAttribute("type","application/x-harlowe")}),r.blockers=r.blockers.map(function(e){e.blockedValue=!0;e=Object.create(e);return e.blockedValue=!1,e}),e.findAndFilter("tw-expression[code]:not([data-raw]), tw-expression[blockers]:not([data-raw]), tw-hook[source]:not([data-raw])").each(function(e,t){var n;(t=a(t)).attr("blockers")&&(n=t.popAttr("blockers").split(",").map(function(e){return r.blockers[e]}),t.data("blockers",n)),t.attr("source")&&t.data("source",r.source[t.popAttr("source")]),t.attr("code")&&t.data("code",r.code[t.popAttr("code")])}),e}})}),define("repl",["utils","markup","section"],function(e,t,n){e.onStartup(function(){return setTimeout(function(){e.options.debug&&(window.REPL=function(e){e=n.create().eval(t.lex("(print:"+e+")"));return e.TwineScript_Run?e.TwineScript_Run().source:e},window.LEX=function(e){e=t.lex(e);return 1===e.length?e[0]:e})})})}),define("section",["jquery","utils","twinescript/runner","twinescript/operations","state","utils/operationutils","utils/renderutils","utils/scripttag","datatypes/changercommand","datatypes/colour","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(p,f,a,u,r,e,t,i,d,h,o,m,g,y,b,v){var w=e.printBuiltinValue,k=e.objectName,S=e.typeID,T=e.isObject,s=t.collapse,_=Object.assign,x=Object.create,O=Object.keys;function A(e,t,n){if(t&&"object"===_typeof(t)&&d.isPrototypeOf(t)){var r=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),a=(null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),n.data("originalSource",r),g.create({target:n,source:r,section:this,append:"append"})),o=t.run(a);if(b.containsError(o)&&e.replaceWith(o.render(e.attr("title"))),!this.renderInto(r,null,a))return o=f.insensitiveName(e.attr("name")),["if","elseif","unless","else","testfalse"].includes(o)&&(e.addClass("false"),"elseif"!==o)&&(this.stackTop.lastHookShown=!1),n.data("live")&&function(t,n,r){function a(e){p&&(d-=(e-p)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)),p=e,0<d?requestAnimationFrame(a):(d=s,o())}var o,i=this,e=r.data("live"),s=e.delay,c=e.event,l=((n=_objectSpread(_objectSpread({},n),{},{append:"replace",transitionDeferred:!1,enabled:!0})).data=_objectSpread(_objectSpread({},n.data),{},{live:void 0}),r.data("originalSource")||""),u=this.stackTop.tempVariables,p=null,d=s;o=this.whenUnblocked.bind(this,function(){var e;i.inDOM()&&(e=null==c?void 0:c.filter(i,[!0],u),b.containsError(e)?e.render(i,t.attr("title")).replaceAll(t):c&&!e[0]?requestAnimationFrame(a):(i.renderInto(l,r,n,u),e||r.find("tw-expression[name='stop']").length||i.inDOM()&&requestAnimationFrame(a)))}),requestAnimationFrame(a)}.call(this,e,a,n),!0}else{if(!1===t)return o=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),o&&(n.cachedData&&(n.cachedData.source=void 0),n.data("originalSource",o),n.data("hidden",!0)),e.addClass("false"),!(this.stackTop.lastHookShown=!1);if(!0!==t)return!1}return this.stackTop.lastHookShown=!0}function C(e){var t,n,e=(e instanceof p?e[0]:e).nextSibling;return e&&(e instanceof Text&&!e.textContent.trim()||["br","tw-consecutive-br"].includes((e.tagName||"").toLowerCase()))?(t=(n=C(e)).whitespace,n=n.nextElem,{whitespace:p(e).add(t),nextElem:n}):{whitespace:p(),nextElem:p(e)}}function E(e){if(null!=e&&e.length)return p("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)}function c(e,t){var n=this.eval(t);e.append(E(this.evalReplay)),e.append(function(e,t){if(/a \((go-to|undo|redirect|restart):\) command/.exec(null==t?void 0:t.TwineScript_TypeName))return p("<tw-open-button goto label='GO'>").data("goto",{section:e,command:t})}(this,n)),this.stackTop.evaluateOnly&&n&&(d.isPrototypeOf(n)||"function"==typeof n.TwineScript_Run)&&(n=b.create("syntax","I can't work out what ".concat(this.stackTop.evaluateOnly," should evaluate to, because it contains a ").concat(d.isPrototypeOf(n)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var r=p();for(i=e;d.isPrototypeOf(n);){var a=C(i),o=a.whitespace;if((i=a.nextElem)[0]&&i[0].nodeType===Node.TEXT_NODE&&"+"===i[0].textContent.trim()){var i,a=i,s=C(a),c=s.whitespace;if((i=s.nextElem).is("tw-expression")){var s=i.popData("code")||(null==(s=i[0])||null==(s=s.cachedData)?void 0:s.code),l=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(s));if(b.containsError(l)){n=l;break}s=u["+"](n,l);p(o).add(a).add(c).remove(),n=b.containsError(s)?b.create("operation","I can't combine "+k(n)+" with "+k(l)+".","function"==typeof l.TwineScript_Run?"If you want to attach this changer to ".concat(k(l),", remove the + between them."):"Changers can only be added to other changers."):s;continue}}if(i.is("tw-expression")){c=i.popData("code")||(null==(a=i[0])||null==(a=a.cachedData)?void 0:a.code),s=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(c));if(i.append(E(this.evalReplay)),b.containsError(s)){n=s;break}if(s&&"object"===_typeof(s)&&"function"==typeof s.TwineScript_Attach){n=s.TwineScript_Attach(this,n);break}return d.isPrototypeOf(s)?void e.replaceWith(b.create("operation","Changers like (".concat(n.macroName,":) need to be combined using + between them."),"Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(e.attr("title"))):void e.replaceWith(b.create("operation","".concat(k(s)," can't have changers like (").concat(n.macroName,":) attached."),"Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(e.attr("title")))}if(i.is("tw-hook")){o.remove(),r=i;break}n.macroName||f.impossible("Section.runExpression","changer has no macroName");a=e.attr("title")||"("+n.macroName+": ...)";return void e.replaceWith(b.create("syntax","The (".concat(n.macroName,":) changer should be stored in a variable or attached to a hook."),"Macros like this should appear before a hook: ".concat(a,"[Some text]")).render(e.attr("title")))}e.attr("return",S(n)),r=r.length?r:C(e).nextElem.filter("tw-hook"),(t=b.containsError(n))?e.replaceWith(t.render(e.attr("title")).append(E(this.evalReplay))):v.isPrototypeOf(n)?e.append(n.render()):n&&"function"==typeof n.TwineScript_Run?(n=n.TwineScript_Run(this),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):g.isPrototypeOf(n)?null!=(t=n.data)&&t.live?e.replaceWith(b.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(e.attr("title"))):(n.section=this,n.target=i,this.renderInto("",i,n)):T(n)&&n.blocked?(this.stackTop.blocked=n.blocked,e.data("code",{type:"macro",blockedValue:!0,text:e.attr("title")||"",start:0,end:(e.attr("title")||"").length})):n&&f.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor ".concat(_typeof(n),': "').concat(n,'"'))):r.length&&A.call(this,e,n,r)||("string"==typeof n||"number"==typeof n||n instanceof Map||n instanceof Set||Array.isArray(n)||h.isPrototypeOf(n)||m.isPrototypeOf(n)||n&&"function"==typeof n.TwineScript_Print&&!d.isPrototypeOf(n)?(n=w(n),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):"string"==typeof n||Array.isArray(n)?this.renderInto(n,e):f.impossible("printBuiltinValue() produced a non-string non-array ".concat(_typeof(n)))):d.isPrototypeOf(n)||"boolean"==typeof n||f.impossible("Section.runExpression","The expression evaluated to an unknown value: ".concat(n)))}var l={add:[],remove:[]};return Object.preventExtensions({create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f.storyElement,n=_(x(this),{timestamp:Date.now(),dom:e,stack:[],enchantments:[],unblockCallbacks:[],freeVariables:null,evalReplay:null,loadedGame:!1,Identifiers:{TwineScript_Identifiers:!0,it:0,get time(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'time' can't be used in ".concat(n.stackTop.evaluateOnly,".")):(Date.now()-n.timestamp)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)},get turns(){return r.turns},get turn(){return r.turns},get visits(){var t=n.stackTop.speculativePassage;return r.history().filter(function(e){return e===(t||r.passage)}).length+(!t||t===r.passage)},get visit(){return n.Identifiers.visits},get exits(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'exit' and 'exits' can't be used in ".concat(n.stackTop.evaluateOnly,".")):n.dom.find("tw-enchantment, tw-link").filter(function(e,t){return(t=p(t)).data("enchantmentEvent")||t.parent().data("linkPassageName")||t.parent().data("clickEvent")}).length},get exit(){return n.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:b.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}}});return n},eval:function(t){var e,n;f.options.debug&&f.options.evalReplay&&(n=Array.isArray(t)?t.reduce(function(e,t){return e+t.text},""):t.text||"",this.evalReplay=[{code:n,fromCode:n,basis:(Array.isArray(t)?t[0]:t).start,start:0,end:n.length,diff:0}]);try{e=a(this,t)}catch(e){return null!=(n=window.console)&&n.error(e),this.evalReplay=null,b.create("","An internal error occurred while trying to run ".concat([].concat(t).map(function(e){return e.text}).join(""),"."),'The error was "'.concat(e.message,'".\nIf this is the latest version of Harlowe, please consider reporting a bug (see the documentation).'))}return this.evalReplay&&2===this.evalReplay.length&&this.evalReplay.shift(),e},get stackTop(){return this.stack[0]},inDOM:function(){return 0<f.storyElement.find(this.dom).length},evaluateTwineMarkup:function(e,t){var n=p("<p>");return this.stack.unshift({desc:g.create({target:n,source:e,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:t,finalIter:!0}),this.execute(),0<(e=n.find("tw-error")).length?e:n},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:_(x(y),{TwineScript_VariableStore:{type:"temp",name:n}}),speculativePassage:t});var r,n=this.evalReplay;return this.evalReplay=null,o.isPrototypeOf(e)?r=e.apply(this,{fail:!1,pass:!0}):e&&(r=a(this,e)),this.stack.shift(),this.evalReplay=n,r},renderInto:function(e,a,t){var o=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=g.create({target:a,source:e,section:this,append:"append"});if(t)if(d.isPrototypeOf(t)){var e=t.run(i);if(b.containsError(e))return e.render(a.attr("title")).replaceAll(a),!1}else _(i,t);if((a=i.target,50<=this.stack.length)&&50<=this.stack.reduce(function(e,t){return e+!!t.finalIter},0))return b.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(a.attr("title")).replaceAll(a),!1;var s=function(e,t,n){var r=a instanceof p&&a.is("tw-hook")&&0<a.parents("tw-collapsed,[collapsing=true]").length;o.stack.unshift({desc:e,finalIter:n,tempVariables:t,collapses:r,evaluateOnly:o.stackTop&&o.stackTop.evaluateOnly})},r=r||x(this.stack.length?this.stackTop.tempVariables:y),t=(hasOwnProperty.call(r,"TwineScript_VariableStore")||(t=null==(e=a)?void 0:e.tag(),r.TwineScript_VariableStore={type:"temp",name:"tw-hook"===t?a.attr("name")?"?"+a.attr("name"):"an unnamed hook":"tw-expression"===t?"a "+a.attr("type")+" expression":"tw-passage"===t?"this passage":"an unknown scope"}),null==(e=this.stackTop)?void 0:e.blocked);if(O(i.loopVars).length){var c=_objectSpread({},i.loopVars),l=Math.min.apply(Math,_toConsumableArray(O(c).map(function(e){return c[e].length})));if(v.create(l+" loop"+(1!==l?"s":"")).render().prependTo(a),l){for(var n=l-1;0<=n;--n)!function(n){s(i,O(c).reduce(function(e,t){return e[t]=c[t][n],e},x(r),n===l-1))}(n);for(var u=l-1;0<=u&&!this.stackTop.blocked;--u)this.execute()}}else s(i,r,!0),this.execute();return(0===this.stack.length||!t&&null!=(e=this.stackTop)&&e.blocked)&&this.updateEnchantments(),i.enabled},execute:function(){var a=this,e=this.stackTop,t=e.desc,n=e.dom,r=e.collapses,o=e.evaluateOnly;t&&!n&&(n=t.render(),this.stackTop.dom=n,this.stackTop.desc=void 0),n.findAndFilter('tw-hook,tw-expression,script[type="application/x-harlowe"]').each(function(e,t){var n=p(t).data();t.cachedData={blockers:n.blockers,code:n.code,source:n.source}}).each(function(e,t){if(a.stackTop.blocked)return!1;var n=t.cachedData;switch(n&&(t.cachedData=void 0),(t=p(t)).tag()){case"tw-hook":var r=t.popData("source")||(null==n?void 0:n.source);(r&&t.data("originalSource",r),t.data("tempVariables",a.stackTop.tempVariables),t.popAttr("hidden"))?t.data("hidden",!0):r&&a.renderInto(r,t);break;case"tw-expression":var r=t.data("blockers")||(null==n?void 0:n.blockers);if(r){if(o)return void t.removeData("blockers").removeData("code").replaceWith(b.create("syntax","I can't use a macro like (prompt:) or (confirm:) in ".concat(o,"."),"Please rewrite this without putting such macros here.").render(t.attr("title"),t));if(r.length)return a.stackTop.blocked=!0,r=a.eval(r.shift()),b.containsError(r)&&(a.stackTop.blocked=!1,t.removeData("blockers").replaceWith(r.render(t.attr("title"),t))),!1;t.removeData("blockers")}r=t.popData("code")||(null==n?void 0:n.code);r&&c.call(a,t,r);break;case"script":if(f.reattachStoryElement(),t.text())try{i(t.text(),a.stackTop.tempVariables)}catch(e){b.isPrototypeOf(e)?t.replaceWith(e.render(t.text(),t)):(null!=(r=window.console)&&r.error(e),t.replaceWith(b.create("","A Javascript error occurred while running this <script> element.",'The error was "'.concat(e,'". Check the browser console for more details.')).render(t.text(),t)))}}}),this.stackTop.blocked||(n.length&&r&&s(n),n.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){s(p(this))}),setTimeout(function(){return n.find("input, textarea").first().focus()},100),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return l[e].push(t),this},addEnchantment:function(t){var n=this;this.enchantments.push(t),l.add.forEach(function(e){return e(n,t)})},removeEnchantment:function(t){var n=this,e=this.enchantments.indexOf(t);this.enchantments.splice(e,1),t.disenchant(),l.remove.forEach(function(e){return e(n,t)})},unblock:function(e){for(this.stack.length||f.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;0<this.unblockCallbacks.length;){var t;if(this.unblockCallbacks.shift()(),null!=(t=this.stackTop)&&t.blocked)return}},whenUnblocked:function(e,t){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):(t||e)()},blockedValue:function(){var e=this.stackTop;return e?e.blockedValues&&e.blockedValues.length?e.blockedValues.shift():(f.impossible("Section.blockedValue","blockedValues is missing or empty"),0):(f.impossible("Section.blockedValue","stack is empty"),0)}})}),define("state",["jquery","utils","passages","datatypes/customcommand","utils/operationutils","markup"],function(n,y,b,v,e,t){var i,w,C=e.toSource,E=e.is,k=t.lex,o=Object.assign,h=Object.create,e=Object.defineProperty,N=Array.isArray,s=Math.imul,t=(e(Map.prototype,"toJSON",{value:void 0}),e(Set.prototype,"toJSON",{value:void 0}),["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}));function S(e,t){var n=0<arguments.length&&void 0!==e?e:String.fromCodePoint(Date.now()%1114112),e=1<arguments.length&&void 0!==t?t:0;i.seedIter=e,i.seed=n;for(var r,a=0,o=2166136261;a<n.length;a+=1)r=s(n.charCodeAt(a),3432918353),o^=s(r<<15|r>>>17,461845907),o=s(o=o<<13|o>>>19,5)+3864292196|0;return o^=n.length,o=s(o^=o>>>16,2246822507),o=s(o^=o>>>13,3266489909),o=((o^=o>>>16)>>>0)+1831565813*e,function(){i.seedIter+=1;var e=o+=1831565813,e=s(e^e>>>15,1|e);return(((e^=e+s(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}function r(e,t){for(var n,r=t.variables,a=h(null),o=e.length-1;0<=o;--o){for(var i,s,c=e[o],l=0,u=["mockVisits","mockTurns","seed","seedIter"];l<u.length;l++){var p=u[l];hasOwnProperty.call(c,p)&&!hasOwnProperty.call(t,p)&&(t[p]=c[p])}for(i in c.forgetVisits&&(t.forgetVisits=Math.max(t.forgetVisits||0,c.forgetVisits)),void 0!==c.turns&&(t.turns=(t.turns||0)+c.turns),t.pastVisits||(t.pastVisits=[]),o!==e.length-1&&(void 0!==e[o+1].visits&&Array.isArray(t.pastVisits[0])?t.pastVisits[0]:t.pastVisits).unshift(c.passage),void 0!==c.pastVisits&&t.pastVisits.unshift(c.pastVisits),void 0!==c.visits&&t.pastVisits.unshift(c.visits),c.variables)if("TwineScript_TypeDefs"===i)for(var d in r[i]||(r[i]=h(null)),c.variables[i])r[i][d]||(r[i][d]=c.variables[i][d]);else i.startsWith("TwineScript_")||i in r||(null===c.variables[i]&&(a[i]=!0),a[i])||(r[i]=c.variables[i],!(s=c.valueRefs[i]))||"via"in s||t.valueRefs[i]||(t.valueRefs[i]=s)}for(n in t.valueRefs){var f=t.valueRefs[n];f&&"via"in f&&delete t.valueRefs[n]}}var a,c={passage:"",variables:h(null),visits:void 0,turns:void 0,seed:void 0,seedIter:void 0,mockVisits:void 0,mockTurns:void 0,forgetVisits:void 0,create:function(e){var t=h(c);return t.passage=e||"",t.variables=h(null),t.valueRefs=h(null),t}},l={forward:[],back:[],load:[],beforeForward:[],beforeBack:[],beforeLoad:[],forgetUndos:[]},u=[],p=-1,d=c.create(),f="";function m(){i.history=i.pastVisits.slice(i.forgetVisits).reduce(function(e,t){return e.concat(t)},[]),i.mockVisits&&(i.history=i.mockVisits.concat(i.history))}function g(){var e=c.create();e.pastVisits=[],o(e.variables,{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:h(null),TwineScript_VariableStore:{type:"global",name:"this story's variables"},TwineScript_Delete:function(e){delete this[e],d.variables[e]=null,delete d.valueRefs[e]},TwineScript_Set:function(e,t,n){if(this[e]=t,d.variables[e]=t,n)d.valueRefs[e]=n;else if((N(t)||t instanceof Map||t instanceof Set||"string"==typeof t)&&!y.options.uncompressedStructures)for(var r=p;0<=r;--r){var a=u[r].variables[e];if(void 0!==a){a=function e(t,n,r){var a="it"===r?"its":r+"'s",o="";if(N(n)&&N(t)&&n.length){for(var i=n.length===t.length,o="(a:",s=0;s<n.length;s+=1){var c,l,u,p=n[s];E(p,t[s])?(c=C(p),l="".concat(a," ").concat(s+1,"th"),o+=(c.length<l.length?c:l)+","):(i=!1,-1<(c=t.indexOf(p))?(l=C(p),u="".concat(a," ").concat(c+1,"th"),o+=(l.length<u.length?l:u)+","):o+=e(t[s],p,"".concat(a," ").concat(s+1,"th"))+",")}o=i?r:o.slice(0,-1)+")"}else if(n instanceof Map&&t instanceof Map&&n.size){var d,f=n.size===t.size,h=(o="(dm:",_createForOfIteratorHelper(n.entries()));try{for(h.s();!(d=h.n()).done;){var m,g,y=_slicedToArray(d.value,2),b=y[0],v=y[1];o+="".concat(C(b),","),E(v,t.get(b))?(m=C(v),g="".concat(a," (").concat(C(b),")"),o+=(m.length<g.length?m:g)+","):(f=!1,o+=e(t.get(b),v,"".concat(a," (").concat(C(b),")"))+",")}}catch(e){h.e(e)}finally{h.f()}o=f?r:o.slice(0,-1)+")"}else if(n instanceof Set&&t instanceof Set&&n.size){var w,k=new Set,S=new Set,T=_createForOfIteratorHelper(t);try{for(T.s();!(w=T.n()).done;){var _=w.value;n.has(_)||k.add(_)}}catch(e){T.e(e)}finally{T.f()}var x,O=_createForOfIteratorHelper(n);try{for(O.s();!(x=O.n()).done;){var A=x.value;t.has(A)||S.add(A)}}catch(e){O.e(e)}finally{O.f()}k.size||S.size||(o=r),o=k.size+S.size>n.size?C(n):r+(S.size?"+"+C(S):"")+(k.size?"-"+C(k):"")}else"string"==typeof n&&"string"==typeof t&&n&&(n.startsWith(t)?o=r+"+"+C(n.slice(t.length)):n.endsWith(t)&&(o=C(n.slice(0,n.length-t.length))+"+"+r));return o?"it"===r?{via:o}:o:"it"===r?void 0:C(n)}(a,t,"it");a&&("it"===a.via?delete d.variables[e]:d.valueRefs[e]=a);break}}},TwineScript_GetProperty:function(e){return this[e]},TwineScript_DefineType:function(e,t){this.TwineScript_TypeDefs[e]=t,hasOwnProperty.call(d.variables,"TwineScript_TypeDefs")||(d.variables.TwineScript_TypeDefs=h(null)),d.variables.TwineScript_TypeDefs[e]=t}}),r(u.slice(0,p+1),e),i=e,m(),w=S(e.seed,e.seedIter)}function T(e){d=c.create(e);e=a.serialise(!0),f=e.past,e=e.pastAndPresent;if(a.hasSessionStorage&&"string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){}}function _(e,t,n,r){for(var a in r)if(hasOwnProperty.call(r,a)&&!a.startsWith("TwineScript_"))if("object"===_typeof(r[a]))if(hasOwnProperty.call(r[a],"at")){n.valueRefs[a]=r[a];var o=r[a],i=o.at,s=o.from,c=o.to,l=o.hash,u=o.seed,p=o.seedIter,o=o.blockedValues;if(!b.has(i))throw Error('The data refers to a passage named `"'.concat(n.passage,"\"`, but it isn't in this story."));var d=b.get(i).get("source"),f=d.slice(s,c);if(void 0!==l)for(var h=0,m=c-s;y.hash(f).toString(16)!==l;){if(h+m>=d.length)throw Error("The value (or type) of the variable `$".concat(a,"` couldn't be found in the passage `\"").concat(i,'"`.'));(h+=1)===s&&(h+=1),f=d.slice(h,h+m)}c=k(f,"","macro");void 0!==u&&void 0!==p&&(w=S(u,p)),void 0!==o&&(e.stackTop.blockedValues=o,c.forEach(function e(t){var n;"string"!==t.type&&"hook"!==t.type&&t.children.every(e),"macro"!==t.type||"prompt"!==(n=y.insensitiveName(t.name))&&"confirm"!==n||(t.blockedValue=!0)})),r[a]=e.eval(c)}else if(hasOwnProperty.call(r[a],"via")){for(var g=t.length-1;0<=g;--g)if(hasOwnProperty.call(t[g].variables,a)){e.Identifiers.it=t[g].variables[a];break}r[a]=e.eval(k(r[a].via,"","macro")),e.Identifiers.it=0}else hasOwnProperty.call(r[a],"changer")&&(r[a].changer=e.eval(k(r[a].changer,"","macro")),r[a].hook=e.eval(k(r[a].hook,"","macro")),_(e,t,n,r[a].variables),r[a]=v.create(r[a]));else r[a]=e.eval(k(r[a],"","macro"));else"TwineScript_MockVisits"===a&&(n.mockVisits=r[a])}return g(),d.seed=i.seed,d.seedIter=0,(a={get passage(){return d.passage},get variables(){return i.variables},get pastLength(){return p},get turns(){return p+1+(i.turns||0)+(i.mockTurns||0)},get futureLength(){return u.length-1-p},get mockVisits(){return i.mockVisits||[]},set mockVisits(e){i.mockVisits=e,d.mockVisits=e,m()},get mockTurns(){return i.mockTurns||0},set mockTurns(e){i.mockTurns=e,d.mockTurns=e},history:function(){return i.history},forgetUndos:function(e){e<0&&(e=u.length+e);var t,e=u.splice(0,Math.min(u.length-1,e));e.length&&(p=u.length-1,t=u[0],r(e,t),t.pastVisits.push(e[e.length-1].passage),t.turns=(t.turns||0)+e.length,i.turns=(i.turns||0)+e.length,t.forgetVisits&&(t.pastVisits=t.pastVisits.slice(t.forgetVisits-t.turns),t.forgetVisits-=t.turns),f="",0===p&&n("tw-link[undo], tw-icon[alt='Undo']",y.storyElement).each(function(e,t){(n(t).closest("tw-expression, tw-hook").data("forgetUndosEvent")||Object)(t)}),l.forgetUndos.forEach(function(e){return e()}))},forgetVisits:function(e){(e=e<0?u.length+e:e)>p+i.turns&&(e=p+i.turns),d.forgetVisits=i.forgetVisits=Math.max(i.forgetVisits||0,e),m()},passageNameVisited:function(e){var t=0;if(!b.get(e))return 0;for(var n=0;n<i.history.length;n++)t+=+(e===i.history[n]);return t},get timeline(){return u},play:function(t){var e;d||y.impossible("State.play","present is undefined!"),l.beforeForward.forEach(function(e){return e()}),d.passage&&((null!=(e=d.visits)&&e.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1]:i.pastVisits).push(d.passage),i.history.push(d.passage)),d.passage=t,u=u.slice(0,p+1).concat(d),p+=1,T(t),l.forward.forEach(function(e){return e(t)})},redirect:function(e){var t;d||y.impossible("State.redirect","present is undefined!"),d.passage&&(null!=(t=d.visits)&&t.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1].push(d.passage):i.pastVisits.push([d.passage]),i.history.push(d.passage)),d.visits=(d.visits||[]).concat(e),d.passage=e},rewind:function(e){for(var t=void 0!==e?e:1,n=!1;0<t&&0<p;t--)n=!0,--p;return n&&(l.beforeBack.forEach(function(e){return e()}),f="",T(u[p].passage),g(),l.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);0<t&&0<u.length;t--)n=!0,p+=1;return n&&(l.beforeForward.forEach(function(e){return e()}),T(u[p].passage),g(),l.forward.forEach(function(e){return e(u[p].passage,"fastForward")})),n},on:function(e,t){if(e in l)return"function"!=typeof t||l[e].includes(t)||l[e].push(t),a;y.impossible("State.on","invalid event name")},reset:function(){l.beforeLoad.forEach(function(e){return e()}),u=[],p=-1,g(),(d=c.create()).seed=i.seed,d.seedIter=0,f="",w=S(),l.load.forEach(function(e){return e(u)})},hasStorage:t[0],hasSessionStorage:t[1],setSeed:function(e){w=S(e),d.seed=i.seed,d.seedIter=0},get seed(){return i.seed},get seedIter(){return i.seedIter},random:function(){var e=w();return d.seedIter=i.seedIter,e},shuffled:function(){for(var a=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t,n){var r=a.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[]);return d.seedIter=i.seedIter,r}}).serialise=function(e){function o(e,t){if("TwineScript_TypeDefs"===t){var n,r={};for(n in e[t])r[n]=C(e[t][n]);return r}var a;return null===e[t]?null:e[t]&&hasOwnProperty.call(e[t],"TwineScript_CustomCommand")?(a=e[t].TwineScript_CustomCommand(),{changer:C(a.changer),toSource:a.toSource,hook:C(a.hook),variables:Object.keys(a.variables).reduce(function(e,t){return e[t]=o(a.variables,t),e},{})}):C(e[t])}function t(e,t){if(c.isPrototypeOf(t)&&void 0===t.visits&&void 0===t.turns&&void 0===t.mockVisits&&void 0===t.forgetVisits&&void 0===t.pastVisits&&void 0===t.mockTurns&&void 0===t.seed&&void 0===t.seedIter&&Object.keys(t.variables).every(function(e){return e.startsWith("TwineScript_")}))return t.passage;if(!c.isPrototypeOf(this)||"valueRefs"!==e){if(c.isPrototypeOf(this)&&"variables"===e){var n,r={};for(n in this.variables)this.valueRefs[n]?r[n]=this.valueRefs[n]:r[n]=o(this.variables,n);return r}return t}}var e=u.slice(f?e?p-1:p:0,p+1),n=e.slice(0,-1),r=f;try{return{past:r=n.length?(r?r.slice(0,-1)+",":"[")+JSON.stringify(n,t).slice(1):r,pastAndPresent:r.slice(0,-1)+(r?",":"[")+JSON.stringify(e.slice(-1),t).slice(1)}}catch(e){return{past:!1,pastAndPresent:!1}}},a.deserialise=function(e,t){var n;try{n=JSON.parse(t)}catch(e){return Error("The save data is unintelligible.")}if(!N(n))return Error("The save data isn't a sequence of past turns.");for(var r=0;r<n.length;r+=1){var a=n[r];if("string"==typeof a)a={passage:a,variables:{}};else if("object"!==_typeof(a)||!hasOwnProperty.call(a,"variables")){n.splice(r--,1);continue}if(a.valueRefs=h(null),a.variables=o(h(null),a.variables),!b.hasValid(a.passage))return Error('The data refers to a passage named `"'.concat(a.passage,"\"`, but it isn't in this story."));if(hasOwnProperty.call(a.variables,"TwineScript_TypeDefs"))try{_(e,n.slice(0,r),a,a.variables.TwineScript_TypeDefs)}catch(e){return Error("The variable types on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}try{_(e,n.slice(0,r),a,a.variables)}catch(e){return Error("The variables on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}n[r]=o(h(c),a)}return p=(u=n).length-1,l.load.forEach(function(e){return e(u)}),f="",g(),T(u[p].passage),!0},Object.seal(c),Object.freeze(a)}),define("utils",["jquery","markup","utils/polyfills"],function(d){var r=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),a="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),f=["audio"],e=_slicedToArray([function(e){return r(e)!==r(e).toLowerCase()},function(e){return r(e)!==r(e).toUpperCase()},function(e){return r(e).toLowerCase()!==r(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,t,n){return e===n[t-1]+1&&e===n[t+1]-1?"-":r(e)}).join("").replace(/-+/g,"-")+"]"}),3),t=e[0],o=e[1],e=e[2];function s(e){return"instant"===e?0:800}var i,c,l=[],u={},p=0,h={},m=0,g={};function y(n,r,e,a,o){var i=null,s=0,c=r+e;function l(e){var t;1&n[0].compareDocumentPosition(document)&&(c=0),i&&(c-=t=e-i),i=e,0<a&&0<p+m&&n.data("expediteAnim")(a),c<=r&&(s+=t||0,"paused"===n.css("animation-play-state"))&&n.css({visibility:"","animation-play-state":"running"}),c<=0?(n.removeData("expediteAnim"),o()):requestAnimationFrame(l)}n.data("expediteAnim",function(e){var t;c-=e=void 0===e?s:e,"running"===n.css("animation-play-state")&&n.css("animation-delay",(("ms"===(t=(t=n.css("animation-delay")).toLowerCase()).slice(-2)?+t.slice(0,-2)||0:"s"===t.slice(-1)&&1e3*+t.slice(0,-1)||0)||0)-e+"ms")}),c?requestAnimationFrame(l):l()}d(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,e=e.type.includes("down"),r=t?u:h,n=t&&v.insensitiveName(t)||n;r[n]&&!e?t?p=Math.max(p-1,0):m=Math.max(m-1,0):!r[n]&&e&&(t?p+=1:m+=1),r[n]=e}).on("mousemove",function(e){var t=e.pageX,e=e.pageY;g.x=t,g.y=e});var b=/-|_/g,v={hash:function(e){for(var t=9,n=e.length;0<n;)--n,t=Math.imul(t^e.charCodeAt(n),Math.pow(9,9));return(t^t>>>9)>>>0},permutations:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r,a,o=t.length,i=[[].concat(t)],s=Array(o).fill(0),c=1;c<o;)s[c]<c?(r=c%2&&s[c],a=t[c],t[c]=t[r],t[r]=a,++s[c],c=1,i.push([].concat(t))):(s[c]=0,++c);return i},nth:function(e){var t=+e+"";return e+("1"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"2"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"3"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"th":"rd":"nd":"st")},plural:function(e,t,n){return e+" "+(1!==Math.abs(e)?n||t+"s":t)},andList:function(e){return e.length<=1?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:t,anyLowercase:o,anyCasedLetter:e,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(b,"")},allKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return u[e]})},someKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return u[e]})},buttonsDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return h[e]})},anyInputDown:function(){return 0<p+m},mouseCoords:g,parentColours:function(e){for(var t,n={colour:null,backgroundColour:null},r=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent())if(n.backgroundColour||(t=e.css("background-color")).match(r)||(n.backgroundColour=t),n.colour||(t=e.css("color")).match(r)||(n.colour=t),n.colour&&n.backgroundColour)return n;return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){if(!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))){if(n.includes(e.tagName.toLowerCase())||/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style")))return!1;a.includes(e.tagName.toLowerCase())||t.push(e)}return!0})&&t.every(function(e){return/inline|none/.test(window.getComputedStyle(e).display)})},transitionOut:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||s(t),!(1<e.length)&&v.childrenProbablyInline(e)&&["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(e.tag())||(e=e.wrapAll("<tw-transition-container>").parent()),i&&e.css("transform-origin",i),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":"".concat(n,"ms"),"animation-delay":"".concat(-o,"ms"),"animation-play-state":"paused"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),y(e,n,r-o,a,function(){e.remove()}))},transitionIn:function(u,e,t){var p,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==u.length&&(t=t||s(e),(p=1<u.length||!v.childrenProbablyInline(u)||!["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(u.tag()))&&(u=u.wrapAll("<tw-transition-container>").parent()),o&&u.css("transform-origin",o),u.attr("data-t8n",e).addClass("transition-in").css(_objectSpread({"animation-duration":"".concat(t,"ms"),"animation-delay":"".concat(-a,"ms")},n-a?{visibility:"hidden","animation-play-state":"paused"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(u)?u.css("display","inline"):u.parent().is("tw-backdrop,tw-story")||u[0].setAttribute("style",u[0].getAttribute("style")+"display:block !important;width:100%")}),y(u,t,n-a,r,function(){var e=0===u.filter(f.join(",")).length;if(p&&e){u.find("tw-transition-container, .transition-in, .transition-out").each(function(e,t){((t=d(t)).data("expediteAnim")||Object)()});for(var t=[],n=u.find("*"),r=0;r<n.length;r+=1){var a=n[r];0===a.scrollTop&&0===a.scrollLeft||t.push([a,a.scrollLeft,a.scrollTop])}e=u.find(document.activeElement);u.contents().unwrap();for(var o=0,i=t;o<i.length;o++){var s=_slicedToArray(i[o],3),c=s[0],l=s[1],s=s[2];c.scrollLeft=l,c.scrollTop=s}e.length&&e[0].focus()}else u.removeClass("transition-in").removeAttr("data-t8n")}))},debounce:function(e){function t(){300<Date.now()-l||s<=u?(u=n=0,p=!i,o?(e(c),c=[]):e.apply(void 0,_toConsumableArray(c)),p=!1):n=requestAnimationFrame(t)}var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=r.batch,o=void 0!==a&&a,a=r.recur,i=void 0!==a&&a,a=r.maxWait,s=void 0===a?1/0:a,c=[],l=0,u=0,p=!1;return function(){var e;p||(e=Date.now(),u+=e-l,l=e,o?c.push(arguments):c=arguments,n&&cancelAnimationFrame(n),n=requestAnimationFrame(t))}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},onStartup:function(e){l?l.push(e):e()},get storyElement(){return i},detachStoryElement:function(){document.documentElement.contains(i[0])&&(c=i.parent(),i.detach())},reattachStoryElement:function(){document.documentElement.contains(i[0])||(c||d(document.body)).append(i.parents().length?i.parents().last():i)},options:{speedMultiplier:1}};return d(function(){i=d("tw-story"),l.forEach(function(e){return e()}),l=null}),Object.freeze(v)}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,y,b,v,w){var k=e.objectName,S=e.matches,t=e.toSource;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ObjectName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ToSource:function(){return"into"===this.operator?"".concat(t(this.src)," ").concat(this.operator," ").concat(t(this.dest)):"".concat(t(this.dest)," ").concat(this.operator," ").concat(t(this.src))},TwineScript_Unstorable:!0,set:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=[],r=function e(t,n,r){var a=!(2<arguments.length&&void 0!==r)||r,o=[],i=n&&v.isPrototypeOf(n)?n.get():n;if(w.containsError(i))return i;if(Array.isArray(i)&&Array.isArray(t)){for(var s=0,c=0;s<t.length&&c<i.length;){var l=t[s],u=i[c];if(y.isPrototypeOf(l)&&l.datatype.rest||b.isPrototypeOf(l)&&l.rest){for(var p=c;c<i.length&&S(l,u);)u=i[c+=1];y.isPrototypeOf(l)?l.datatype=[l.datatype]:b.isPrototypeOf(l)&&(l=b.create("array")),o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,{first:p+1,last:c+1}):i.slice(p,c)))}else o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,c+1):u)),c+=1;s+=1}return s<t.length?a&&w.create("operation","I can't unpack this array because it needs ".concat(t.length-s," more value").concat(0<t.length-s?"s":"",".")):o}if(t instanceof Map&&i instanceof Map){var d,f=_createForOfIteratorHelper(t.entries());try{for(f.s();!(d=f.n()).done;){var h=_slicedToArray(d.value,2),m=h[0],g=h[1];if(!i.has(m))return a&&w.create("operation","I can't unpack this datamap because it needs a '"+m+"' data name.");o=o.concat(e(g,v.isPrototypeOf(n)?v.create(n,m):i.get(m)))}}catch(e){f.e(e)}finally{f.f()}return o}if(y.isPrototypeOf(t)){if("function"==typeof t.datatype.destructure)return[{dest:t,value:i,src:n}].concat(t.datatype.destructure(i));if(!S(i,t.datatype))return a&&w.create("operation","I can't put ".concat(k(i)," into ").concat(t.varRef.TwineScript_ToSource()," because it doesn't match ").concat(t.varRef.TwineScript_ToSource(),"'s datatype, ").concat(k(t.datatype),"."));o=o.concat(e(t.datatype,i))}return v.isPrototypeOf(t)||y.isPrototypeOf(t)?o.concat({dest:t,value:i,src:n}):"function"==typeof t.destructure?o.concat(t.destructure(i)):S(i,t)?o:a&&w.create("operation","I tried to unpack, but "+k(t)+" in the pattern didn't match "+k(i)+".")}(this.dest,this.src);if(e=w.containsError(r))return e;if(!r.length)return w.create("operation","I can't store a new value inside "+k(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var a,o=_createForOfIteratorHelper(r.reverse());try{for(o.s();!(a=o.n()).done;){var i=a.value,s=i.dest,c=i.value,l=i.src;if(y.isPrototypeOf(s)){if(e=w.containsError(s.defineType()))return e;s=s.varRef}if(e=s.set(c,this.srcRef),w.isPrototypeOf(e))return e;t&&l&&l.delete(),n.shift(k(s)+" is now "+k(c))}}catch(e){o.e(e)}finally{o.f()}return n.join("; ")},create:function(e,t,n,r){return w.containsError(e)?e:w.containsError(t)?t:Object.assign(Object.create(this),{dest:e,src:t,operator:n,srcRef:r})}})}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var i=e.plural,a=e.impossible,o=t.is,s=t.toSource,c={},l={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(s))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},get TwineScript_ObjectName(){1===this.params.length&&36<(e=s(this.params[0])).length&&(e=void 0);for(var e,t="a (".concat(this.macroName,":").concat(e||"",") changer"),n=this.next,r=(n&&(t+=" combined with "),0);n&&t.length<48;){var a="(".concat(n.macroName,":)");t+=(0<r&&!n.next?" and ":"")+a+(n.next?", ":""),n=n.next,r+=1}for(var o=0;n&&o<99;)n=n.next,o+=1;return 0<o&&(t+="".concat(0<r?" and ":"").concat(i(o,"other changer"))),t},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,canEnchant:r})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t.canEnchant=this.canEnchant&&e.canEnchant,t},TwineScript_is:function(e){if(l.isPrototypeOf(e))return this.macroName===e.macroName&&o(this.params,e.params)&&o(this.next,e.next)},TwineScript_Clone:function(){for(var e=l.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e.canEnchant=this.canEnchant,e},run:function(e,t){var n="output"===this.macroName?[t||this]:this.params,n=c[this.macroName].apply(c,[e].concat(_toConsumableArray(n)));if(r.containsError(n))return n;this.next&&this.next.run(e,t||this)},register:function(e,t){c[e]=t}};return Object.freeze(l)}),define("datatypes/codehook",[],function(){var t=Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_ToSource:function(){return this.source},TwineScript_Print:function(){return this.code},TwineScript_toString:function(){return this.source},TwineScript_is:function(e){return t.isPrototypeOf(e)&&this.source===e.source},TwineScript_Clone:function(){return t.create(this.code,this.source)},create:function(e,t){return Object.assign(Object.create(this),{code:e,source:t})}});return t}),define("datatypes/colour",["jquery"],function(c){var l=Math.max,u=Math.min,a=Math.sin,o=Math.cos,i=Math.pow,p=Math.round,d=Math.floor,s=Math.atan2,f=Math.cbrt,h=Math.sqrt,m=Math.PI,g=Object.assign,y=Object.create,b=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,t=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function w(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(0<r.length)return w.apply(void 0,[w(e,t)].concat(r));if(!t)return e;for(var o=[],i=0;i<e.length;i++){o[i]=[];for(var s=0;s<t[0].length;s++){for(var c=0,l=0;l<e[0].length;l++)c+=e[i][l]*t[l][s];o[i][s]=c}}return o}function n(e){var t,n=e.r,r=e.g,a=e.b,e=e.a,o=l(n/=255,r/=255,a/=255),i=u(n,r,a),s=(o+i)/2,c=o-i;if(o===i)return{h:0,s:0,l:s};switch(o){case n:t=(r-a)/c+(r<a?6:0);break;case r:t=(a-n)/c+2;break;case a:t=(n-r)/c+4}return{h:t=p(60*t),s:.5<s?c/(2-o-i):c/(o+i),l:s,a:e}}var k=[.9642956764295677,1,.8251046025104602],S=24389/27,T=216/24389,_=function(e){return e.map(function(e){return[e]})},x=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,n=e.c,r=e.h,e=e.a,n=[t*=100,n*o(r*m/180),n*a(r*m/180)],r=[];r[1]=(n[0]+16)/116,r[0]=n[1]/500+r[1],r[2]=r[1]-n[2]/200;n=[i(r[0],3)>T?i(r[0],3):(116*r[0]-16)/S,S*T<t?i((16+t)/116,3):t/S,i(r[2],3)>T?i(r[2],3):(116*r[2]-16)/S].map(function(e,t){return e*k[t]}),t=_slicedToArray(x(w([[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],w([[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],_(n)))).map(function(e){return u(255,l(0,255*(.0031308<(e=e)?1.055*i(e,1/2.4)-.055:12.92*e)))}),3);return{r:t[0],g:t[1],b:t[2],a:e}}function e(e){function t(e){return 1e-5<=n[e]&&n[e]<=255-1e-5}var n=O(e);if(Object.keys(n).every(t))return n;var r=(e=_objectSpread({},e)).c,a=0;for(e.c/=2;1e-5<r-a;)n=O(e),Object.keys(n).every(t)?a=e.c:r=e.c,e.c=(r+a)/2;return O(e)}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),e=e.toRGBA();return A.create({r:u(p(.6*(t.r+e.r)),255),g:u(p(.6*(t.g+e.g)),255),b:u(p(.6*(t.b+e.b)),255),a:(t.a+e.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){var t;return!!A.isPrototypeOf(e)&&(e.lcha&&this.lcha?e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a:(t=this.toRGBA(),(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a))},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA(),t=e.r,n=e.g,r=e.b,e=e.a;return"rgba(".concat(t,", ").concat(n,", ").concat(r,", ").concat(e,")")},toHSLA:function(){return n(this.toRGBA())},toRGBA:function(){return this.lch?e(_objectSpread({a:this.a},this.lch)):this},toLCHA:function(){return this.lch?_objectSpread({a:this.a},this.lch):(t=(e=this).r,n=e.g,r=e.b,e=e.a,n=[116*(t=x(w([[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],w([[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],_([t/255,n/255,r/255].map(function(e){return e<.04045?e/12.92:i((e+.055)/1.055,2.4)}))))).map(function(e,t){return e/k[t]}).map(function(e){return T<e?f(e):(S*e+16)/116}))[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])],r=180*s(n[2],n[1])/m,{l:n[0]/100,c:h(i(n[1],2)+i(n[2],2)),h:0<=r?r:360+r,a:e});var e,t,n,r},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,A.create(t)},TwineScript_GetProperty:function(e){var t;return"lch"===e?(t=this.toLCHA(),new Map([["l",t.l],["c",t.c],["h",t.h]])):(t=this.toRGBA(),"h"===e||"s"===e||"l"===e?n(t)[e]:"r"===e||"g"===e||"b"===e||"a"===e?t[e]:void 0)},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){if(0===this.a)return"transparent";var e=!this.lch&&n(this);if(1===e.l&&!e.h&&!e.s)return"white";if(0===e.l&&!e.h&&!e.s)return"black";if(.5<=e.l&&e.l<.5334&&0===e.s)return"gray";if(.5===e.l&&.8<=e.s&&e.s<.804){var t={0:"red",30:"orange",60:"yellow",90:"lime",120:"green",180:"cyan",210:"blue",240:"navy",270:"purple",300:"magenta"}[e.h];if(t)return t}return"(".concat(this.lch?"lch":"hsl",":").concat(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l]).concat(1!==this.a?","+this.a:"",")")},create:function(e){var t,n,r,a,o,i;return"string"==typeof e?this.create((A.isHexString(e)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(b,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(e){var t;return e in v?v[e]:(t="transparent"===(t=c("<p>").css("background-color",e).css("background-color"))?{r:0,g:0,b:0,a:0}:t.startsWith("rgb")?t.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[e]=t)})(e)):!("h"in e&&"s"in e&&"l"in e)||"r"in e||"g"in e||"b"in e?("a"in e&&"number"==typeof e.a||(e.a=1),"h"in e&&"c"in e&&!("s"in e)&&"l"in e?g(y(this),{a:e.a,lch:{l:e.l,c:e.c,h:e.h}}):g(y(this),e)):this.create((a=(t=e).h,o=e.s,i=e.l,t=e.a,0===o?{r:e=d(255*i),g:e,b:e}:(r=2*i-(n=i<.5?i*(1+o):i+o-i*o),{r:d(255*s((a/=360)+1/3)),g:d(255*s(a)),b:d(255*s(a-1/3)),a:t})));function s(e){return e<0&&(e+=1),1<e&&--e,e<1/6?r+6*(n-r)*e:e<.5?n:e<2/3?r+(n-r)*(2/3-e)*6:r}},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(b)||e.slice(1).match(t))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+(?:\.\d+)?\s*,\s*\d+(?:\.\d+)?%?\s*,\s*\d+(?:\.\d+)?%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/customcommand",["internaltypes/changedescriptor","internaltypes/twineerror"],function(l,u){var p=Object.assign,d=Object.create;return Object.seal({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},create:function(e){var t,n=e.toSource,r=e.changer,a=e.hook,o=e.variables,i={};for(t in o)i[t]=[o[t]];var s,c=l.create({source:a,loopVars:i},r);return u.containsError(c)?c:s=p(d(this),{TwineScript_Attach:function(e,t){c.section=e;e=t.run(c);return u.containsError(e)?e:s},TwineScript_Run:function(e){c.section=e;e=c;return c=l.create({source:a,loopVars:i},r),e},TwineScript_ToSource:function(){return n},TwineScript_CustomCommand:function(){return e}})}})}),define("datatypes/custommacro",["jquery","utils","renderer","utils/operationutils","datatypes/customcommand","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(w,e,k,t,S,T,_,x,O){function n(v){return function(e){v.called+=1;for(var t=v.varNames,n=v.params,r=v.body,a=E(N(_),{TwineScript_VariableStore:{type:"temp",name:v.TwineScript_ObjectName+" call #"+v.called},TwineScript_TypeDefs:N(null)}),o=[],i=0,s=!1,c=arguments.length,l=new Array(1<c?c-1:0),u=1;u<c;u++)l[u-1]=arguments[u];for(var p=0;p<l.length;p+=1){var d=l[p],f=t[i],h=(a.TwineScript_TypeDefs[f]=n[i].datatype.rest?n[i].datatype.create("array"):n[i].datatype,T.create(a,f));if(x.containsError(h))return h;if(n[i].datatype.rest){var s=!0,m=(a[f]||[]).concat([d]);if(p<l.length-1){a[f]=m;continue}h.set(m)}else h.set(d),i+=1;o.push(O.create(A(h)+" is now "+A(a[f])))}if(!s&&null!=(g=n[i])&&g.datatype.rest){var g=T.create(a,t[i]);if(x.containsError(g))return g;g.set([]),a.TwineScript_TypeDefs[name]=n[i].datatype.create("array")}var y,g=w("<p>").append(k.exec(r.code)),b=e.stack.length,r=(e.stack.unshift({tempVariables:a,dom:g,output:function(e){y=e}}),e.evalReplay);for(e.evalReplay=null,e.execute();e.stack.length>b;)e.stack.shift();e.evalReplay=r;r=g.find("tw-error");return r.length?(g.prepend(o.map(function(e){return e.render()}),"<br>"),x.create("propagated","".concat(r.length," error").concat(1<r.length?"s":""," occurred when running ").concat(v.TwineScript_ObjectName,"."),void 0,g)):void 0===y?x.create("custommacro","".concat(v.TwineScript_ObjectName," didn't output any data or hooks using (output:) or (output-data:).")):"object"===_typeof(y)&&"changer"in y?S.create(E(y,{toSource:"(".concat(v.TwineScript_KnownName||"unnamed",":").concat(l.map(C),")")})):y}}var r=e.andList,A=t.objectName,a=t.typeName,o=t.matches,C=t.toSource,E=Object.assign,N=Object.create,i=Object.seal({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",TwineScript_GetProperty:function(e){if("params"===e)return _toConsumableArray(this.params)},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){var e=E(N(i),this);return e.fn=n(e),e},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},createFromFn:function(e,t,n,r){return E(N(i),{params:[],fn:e,typeSignature:r,TwineScript_ObjectName:t,TwineScript_ToSource:n,TwineScript_KnownName:""})},create:function(e,t){t=E(N(i),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(t){var e=t.datatype.toTypeSignatureObject?t.datatype.toTypeSignatureObject({rest:t.rest}):{pattern:"range",range:function(e){return o(t.datatype,e)},name:a(t.datatype)};return t.rest?{pattern:"zero or more",innerType:e}:e}),body:t,TwineScript_KnownName:"",TwineScript_ObjectName:"a custom macro (with ".concat(e.length?r(e.map(C)):"no params",")")});return t.fn=n(t),t}});return i}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","datatypes/codehook","internaltypes/twineerror"],function(e,t,n,r,a,o,i,s,c){var l=e.realWhitespace,u=e.anyRealLetter,p=e.anyCasedLetter,d=e.anyNewline,f=t.objectName,e=Object.seal,h=Object.keys,m=Math.floor,g=Math.abs,y={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return y.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,e={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:e}:e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":"newline"===e?"linebreak":e,Object.create(this));return n.name=e,n.rest=t,n},from:function(t){var e=h(b).find(function(e){return b[e](t)});return e?y.create(e):c.create("datatype",f(t)+" doesn't correspond to a datatype value.")}},b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return y.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return o.isPrototypeOf(e)},macro:function(e){return i.isPrototypeOf(e)},codehook:function(e){return s.isPrototypeOf(e)},command:function(e){return e&&"command"===e.TwineScript_TypeID},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=_objectSpread(_objectSpread({},b),{},{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e||e.length)},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+d+"$")},any:function(){return!0},const:function(){return!0}});return e(y)}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var r=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,t){var n=e.colour,e=e.stop;return r.stops[t].stop===e&&r.stops[t].colour.TwineScript_is(n)})},TwineScript_Clone:function(){return n.create(this.angle,_toConsumableArray(this.stops))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(t){return n.create(this.angle,this.stops.map(function(e){return{colour:e.colour,stop:e.stop*t}}))},toLinearGradientString:function(){var r=this;return(this.repeating?"repeating-":"")+"linear-gradient(".concat(this.angle,"deg, ").concat(this.stops.reduce(function(e,t){var n=t.colour,t=t.stop;return e+n.toRGBAString()+" "+t*(r.repeating?1:100)+(r.repeating?"px,":"%,")},"").slice(0,-1),")")}});return n}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(g,s,e,t){var y=e.textNodeToChars,b=e.realWhitespace,c=e.findTextInNodes,r=t.toSource;function l(e){function t(n,e){if(Array.isArray(e))return e.reduce(function(e,t){return e.add(n.get(t))},g());if(e&&"object"===_typeof(e)&&"first"in e&&"last"in e){for(var t=e.first,r=e.last,a=n.length,o=(t<0&&(t+=a),r<0&&(r+=a),[n.get(t)]);t!==r;)t+=Math.sign(r-t),o.push(n.get(t));return g(o)}if("string"==typeof e){if("chars"===e){var i,s=[],c=_createForOfIteratorHelper(n.textNodes(m));try{for(c.s();!(i=c.n()).done;){var l,u=i.value,p=_createForOfIteratorHelper(y(u));try{for(p.s();!(l=p.n()).done;){var d=l.value;d.textContent.match(b)||s.push(d)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){c.e(e)}finally{c.f()}return g(s)}if("links"===e)return n.findAndFilter("tw-link, .enchantment-link");if("visited"===e)return n.findAndFilter("tw-link.visited");var f,h;if("lines"===e)return f=n.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),h=[[]],n.contents().each(function e(t,n){var r=(n.tagName||"").toLowerCase();if("tw-sidebar"!==r)if("tw-passage"===r||"tw-transition-container"===r)g(n).contents().each(e);else{if(f.length){if(n===f[0])return f.shift(),void h.push([]);if(16&n.compareDocumentPosition(f[0]))return h.push([]),g(n).contents().each(e),void h.push([])}h[h.length-1].push(n)}}),g(h.map(function(e){return!!e.length&&g(e).wrapAll("<tw-pseudo-hook>").parent()[0]}).filter(Boolean))}return g(n.get(e))}var n,r,a=e.dom,m=":not(tw-error, tw-error *)",o=g();this.next&&(o=o.add(l.call(this.next,e)));if(this.selector){if("string"===this.selector.type)i=this.selector.data,n=c((n=a).textNodes(),i),r=g(),n.forEach(function(e){r=r.add(g(e).wrapAll("<tw-pseudo-hook>").parent())}),i=r;else{if("base"===this.selector.type)return o.add(t(l.call(this.selector.data,e),this.property));n=this.selector.data,e='tw-hook[name="'+(n=s.insensitiveName(n).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+n+'"]';var e=e+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[n]||"",i=a.findAndFilter(e).add(a.parentsUntil(s.storyElement.parent())).filter(e)}o=this.property?o.add(t(i,this.property)):o.add(i)}return o=o.get().reduce(function(e,t){return t=g(t),e.add(t.is("tw-enchantment")&&t.contents().length<=1?t.contents():t)},g())}function a(e){var t,n;return e?(t=e.selector,n=e.property,e=e.next,[JSON.stringify(["base"===t.type?a(t.data):s.insensitiveName(t.data),n])].concat(_toConsumableArray(a(e))).sort()):[]}var o=Object.freeze({forEach:function(e,n){var t=l.call(this,e).each(function(e,t){return n(g(t),e)});return e.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),t},hooks:function(e){return l.call(this,e)},get TwineScript_ObjectName(){return"the hook name ".concat(this.TwineScript_ToSource())},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",t=this.selector,n=t.type,t=t.data;return"name"===n?t.match(RegExp("^"+s.anyRealLetter+"+$"))?e+="?"+t:e+="(hooks-named:"+JSON.stringify(t)+")":"string"===n?e+=JSON.stringify(t):"base"===n&&(e+=t.TwineScript_ToSource()+"'s "+r(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return a(this)+""==a(e)+""},TwineScript_GetProperty:function(e){return o.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return o.create(this.selector,this.property,this.next)},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||o),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return o.isPrototypeOf(e)||"string"==typeof e||s.impossible("HookSet.from() was given a non-HookSet non-string."),o.isPrototypeOf(e)?e:o.create({type:"string",data:e})}});return o}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,h,s,m){var g=e.objectName;var c=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("each"in this?"each ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:c,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(c),this)},create:function(e,t,n,r){var a,o="temp variable, or typed temp variable";function i(e){e=e&&e.varRef?e.varRef:e;return void 0===e||e&&s.isPrototypeOf(e)&&h.isPrototypeOf(e.object)&&1===e.propertyChain.length}if(m.containsError(n))return n;if("making"===t&&!i(n))return m.create("syntax","I need a "+o+", to the right of '"+t+"', not "+g(n)+".");if(m.containsError(e))return e;if(c.isPrototypeOf(e)){if("when"===t||"when"in e)return m.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+t+"'.");if(t in e)return m.create("syntax","This lambda has two '"+t+"' clauses.");a=e}else{if("when"===t&&void 0!==e)return m.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!i(e))return m.create("syntax","This lambda needs to start with a single "+o+", not "+g(e)+".");(a=Object.create(this)).loop=e||""}return a.source=r.trim(),a[t]=n,a.making&&a.making.getName()===(a.loop&&a.loop.getName())?m.create("syntax","This lambda has two variables named '"+a.loop.getName()+"'.","Lambdas should have all-unique parameter names."):a},apply:function(e,t){var n=t.loop,r=t.pos,a=t.making,o=t.ignoreVia;function i(e,t){if(e){var n,r;if("datatype"in e&&"varRef"in e)return n=e.varRef.create(s,e.varRef.propertyChain),m.containsError(n)?n:(r=n.defineType(e.datatype),m.containsError(r)||(r=n.set(t),m.containsError(r))?r:void 0);s[e.getName()]=t}}var s=(s=t.tempVariables)||Object.create(e.stack.length?e.stackTop.tempVariables:h),t=i(this.loop,n)||i(this.making,a);if(m.containsError(t))return t;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:s,lambdaPos:this.when?void 0:r})),!n||this.making||this.when?e.Identifiers.it=m.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName):e.Identifiers.it=n;var c,l,u,p,d,t=!o&&this.via,o="where"in this||"when"in this,f=e.evalReplay;return e.evalReplay=f?[]:null,o?(c=e.eval(this.where||this.when),l=e.evalReplay,e.evalReplay=l&&t?[]:null,!n||this.making||this.when||(e.Identifiers.it=n),u=c,p=!t||e.eval(t),d=null,u=m.containsError(u)||("boolean"!=typeof u?m.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+g(u)+"."):u?p:d)):c=u=!t||e.eval(t),p=t?e.evalReplay:null,e.stack.shift(),(e.evalReplay=f)&&(o||t)&&(((d=f[f.length-1])||{}).lambda&&d.lambda.obj===this||((d={lambda:{obj:this,loops:[]},code:(f[f.length-1]||{}).code||""}).fromCode=d.code,f.push(d)),d.lambda.loops.push(_objectSpread(_objectSpread(_objectSpread({it:n,pos:r},void 0!==a&&{making:a}),t&&{viaReplay:p,viaResult:u}),o&&{whereReplay:l,whereResult:null!==c&&c}))),u},filter:function(r,e){var a,o=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e.reduce(function(e,t,n){return a||(n=o.apply(r,{loop:t,pos:n+1,ignoreVia:!0,tempVariables:i}),a=m.containsError(n))||e.concat(n?[t]:[])},[])}});return c}),define("datatypes/typedvar",["utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,a,o){var i=e.typeName,t=e.matches,n=e.toSource,s=e.unstorableValue,e=Object.freeze,c=Object.assign,l=Object.create,u=e({TwineScript_TypeName:"a TypedVar (typed variable name)",get TwineScript_ObjectName(){var e=n(this.datatype);return"the ".concat(e.length<24?e+"-":"","typed variable name, ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return c(l(u),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return n(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return t(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n,r;return(n=o.containsError(t)||o.containsError(e)||t.error)||(a.isPrototypeOf(t)?(n=t.object,r=t.compiledPropertyChain,n&&n.TwineScript_VariableStore&&1===r.length&&n.TwineScript_TypeDefs?(r=s(e))&&!u.isPrototypeOf(r)?o.create("syntax","The -type syntax can't have "+i(r)+" to its left."):c(l(this),{datatype:e,varRef:t}):o.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.")):o.create("syntax","The -type syntax must have a variable to its right."))}});return u}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(o,e,t,n,r){var a=t.objectName;return n.on("set",function(r,a){r.TwineScript_VariableStore&&e.storyElement.find("[data-2bind]").each(function(e,t){var n=(t=o(t)).data("twoWayBindEvent");"function"==typeof n&&n(t,r,a)})}),Object.freeze({TwineScript_TypeName:"a VarBind (bound variable name)",get TwineScript_ObjectName(){return"a ".concat(this.bind," bind to ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A bound variable name]`"},TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var e=this.varRef.set(e);if(e=r.containsError(e))return e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"one way";return r.containsError(e)?e:n.isPrototypeOf(e)?e.error||Object.assign(Object.create(this),{varRef:e,bind:t}):r.create("operation","I can only 'bind' a variable, not "+a(e)+".")}})}),define("debugmode/highlight",["jquery","utils","utils/typecolours","macros","lexer"],function(u,e,t,p,n){var d=e.insensitiveName,f=t.versionClass,h=n.lex;return function(e,t,n,r){if(9999<e.length)return[u("<span>").text(e)];for(var a=h(e,"",t||"macro"),o=[],i="",s=a,c=a.start;c<a.end;c+=1){var l=a.pathAt(c);l[0]!==s[0]&&(o.length&&(o[o.length-1].textContent=i),i="",s=l,o.push(u("<".concat(r&&n<=c&&c<r?"mark":"span",' class="').concat(function(e){for(var t={},n="",r=0;r<e.length;r+=1){var a=e[r],o=a.type,i=a.text,s=("verbatim"!==o&&"comment"!==o||(n=""),f+o);switch(t[s]=(t[s]||0)+1,1<t[s]&&(s+="-"+t[s]),o){case"text":i.trim()&&e.slice(r+1).reduce(function(e,t){return void 0===e?"macro"===t.type||"hook"!==t.type&&e:e},void 0)&&(s+=" ".concat(f,"error"));break;case"macroName":var c,l=e[r].text[0];"_"!==l&&"$"!==l?(c=d(e[r].text.slice(0,-1)),p.has(c)?s+="-"+p.get(c).returnType.toLowerCase():s+=" ".concat(f,"error")):s+=" ".concat(f,"customMacro ").concat(f+("_"===l?"tempV":"v"),"ariable")}n+=s+" "}return n}(s),'">'))[0])),i+=a.text[c-a.start]}return o.length&&(o[o.length-1].textContent=i),o}}),define("debugmode/mode",["jquery","utils","utils/naturalsort","state","engine","internaltypes/varref","internaltypes/twineerror","utils/operationutils","utils/renderutils","passages","section","debugmode/panel","debugmode/highlight","utils/typecolours"],function(I,V,M,D,F,L,H,e,t,z,q,W,B,n){var U=e.objectName,$=e.isObject,G=e.toSource,Y=e.typeID,J=t.dialog,X=n.CSS,K=function(e,t){var f=V.escape,i=V.nth,n=V.debounce,r=I(document.documentElement),a=M(),o={darkMode:!0,fadePanel:!0,evalReplay:!0,width:null,maxHeight:400};if(D.hasStorage)try{var s=localStorage.getItem("(Debug Options "+V.options.ifid+")");s&&(o=JSON.parse(s))}catch(e){}function c(){if(D.hasStorage)try{localStorage.setItem("(Debug Options "+V.options.ifid+")",JSON.stringify(o))}catch(e){}}W.defaultMaxHeight=o.maxHeight;function l(e){return n(function(){if(V.options.debug)return e.apply(this,arguments)},{maxWait:2e3})}var h=I('<tw-debugger class="'.concat([o.darkMode?"theme-dark":"",o.fadePanel?"fade-panel":""].join(" "),'" style="').concat(o.width?"width:"+o.width+"px":"","\">\n<div class='panel panel-errors' hidden><table></table></div>\n<div class='tabs'></div>\n<label style='user-select:none'>Turns: </label><select class='turns' disabled></select>\n<button class='show-invisibles'>\ud83d\udd0d Debug View</button>\n<button class='show-dom'><span style=\"vertical-align:text-top\">&lt;</span><span style=\"vertical-align:text-bottom\">&gt;</span> DOM View</button>\n<button class='close'>\u2716</button>\n<div class='resizer-h'>\n</tw-debugger>")),s=h.find(".tabs"),u=h.find(".show-dom"),p=h.find(".show-invisibles"),d=h.find(".close"),m=h.find(".turns");I(document.documentElement).on("click","tw-expression, tw-error, tw-eval-explanation",n(function(e){var r,a,o,i,l,u,p,d,t=I(e.target).data("evalReplay");function n(){var e,s,c=r[a],t=o.find("tw-eval-explanation").empty(),n=o.find("tw-eval-code");c.toCode||c.toDesc||c.error||c.lambda?(o.find("tw-eval-code").empty().append(B(c.code,"macro",0<a&&c.start,0<a&&c.end+c.diff)),t.append(c.lambda?"":"<code class='".concat(56<c.fromCode.length?"from-block":"from-inline","'></code>"),c.error?"<span> caused an error: </span>":c.lambda?"<span>The lambda <code class='to-lambda'></code> was run, producing these results.</span>":"<span> became".concat(c.ToDesc?"\u2026":""," </span>").concat(c.toDesc?"<span class='to-desc'>".concat(f(c.toDesc),".</span>"):"<code class='to-code'></code>")),c.error?t.append(c.error):c.lambda?(s=function(e,t){return I("<".concat(e,"><code></").concat(e,">")).find("code").append(B(t,"macro")).end()},t.find(".to-lambda").append(B(c.lambda.obj.source,"macro")).end().append((e=I("<table>")).append.apply(e,[I("<tr>").append(s("th","pos"),c.lambda.obj.loop?s("th","_"+c.lambda.obj.loop.getName()).append(" / ",I("<code>").append(B("it","macro"))):s("th","it"),c.lambda.obj.making&&s("th","_"+c.lambda.obj.making.getName()),c.lambda.obj.where&&s("th","where").append(" result"),c.lambda.obj.via&&s("th","via").append(" result"))].concat(_toConsumableArray(c.lambda.loops.map(function(e){var t=e.it,n=e.pos,r=e.making,a=e.whereResult,o=e.whereReplay,i=e.viaResult,e=e.viaReplay;return I("<tr>").append(s("td",G(n)),s("td",G(t)),void 0!==r&&s("td",G(r)),null!=a&&(H.containsError(a)?I("<td>").append(a.render(c.lambda.obj.source,!0)):s("td",G(a))).append(o&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",o)),null!=i&&(H.containsError(i)?I("<td>").append(i.render(c.lambda.obj.source,!0)):s("td",G(i))).append(e&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)))})))))):c.toDesc||t.find(".to-code").append(B(c.toCode,"macro")),t.next().html(c.itIdentifier?'(The <code class="cm-harlowe-3-identifier">it</code> identifier now refers to '.concat(f(c.itIdentifier),".)"):"").next().text(c.reason||"")):(n.html(B(c.code,"macro")),t.html("<center>First, there was <code></code>.</center>").next().empty().next().empty()),c.lambda||t.find("code").first().append(B(c.fromCode,"macro")),o.find("mark").each(function(e,t){t.scrollIntoView()}),i.css("visibility",a<=9?"hidden":"visible"),l.css("visibility",a<=0?"hidden":"visible"),p.css("visibility",a>=r.length-1?"hidden":"visible"),d.css("visibility",a>=r.length-10?"hidden":"visible"),u.html("( ".concat(a+1,"/").concat(r.length," )"))}t&&(r=t,t=J({buttons:[{name:"Understood",confirm:!(a=0),callback:function(){return!h.find("tw-backdrop").length&&h.removeClass("show-dialog")}}]}).addClass("eval-replay"),o=I("<tw-eval-replay>".concat(1===r.length?"":"<tw-eval-code></tw-eval-code>","<tw-eval-explanation></tw-eval-explanation><tw-eval-it></tw-eval-it><tw-eval-reason></tw-eval-reason>").concat(1===r.length?"":"<tw-dialog-links><tw-link style='visibility:hidden'>\u2190 10</tw-link><tw-link style='visibility:hidden'>\u2190 \u2190</tw-link><b></b><tw-link>\u2192 \u2192</tw-link><tw-link>10 \u2192</tw-link></tw-dialog-links>","</tw-eval-replay>")),t.find("tw-dialog").css({width:"75vw","max-width":"75vw"}).prepend(o),i=o.find("tw-link:first-of-type"),l=i.next(),u=l.next(),p=u.next(),d=p.next(),n(),i.on("click",function(){a=Math.max(0,a-10),n()}),l.on("click",function(){a=Math.max(0,a-1),n()}),p.on("click",function(){a=Math.min(r.length-1,a+1),n()}),d.on("click",function(){a=Math.min(r.length-1,a+10),n()}),h.find("tw-backdrop").length?h.find("tw-backdrop").before(t):h.addClass("show-dialog").append(t));var s,t=I(e.target).data("goto");t&&(s=V.options.ignoreGotos,V.options.ignoreGotos=!1,t.command.TwineScript_Run(t.section),V.options.ignoreGotos=s),e.stopPropagation()})),h.find(".resizer-h").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=h.width();r.on("mousemove.debugger-resizer-h",function(e){e=e.pageX;h.width("".concat(n+t-e|0,"px"))}).on("mouseup.debugger-resizer-h",function(){r.off(".debugger-resizer-h"),o.width=h.width(),c()})}),h.on("mousedown",".resizer-v",function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageY,n=I(e.target.parentNode).height();r.on("mousemove.debugger-resizer-v",function(e){e=e.pageY;h.find(".panel").css("maxHeight","".concat(n+t-(0|e),"px"))}).on("mouseup.debugger-resizer-v",function(){r.off(".debugger-resizer-v"),o.maxHeight=h.find(".panel").css("maxHeight"),c()})}),p.click(function(){r.toggleClass("debug-mode").removeClass("dom-debug-mode"),p.toggleClass("enabled"),u.removeClass("enabled")}),u.click(function(){r.toggleClass("dom-debug-mode").removeClass("debug-mode"),u.toggleClass("enabled"),p.removeClass("enabled")}),d.click(function(){r.removeClass("debug-mode dom-debug-mode"),h.detach(),Object.assign(V.options,{debug:!1,speedMultiplier:1,ignoreClickEvents:!1,ignoreGotos:!1})});function g(e){(e=e.parents(".variable-row, .enchantment-row, .source-row")).next(".panel-row-source").find("td").empty().append(B(e.data("value")||G(e.data("enchantment").changer),e.is("source-row")?"markup":"macro"))}function y(){return k=new Set}function b(){I(document.body).append(h),V.options.debug=!0,V.options.evalReplay=o.evalReplay,V.options.speedMultiplier=1,V.options.ignoreClickEvents=!1,V.options.ignoreGotos=!1,R()}var v,w=l(function(){var r=m.children().get(),e=D.timeline,a=0;e.forEach(function(e,t){var n=e.turns,e=e.passage,n=(a+=1+(void 0===n?0:n))+": "+e;r[t]?r[t].textContent=n:m.append("<option value='".concat(t,"'>").concat(n,"</option>"))}),e.length<r.length&&I(r.slice(e.length)).remove(),m[1<=e.length?"removeAttr":"attr"]("disabled"),m.val(D.pastLength)}),k=(m.change(function(e){e=e.target.value-D.pastLength;0!=e&&(D[e<0?"rewind":"fastForward"](Math.abs(e)),F.showPassage(D.passage))}),w(),D.on("forward",w).on("load",w).on("forgetUndos",function(){return w}).on("back",function(){D.pastLength<=1&&m.attr("disabled"),m.find("[selected]").removeAttr("selected"),m.val(D.pastLength)}),new Set),S=W.create({className:"variables",tabName:"Variable",rowWrite:function(e,t){var n,r=e.name,a=e.dataset,o=e.path,i=e.value,s=e.tempScope,e=e.type,c=i&&48<i.length&&!i.TwineScript_DebugName,l=$(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():f(U(i)),u="",a=(o.length&&(u=o.reduce(function(e,t){return e+t+"'s "},"")),a&&(r="???"),e?G(e):""),e="object"===_typeof(i)||c;return t?(t[0].firstChild.innerHTML=a||"",u&&I(t[0].firstChild).children(".variable-path").html((s?"_":"$")+f(u)),t[0].childNodes[1].lastChild.textContent=(u?"":s?"_":"$")+f(r+""),t[0].childNodes[2].textContent=s||"",t[0].childNodes[3].innerHTML=l,n=(c=I(t[0].lastChild.firstChild)).is(".open"),c[e?"show":"hide"](),c=t.next(".panel-row-source"),n&&c.find("td").empty().append(B(G(i))),t.data("value",G(i)),t.add(c)):I('<div class="variable-row">').attr("data-name",r).attr("data-path",o+"").attr("data-scope",s||"").css("padding-left",Math.min(5,o.length)+"em").append("<td class='variable-type'>".concat(a||"","</td>"),"<td class='variable-name cm-harlowe-3-"+(s?"tempV":"v")+"ariable'><span class='variable-path'>"+(u?(s?"_":"$")+f(u):"")+"</span> "+(u?"":s?"_":"$")+f(r+"")+"</td>","<td class='temporary-variable-scope'>".concat(s||"","</td>"),"<td class='variable-value cm-harlowe-3-macroName-"+Y(i)+"'>"+l+"</td><td class='panel-row-buttons'><tw-folddown tabindex=0 style='display:"+(e?"visible":"none")+"'>(source:) </tw-folddown></td>").data("value",G(i)).find("tw-folddown").data("folddown",g).end().add("<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'></td></tr>")},rowCheck:function(e,t){var n=e.name,r=e.path,e=e.tempScope;return t[0]&&t[0].getAttribute("data-name")===n&&t[0].getAttribute("data-path")===r+""&&t[0].getAttribute("data-scope")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="variable-type">Type</th><th data-col="variable-name">Name</th><th data-col="temporary-variable-scope">Scope</th><th data-col="variable-value">Value</th></tr>'},rowSort:function(e,t,n){if("variable-value"===e)return a(t.attr("class"),n.attr("class"))||a(t.parent().data("value"),n.parent().data("value"))}}),T=l(function(){var e,t,o=[],n=D.variables,r=o.length;for(e in n)e.startsWith("TwineScript")||(r+=1,function n(e){var r,t,a;500<o.length||(o.push(e),r=e.path.concat(e.name),t=e.value,a=e.tempScope,r.length<=4&&(Array.isArray(t)?t.forEach(function(e,t){return n({name:i(t+1),path:r,value:e,tempScope:a})}):t instanceof Map?_toConsumableArray(t).forEach(function(e){var t=(e=_slicedToArray(e,2))[0],e=e[1];return n({name:t,path:r,value:e,tempScope:a})}):t instanceof Set&&_toConsumableArray(t).forEach(function(e,t){return n({name:t,dataset:!0,path:r,value:e,tempScope:a})})))}({name:e,path:[],value:n[e],tempScope:"",type:null==(t=n.TwineScript_TypeDefs)?void 0:t[e]}));o.push.apply(o,_toConsumableArray(k)),r+=k.size,S.update(o,r),0===r!==S.panel[0].classList.contains("panel-variables-empty")&&S.panel.toggleClass("panel-variables-empty")}),_=(L.on("set",function(e,t,n){var r,a;e===D.variables||"temp"!==(null==(a=e.TwineScript_VariableStore)?void 0:a.type)||null!=(a=e.TwineScript_VariableStore)&&a.name.match(/#\d+$/)||(r=null==(a=e.TwineScript_VariableStore)?void 0:a.name,e=null==(a=e.TwineScript_TypeDefs)?void 0:a[t],(a=_toConsumableArray(k).find(function(e){return e.name===t&&e.tempScope===r}))?a.value=n:k.add({name:t,path:[],value:n,tempScope:r,type:e})),T(),v()}).on("delete",function(){T(),v()}),S.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),S.tab.addClass("enabled"),S.panel.find(".clipboard")),x=(r.on("click",".panel-variables-copy",function(){var e,t=[];for(e in D.variables)e.startsWith("TwineScript")||t.push("$"+e+" to "+G(D.variables[e]));_.val("(set:"+t+")")[0].select(),document.execCommand("copy")}),W.create({className:"enchantments",tabName:"Enchantment",rowWrite:function(e,t){var n=e.scope,r=e.changer,a=e.lambda,o=e.name,i=e.localHook,a=r?f(U(r)):a?f(G(a)):"<em>enchanted with ("+o+":)</em>";return t||I('<div class="enchantment-row">').data("enchantment",e).append("<td><span class='enchantment-name'>"+G(n)+(i?"</span><span class='enchantment-local cm-harlowe-3-hookName'>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value cm-harlowe-3-macroName-"+(r?"changer":"command")+" '>"+a+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).find("tw-folddown").data("folddown",g).end().add(r?I("<tr class='panel-row-source' style='display:none'><td colspan='3'></td></tr>"):"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="enchantment-name">Scope</th><th data-col="enchantment-value">Value</th></div>'}})),d=l(function(e){x.update(e.enchantments,e.enchantments.length)}),O=(q.on("add",d).on("remove",d),q.create()),A=W.create({className:"storylets",tabName:"Storylet",rowWrite:function(e,t){var n=e.name,r=e.active,a=e.storyletSource,o=e.exclusive,e=e.urgent;return t?(t.toggleClass("storylet-closed",!r),t[0].firstChild.textContent=r?"\u2713":""):(t=I('<tr class="storylet-row '.concat(r?"":"storylet-closed",'">')).attr("data-name",n).append("<td class='storylet-open'>"+(r?"\u2713":"")+"</td><td class='storylet-name'>"+n+"</td><td class='storylet-lambda'></td><td class='storylet-exclusive'>"+o+"</td><td class='storylet-urgent'>"+e+"</td>")).find(".storylet-lambda").append(B(a.replace(/^when\s+/i,""))),t},rowCheck:function(e,t){e=e.name;return t[0].getAttribute("data-name")===f(e+"")},columnHead:function(){return'<tr class="panel-head"><th data-col="storylet-open" data-order="desc">Open</th><th data-col="storylet-name">Name</th><th data-col="storylet-lambda">Condition</th><th data-col="storylet-exclusive" class=\'storylet-exclusive\'>Exclusivity</th><th data-col="storylet-urgent" class=\'storylet-urgent\'>Urgency</th></tr>'}}),C=(A.tab.hide(),v=l(function(){var r,a,o=z.getStorylets(O),i=H.containsError(o),e=z.allStorylets();A.update(e.map(function(t){var e="number"==typeof t.get("exclusivity")?t.get("exclusivity"):0,n="number"==typeof t.get("urgency")?t.get("urgency"):0;return r=r||e,a=a||e,{name:t.get("name"),storyletSource:t.get("storylet").TwineScript_ToSource(),active:!i&&o.some(function(e){return e.get("name")===t.get("name")}),exclusive:e,urgent:n}}),i?0:o.length),A.panel.toggleClass("storylet-error",i),A.panel.toggleClass("panel-exclusive",r),A.panel.toggleClass("panel-urgent",a),e.length&&A.tab.show()}),W.create({className:"source",tabName:"Source",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.tag;return t?t.add(t.next(".panel-row-source")):(t=z.get(n).get("source"),I('<div class="source-row" data-tag="'.concat(e,'">')).data("value",t).append('<td class="source-name">'.concat(n,'</td><td class="source-tags">').concat(e,"</td><td class='panel-row-buttons'><tw-folddown class='").concat(e?"":"open","' tabindex=0></tw-folddown></td>")).find("tw-folddown").data("folddown",g).end().add(I("<tr class='panel-row-source' style='".concat(e?"display:none":"","'><td colspan='3'></td></tr>")).find("td").append(!e&&B(t,"markup")).end()))},rowCheck:function(e,t){e=e.name;return t[0].firstChild.textContent===f(e+"")},tabUpdate:I.noop,columnHead:I.noop})),E=["debug-startup","startup","header","debug-header","footer","debug-footer"].reduce(function(e,t){return e.concat(z.getTagged(t).map(function(e){return{name:e.get("name"),tag:t}}))},[]),N=W.create({className:"errors",tabName:"Error",rowWrite:I.noop,rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return N.tab.css({background:e?"rgba(230,101,204,0.3)":""}).text("".concat(e," Error").concat(1!==e?"s":""))}}),d=n(function(e){var t;V.options.debug&&(N.panelRows.append(e.reduce(function(e,t){var t=_slicedToArray(t,2),n=t[0],t=t[1];return"propagated"===n.type?e:e+'<tr class="error-row"><td class="error-passage">'+D.passage+'</td><td class="error-message" title="'+f(t)+'">'+n.message+"</td></tr>"},"")),500<(t=(e=N.panelRows.children()).length)&&I(Array.prototype.slice.call(N.panelRows[0].childNodes,0,t-500)).remove(),N.tabUpdate(Math.min(500,e.length)))},{batch:!0}),j=(H.on(d),N.panel.append("<div class='panel-errors-bottom'>\n\t\t\t<button class='panel-errors-clean'>\ud83e\uddf9 Clear this panel</button>\n\t\t</div>"),r.on("click",".panel-errors-clean",function(){N.panelRows.empty(),N.tabUpdate(0)}),W.create({className:"tools",tabName:"Tools",tabNameCounter:!1,rowWrite:function(e,t){var n=e.id,r=e.type,a=e.label,o=e.dropdownItems,i=e.dropdownValue;return"checkbox"===r?t?t.find("input").prop("checked",!1):I('<span><input id="debug-'.concat(n,'" type="checkbox"></input><label for="debug-').concat(n,'">').concat(a,"</label></span>")):"dropdown"===r?t?t.find("input").prop("checked",!1):I("<span>".concat(a,'<select style="width:3em" data-default="').concat(i,'" id="debug-').concat(n,'"></span>')).find("select").append(o.map(function(e){return"<option value='".concat(e,"' ").concat(e===i?"selected":"",">").concat(e,"x</option>")})).end():void 0},rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return j.tab.css({background:e?"hsla(210, 72%, 65%, .3)":""})}})),P=(r.on("click, change",'.panel-tools [type="checkbox"], .panel-tools select',function(e){var e=e.target,t=(e=I(e)).attr("id"),n=e.is(":checked")||e.is("select")&&e.val()!==+e.attr("data-default");"debug-peekBehindDialogs"===t&&r.toggleClass("debug-dialogs",n),"debug-ignoreClickEvents"===t&&(V.options.ignoreClickEvents=n),"debug-ignoreGotos"===t&&(V.options.ignoreGotos=n),"debug-speedMultiplier"===t&&(V.options.speedMultiplier=+e.val()),j.tabUpdate(n)}),j.update([{id:"peekBehindDialogs",type:"checkbox",label:"See through and click through <code>(dialog:)</code> boxes"},{id:"ignoreClickEvents",type:"checkbox",label:"Stop links, <code>(click:)</code> and <code>(hover-style:)</code> from activating"},{id:"ignoreGotos",type:"checkbox",label:"Stop <code>(go-to:)</code>, <code>(undo:)</code>, <code>(redirect:)</code> and <code>(restart:)</code> from activating<br><small>(Click 'GO' buttons in Debug View to activate later)</small>"},{id:"speedMultiplier",label:"Speed of timed events (<code>time</code>, <code>(live:)</code>, <code>(after:)</code>): ",type:"dropdown",dropdownValue:1,dropdownItems:[.25,.5,.75,1,1.25,1.5,1.75,2,3,5,10]}]),W.create({className:"options",tabName:"\u2699\ufe0f",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.label,r={darkMode:o.darkMode,fadePanel:o.fadePanel,evalReplay:o.evalReplay}[n];return t?t.find("input").prop("checked",r):I('<span><input id="debug-'.concat(n,'" type="checkbox" ').concat(r?"checked":"",'></input><label for="debug-').concat(n,'">').concat(e,"</label></span>"))},rowCheck:I.noop,tabUpdate:I.noop,columnHead:I.noop})),R=(r.on("click",'.panel-options [type="checkbox"]',function(e){var e=e.target,t=(e=I(e)).attr("id"),e=e.is(":checked");"debug-darkMode"===t&&(o.darkMode=e,h.toggleClass("theme-dark",e)),"debug-fadePanel"===t&&(o.fadePanel=e,h.toggleClass("fade-panel",e)),"debug-evalReplay"===t&&(V.options.evalReplay=o.evalReplay=e),c()}),P.update([{name:"darkMode",label:"Debug panel is dark"},{name:"fadePanel",label:"Debug panel is transparent unless the cursor is over it"},{name:"evalReplay",label:"Record expression replays (viewable via \ud83d\udd0d buttons in Debug View; slower)"}]),h.prepend(S.panel,x.panel,N.panel,A.panel,C.panel,j.panel,P.panel),s.prepend(S.tab,x.tab,N.tab,A.tab,C.tab,j.tab,P.tab),D.on("beforeForward",y).on("beforeBack",y).on("beforeLoad",y),l(function(){T(),v(),x.panelRows.empty(),x.tabUpdate(0),D.passage&&z.get(D.passage)&&(C.update(E.concat({name:D.passage,tag:""})),C.panel.find('[data-tag=""], [data-tag=""] + .panel-row-source').insertBefore(C.panel.find('[data-tag="footer"]').first()))}));D.on("forward",R).on("back",R).on("load",R);K=b,I(document.head).append(I("<style>").html(X)),b(),e&&d(e,t)};return F.registerDebugMode(function(e,t){return!V.options.debug&&K(e,t)}),K}),define("debugmode/panel",["jquery","utils/naturalsort"],function(d,e){var i=e();return Object.seal({create:function(e){var n,t=e.className,r=e.rowWrite,a=e.rowCheck,o=e.rowSort,i=e.columnHead,s=e.tabName,c=e.tabNameCounter,l=void 0===c||c,c=e.tabUpdate,u=d("<div class='panel panel-".concat(t,"' style='").concat(this.defaultMaxHeight?"max-height:"+this.defaultMaxHeight+"px":"","' hidden><div class=\"resizer-v\"></div><table class='panel-rows'></table></div>")),p=d("<button class='tab tab-".concat(t,"'>").concat(l?"0 ".concat(s,"s"):s,"</button>"));return p.click(function(){p.toggleClass("enabled"),p.parent().siblings(".panel").attr("hidden",""),p.is(".enabled")&&(p.siblings(".tab:not(.tab-"+t+")").removeClass("enabled"),u.removeAttr("hidden"))}),u.on("click","th",function(e){var e=e.target,t="desc"===(e=d(e)).attr("data-order")?"asc":"desc";n.sort(e.attr("data-col"),t),u.find("th[data-order]").removeAttr("data-order"),e.attr("data-order",t)}),c=c||function(e){return p.text(l?"".concat(e," ").concat(s).concat(1!==e?"s":""):s)},n=Object.assign(Object.create(this),{tabName:s,tab:p,panel:u,panelRows:u.find(".panel-rows"),rowWrite:r,rowSort:o,rowCheck:a,columnHead:i,tabUpdate:c})},sort:function(r,a){var o=this;this.panelRows.children(":not(.panel-head, .panel-row-source)").get().sort(function(e,t){var n;return"desc"===a&&(e=(n=[t,e])[0],t=n[1]),e=e.querySelector("."+r),t=t.querySelector("."+r),o.rowSort&&o.rowSort(r,d(e),d(t))||i(e.textContent,t.textContent)}).forEach(function(e){var t=d(e).next(".panel-row-source").get();o.panelRows.append(e,t)})},update:function(e,t){var r=this.rowCheck,a=this.rowWrite,o=this.panelRows,n=this.columnHead,i=this.panel,s=[],c=o.children(),e=(e.forEach(function(t){var e=c.get().filter(function(e){return r(t,d(e))}),n=a(t,e.length&&d(e));e.length||o.append(n),s.push.apply(s,_toConsumableArray(n.get()))}),c.filter(function(e,t){return!s.includes(t)&&!t.className.includes("panel-head")}).remove(),this.tabUpdate(t),0<t&&!o.find(".panel-head").length?o.prepend(n()):0===t&&o.find(".panel-head").remove(),i.find("th[data-order]"));e.length&&this.sort(e.attr("data-col"),e.attr("data-order"))},defaultMaxHeight:300})}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset","internaltypes/twineerror"],function(b,e,t,v,n){function w(e){return("string"==typeof e?e:e.map(function(e){return e.text}).join("")).split(/\n/g).reduce(function(e,t,n,r){r=r.length;return e.concat(document.createTextNode(t),n!==r-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])}var k=e.impossible,S=e.transitionIn,T=t.exec,r=Object.assign,p=Object.keys,a=Object.create,e=Object.seal,_=Array.isArray,x={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,output:!1,summary:function(){var t=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers","output"].filter(function(e){return hasOwnProperty.call(t,e)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",p(this.loopVars).length&&"loopVars",p(this.data).length&&"data"].filter(Boolean))},create:function(e,t){e=r(a(this),{attr:this.attr?this.attr.slice():[],styles:this.styles?this.styles.slice():[],loopVars:this.loopVars||{},data:this.data||{}},e);if(t){t=t.run(e);if(n.containsError(t))return t}return e},update:function(){function e(t){var e,n,r;_(a.styles)&&0<a.styles.length&&(n=(e=_slicedToArray(a.styles.reduce(function(n,r){return p(r).forEach(function(e){var t=r[e];n[+("function"==typeof t)].push(_defineProperty({},e,t))}),n},[[],[]]),2))[0],r=e[1],n.forEach(function(e){return t.css(e)}),setTimeout(function(){r.forEach(function(e){return t.css(e)})})),a.attr&&a.attr.forEach(function(e){return t.attr(e)}),a.data&&t.data(a.data)}var a=this,t=this.section,n=this.newTargets,r=this.transition,o=this.transitionDeferred,i=this.append,s=this.target;"function"==typeof s&&(s=s());if(_(n)&&n.length&&(s=n.map(function(e){return e.target})),_(s))for(var c=0;c<s.length;c+=1)v.isPrototypeOf(s[c])?s[c].forEach(t,e):e(s[c]);else v.isPrototypeOf(s)?s.forEach(t,e):e(s);if(r&&!o&&!i){for(var l,u=s;(l=u.data("timestamp"))||(u=u.parent()),!l&&u.length;);S(s,r,this.transitionTime,this.transitionDelay,this.transitionSkip,l?Date.now()-l:0,this.transitionOrigin)}},render:function(){var e,r=this,t=this.source,n=this.transition,a=this.transitionTime,o=this.transitionDeferred,i=this.enabled,s=this.enablers,c=this.data,l=this.section,u=this.newTargets,p=this.innerEnchantments,d=this.appendSource,f=this.output,h=this.target,m=this.target,g=this.append;if("function"==typeof h&&(h=h()),!g)return k("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),b();if(f)return b();if(null!=s&&s.length)return s=(f=s[0]).descriptor,f=f.changer,s=s.render(),f&&(e=x.create({section:l,target:s}),f.run(e),e.update()),s;if(!i||void 0!==h.attr("hidden"))return x.create({target:h,attr:this.attr.filter(function(e){return!("style"in e)}),data:_objectSpread(_objectSpread({},c),{},{originalSource:t,hidden:!0})}).update(),b();if(!(h=_(u)&&u.length?u:h))return k("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),b();var y=b();if([].concat(h).filter(function(e){return!e.jquery}).map(function(e){var t,n,r=g;return e.target&&e.append&&(r=(t=e).append,n=t.before,e=e.target),{elements:e.hooks(l,m).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(m[0]))}),append:r}},[]).forEach(function(e){var t=e.elements,n=e.append;t.each(function(e,t){t=b(t),y=y.add(r.create({target:t,append:n,newTargets:null}).render()),t.filter("tw-pseudo-hook").contents().unwrap()})}),!(y.length||_(h)||v.isPrototypeOf(h))){f=g;if(!(f in h)){if("replace"!==f)return k("ChangeDescriptor.render","The target doesn't have a '"+f+"' method."),b();f=h[0]instanceof Text?"replaceWith":(h.empty(),"append")}h[0]instanceof Text&&"prepend"===(f="append"===f?"after":f)&&(f="before"),y=b(t&&(this.verbatim?w:T)(t)),_(d)&&d.forEach(function(e){var t=e.source,e=e.append,t=b((r.verbatim?w:T)(t));y="append"===e?y.add(t):"prepend"===e?t.add(y):t}),h[f](y.length?y:void 0),h.data("timestamp",Date.now()),this.update(),n&&!o&&S("replace"===g?h:y,n,a,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),p&&p.map(function(e){return e(h)}).forEach(function(e){return l.addEnchantment(e)})}return y}};return e(x)}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(g,y,b,v,e,w,t){var k=e.objectName,S=e.toSource,T=t.collapse;return Object.freeze({create:function(e){return Object.assign(Object.create(this),{enchantments:g()},e)},enchantScope:function(){var i=this,s=this.attr,c=this.data,l=this.functions,u=this.section,p=this.scope,d=this.localHook,f=this.lambda,h=[],m=0;p.forEach(u,function(e,t){if(d){d=d.jquery?d:d.hooks(u);var n=e.find(d);if(n.length)e=n;else if(!d.has(e[0]).length)return}var r,a,o;(!e.is(":empty")||e.data("source")&&e.data("source").length)&&(m+=1,f?(o=f.apply(u,{loop:p.TwineScript_GetProperty(t),pos:m}),w.containsError(o)?(e.replaceWith(o.render()),f=o=null):v.isPrototypeOf(o)?o.canEnchant||(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),"\" can't be or include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")).render()),f=o=null):(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),'" must return a changer, not ').concat(k(o),".")).render()),f=o=null)):o=i.changer,n=!s&&!c&&(!o||o.summary().every(function(e){return e.startsWith("transition")})),r=n?e:e.wrap("<tw-enchantment>").parent(),s&&r.attr(s),c&&r.data(c),l&&l.forEach(function(e){return e(r)}),o&&(t=b.create({section:u,target:r}),o.run(t),t.update(),e.is(y.storyElement)?(a=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(t.styles)))),e.css(a.reduce(function(e,t){return"background-color"===t||"background-image"===t?(e["background-color"]="transparent",e["background-image"]="none",a.push("background-".concat("background-color"===t?"image":"color"))):e[t]="inherit",e},{})),r.data({enchantedProperties:a})):e.is("tw-passage")&&t.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})&&(o="padding-right",y.storyElement.css(t="padding-left","0px").css(o,"0px"),r.data({enchantedProperties:[t,o]}))),e.is(y.storyElement)&&r.css({"min-width":"100%","min-height":"100%"}),"true"===r.attr("collapsing")&&(r.find("[collapsing=false]").each(function(){g(this).removeAttr("collapsing")}),T(r)),n||h.push(r))}),this.enchantments=g(h)},disenchant:function(){this.enchantments.each(function(e,t){(t=g(t)).contents().unwrap();t=t.data("enchantedProperties");t&&y.storyElement.css(t.reduce(function(e,t){return e[t]="",e},{}))})}})}),define("internaltypes/twineerror",["jquery","utils"],function(i,s){var a=s.impossible,c=s.escape,l=(i(document.documentElement).on("click","tw-folddown",function(e){var t=e.target,e=((t=i(t)).toggleClass("open"),t.popData("folddown"));for("function"==typeof e&&e(t);t&&!t.next().length;)t=t.parent();null!=(e=t)&&e.next().toggle()}),{syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true.",debugonly:"This macro is not meant to be used outside of debugging your story."}),u=[],n={TwineError:!0,create:function(e,t,n,r){return t&&"string"==typeof t||a("TwineError.create","has a bad message string"),n||e in l||a("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:n,source:void 0,innerDOM:r,appendTitleText:!1})},containsError:function(){for(var e=0;e<arguments.length;e+=1){var t=arguments[e];if(n.isPrototypeOf(t))return t;if(Array.isArray(t)){t=n.containsError.apply(n,t);if(t)return t}}return!1},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=(t="string"==typeof t?t:this.source||"",i("<tw-error class='"+(this.warning?"warning":"error")+"' title='"+c(t)+"'>"+c(this.message+(this.appendTitleText?" "+t:""))+"</tw-error>")),a=i("<tw-error-explanation>").text(this.explanation||l[this.type]).hide(),o=i("<tw-folddown tabindex=0>");return this.innerDOM&&i("<tw-open-button label='Open'>").on("click",function(){var e=i("<tw-backdrop><tw-dialog></tw-backdrop>");e.find("tw-dialog").prepend(n.innerDOM,i("<tw-link tabindex=0>OK</tw-link>").on("click",function(){n.innerDOM.detach(),e.remove()}).wrap("<tw-dialog-links>").parent()),s.storyElement.prepend(e)}).appendTo(r),r.append(o).append(a),r.data("TwineError",this),e||u.forEach(function(e){return e(n,t)}),r},on:function(e){return"function"!=typeof e||u.includes(e)||u.push(e),n}};return Object.preventExtensions(n)}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return Object.preventExtensions(r)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(u,p,e,t,i){var c,n=e.impossible,s=e.andList,r=e.nth,o=t.is,d=t.isObject,f=t.toSource,h=t.isSequential,m=t.objectName,l=t.typeName,g=t.clone,y=t.isValidDatamapName,b=t.subset,v=t.collectionType,w=t.unstorableValue,a=t.matches,k=Array.isArray,S={set:[],delete:[]},T="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.), slices ('1stTo2ndlast', '3rdTo5th'), ",_="You can't access the '0th' or '0thlast' position of ";function x(e,t){if(p.containsError(t))return n;if(e instanceof Map&&(n=p.containsError(y(e,t))))return n;if(h(e))if("number"==typeof t){if(0===t)return p.create("property","You can't access elements at position 0 of ".concat(m(e),"."),"Only positive and negative position values exist.");0<t&&--t}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)last$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=-r[1]}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=r[1]-1}else if("string"==typeof t&&(r=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(t))){var n=_slicedToArray(r,5),r=n[1],r=void 0===r?0:r,a=n[2],o=n[3],o=void 0===o?0:o;t={last:n[4]?-o:o-1,first:a?-r:r-1}}else if("last"===t)t=-1;else if("random"===t){if(!e.length)return p.create("property","I can't get a random value from ".concat(m(e),", because it's empty."));t=u.random()*Array.from(e).length|0}else{if(i.isPrototypeOf(e)&&!i.TwineScript_Properties.includes(t))return p.create("property","".concat(T+s(i.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if(!["length","some","any","all","start","end","random"].includes(t)&&!i.isPrototypeOf(e))return p.create("property","".concat(T,"'length', 'some', 'any', 'all', 'start', 'end', and 'random' of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."))}else if(e instanceof Set){if(!["length","some","any","all"].includes(t))return p.create("property","".concat(T,"'length', 'some', 'any', and 'all' of ").concat(m(e),"."),"You can't access specific individual data values from datasets.");"length"===t&&(t="size")}else{if(k(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(t))return p.create("property","You can only get the ".concat(s(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if("number"==typeof e||"boolean"==typeof e)return p.create("property","You can't get any data values, let alone ".concat(m(t),", from ").concat(m(e)))}return t}function O(e,t){return+t<0&&Math.abs(t)<=e.length?e.length+ +t:t}var A=/[^\uD801-\uDFFF]/,C=new Map;function E(e,t){var n,r,a;return void 0===e?e:e instanceof Map?e.get(t):"some"!==t&&"any"!==t&&"all"!==t&&"start"!==t&&"end"!==t||e.TwineScript_VariableStore?("string"==typeof e&&(C.has(e)?e=C.get(e):A.test(e)?(a=_toConsumableArray(e),C.set(e,a),e=a):C.set(e,e)),h(e)&&Number.isFinite(t)&&(t=O(e,t)),e.TwineScript_GetProperty?e.TwineScript_GetProperty(t):"function"!=typeof(a=e[t])?a:void 0):(n=e,r=t,a='"'.concat(r," value").concat("any"===r?"":"s",'" of '),{determiner:r,determined:n,array:_toConsumableArray(n),string:"string"==typeof n&&n,TwineScript_ObjectName:a+m(n),TwineScript_ToSource:function(){return"".concat(r," of ").concat(f(n))},TwineScript_TypeName:a+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}})}function N(e){var t;return e.computed?(t=e.value,"string"==typeof(t=c.isPrototypeOf(t)?t.get():t)?"('"+t+"')":"("+t+")"):"number"==typeof e?r(e):"'"+e+"'"}function j(t,e,n){if(t.TwineScript_VariableStore){if(t.TwineScript_TypeDefs&&e in t.TwineScript_TypeDefs){var r=t.TwineScript_TypeDefs[e];if("const"===r.name){if(void 0!==t[e])return p.create("operation","I can't alter ".concat(t===u.variables?"$":"_").concat(e," because it's been restricted to a constant value."),"This variable can't be changed for the rest of the story.")}else if(!a(r,n))return p.create("operation","I can't set ".concat(t===u.variables?"$":"_").concat(e," to ").concat(l(n)," because it's been restricted to ").concat(f(r),"-type data."),"You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return k(e)?e.map(function(e){return j(t,e)}):t instanceof Map?"string"==typeof e||p.create("operation","".concat(m(t)," can only have string data names, not ").concat(m(e),".")):h(t)?["length","random","some","any","all","start","end"].includes(e)?p.create("operation","I can't forcibly alter the '"+e+"' of "+m(t)+".","start"===e||"end"===e?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+e+"'.":void 0):+e==(0|e)||p.create("property",m(t)+" can only have position keys ('3rd', '1st', (5), etc.), not "+N(e)+"."):t.TwineScript_Identifiers&&e in t?p.create("keyword","I can't alter the value of the '"+e+"' identifier.","You can only alter data in variables, not fixed identifiers."):p.create("operation","I can't modify "+m(t),t instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":i.isPrototypeOf(t)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function P(t,e,n,r){var a=e;t instanceof Map?t.set(e,n):(h(t)&&(e=O(t,e)),t.TwineScript_Set?t.TwineScript_Set(e,n,r):t[e]=n),S.set.forEach(function(e){return e(t,a,n)})}function R(t,e){var n=e;h(t)&&(e=O(t,e)),k(t)&&/^(?:[1-9]\d*|0)$/.exec(e)?t.splice(e,1):t instanceof Map||t instanceof Set?t.delete(e):t.TwineScript_Delete?t.TwineScript_Delete(e):delete t[e],S.delete.forEach(function(e){return e(t,n)})}function I(t,e){var n,r,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return e&&"object"===_typeof(e)&&"last"in e&&"first"in e?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):(n=e.first,r=e.last,b(t,n+(0<=n),r+(0<=r))):k(e)?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):e.map(function(e){return I(t,e,e)})["string"==typeof t?"join":"valueOf"](""):void 0!==(n=E(t,e))||o?n:t===u.variables?0:"temp"===(null==(r=t.TwineScript_VariableStore)?void 0:r.type)?p.create("property","There isn't a temp variable named _".concat(a," in this place."),"Temp variables only exist inside the same passage, hook, or lambda in which they're created."):k(t)&&"number"==typeof e?p.create("property","This array of ".concat(t.length," elements doesn't have a ").concat(N(a+("number"==typeof a?1:""))," element."),t.length?"It contains: ".concat(s(t.map(m)),"."):"The array is empty."):(o=Array.from("function"==typeof t.keys&&t.keys()),p.create("property","I can't find a ".concat(N(a)," data name in ").concat(m(t)),t instanceof Map&&o.length?"Its names include: ".concat(s(o),"."):void 0))}function V(e,t){var r=this,e=this.compiledPropertyChain.reduce(function(e,t){var n=0===e.length?r.object:I.apply(void 0,_toConsumableArray(e[e.length-1]));return e.push([n,t])&&e},[]).reduceRight(e,t);return p.containsError(e)?e:void 0}return c=Object.freeze({get:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(e=I(e,this.compiledPropertyChain[t]),p.containsError(e))return e;return I(e,this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},has:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(void 0===(e=I(e,this.compiledPropertyChain[t],void 0,!0))||p.containsError(e))return!1;return void 0!==I(e,this.compiledPropertyChain.slice(-1)[0],void 0,!0)},set:function(e,c){var l=this;return!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?V.call(this,function(n,e,t){var e=_slicedToArray(e,2),r=e[0],a=e[1];if(e=p.containsError(n,r,a)||p.containsError(j(r,a,n)))return e;if(e=w(n))return p.create("operation","".concat(m(n)," can't be stored").concat(!n.TwineScript_Unstorable&&v(n)?" because it holds ".concat(m(e)):"","."));if(0<t)r=g(r);else if("temp"===(null==(e=r.TwineScript_VariableStore)?void 0:e.type)&&r!==u.variables){for(var o=r;"temp"===(null==(i=o.TwineScript_VariableStore)?void 0:i.type)&&!hasOwnProperty.call(o,a);)var i,o=Object.getPrototypeOf(o);"temp"===(null==(t=o.TwineScript_VariableStore)?void 0:t.type)&&(r=o)}if("string"==typeof r){if("string"!=typeof n)return p.create("datatype","I can't put this non-string value, ".concat(m(n),", in a string."));if(n.length!==(k(a)?a.length:1))return p.create("datatype","".concat(m(n),"is not the right length to fit into this string location."));var r=_toConsumableArray(r),s=_toConsumableArray(n);[].concat(a).forEach(function(e){0+e<0&&(e=r.length+(0+e)),r=[].concat(_toConsumableArray(r.slice(0,e)),[s.shift()],_toConsumableArray(r.slice(e+1)))}),r=r.join("")}else d(r)&&(void 0!==n.TwineScript_KnownName&&((n=""!==n.TwineScript_KnownName?g(n):n).TwineScript_KnownName=f(l)),k(a)&&h(n)?("string"==typeof n&&(n=_toConsumableArray(n)),a.map(function(e,t){return[e,n[t]]}).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return P(r,t,e,c)})):P(r,a,n,c));return r},e):p.create("macrocall","I can't (set:) ".concat(m(this),", if the ").concat((m(this.object).match(/ (.+$)/)||["","value"])[1]," isn't stored in a variable."),"Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return V.call(this,function(e,t,n){var r,t=_slicedToArray(t,2),a=t[0],t=t[1];return(r=p.containsError(e,a,t)||p.containsError(j(a,t)))||(0<n&&(a=g(a)),null===e?((r="string"==typeof a)&&(a=_toConsumableArray(a)),k(t)?(h(a)&&(t=_toConsumableArray(new Set(t))).sort(function(e,t){return O(a,t)-O(a,e)}),t.forEach(function(e){return R(a,e)})):R(a,t),r&&(a=a.join(""))):P(a,t,e,!1),a)},null)},defineType:function(e){var t=this.object,n=this.compiledPropertyChain[0],r=(hasOwnProperty.call(t,"TwineScript_TypeDefs")||(t.TwineScript_TypeDefs=Object.create(t.TwineScript_TypeDefs||null)),t.TwineScript_TypeDefs),a=r[n];if(a&&!o(a,e))return p.create("operation","I can't redefine the type of "+m(this)+" to "+(e.TwineScript_ObjectName||l(e))+", as it is already "+(a.TwineScript_ObjectName||l(a))+".");t.TwineScript_DefineType?t.TwineScript_DefineType(n,e):r[n]=e,"const"===e.name&&(t[n]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,t){var n;if(n=p.containsError(e))return n;Array.isArray(t)||(t=[].concat(t)),c.isPrototypeOf(e)&&(t=e.propertyChain.concat(t),e=e.object);var r=function(e,t){for(var n,r=[],a=0;a<t.length;a+=1){var o=t[a];if(o.computed&&(o=o.value),c.isPrototypeOf(o)&&(o=o.get()),k(o)){for(var i=[],s=0;s<o.length;s+=1)i[s]=x(e,o[s]);o=i}else o=x(e,o);if(n=p.containsError(o))return n;a<t.length-1&&(e=I(e,o)),r.push(o)}return r}(e,t);return(n=p.containsError(r))||Object.assign(Object.create(c),{object:e,propertyChain:t,compiledPropertyChain:r})},TwineScript_ToSource:function(){function r(e,t){return!t&&n.object.TwineScript_VariableStore?e:N(e)}var e,n=this;return(this.object===u.variables?"$":"temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?r(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+r(t,n)}))},get TwineScript_ObjectName(){var e;return this.object.TwineScript_VariableStore?"the ".concat("temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"temp ":"","variable ").concat(this.TwineScript_ToSource()):m(this.object)+"'s "+(1===this.propertyChain.length?N(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+N(t)}))},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),c;n("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:{type:"temp",name:"an unknown scope"},TwineScript_TypeDefs:Object.create(null)})}),define("macrolib/commands",["jquery","macros","utils","state","passages","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(u,n,b,c,l,a,y,M,e,o,t,p,d,i,s,v,r,f){var h=r.printBuiltinValue,m=r.objectName,g=r.clone,w=r.toSource,k=f.dialog,S=f.geomParse,D=f.geomStringRegExp,r=n.TypeSignature,f=r.Any,F=r.Everything,T=r.rest,_=r.either,x=r.optional,O=r.zeroOrMore,L=r.percent,H=r.nonNegativeInteger,A=r.positiveInteger,r=r.positiveNumber,C=Object.assign,E=Math.floor,N=Math.ceil,j=Math.abs,z=Math.max,q=Math.min,P=u.noop;function R(e){return"(".concat(e," ").concat(b.options.ifid,") ")}["set","put","unpack"].forEach(function(r){return n.add(r,"Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"===n.operator&&"set"===r)return y.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===n.operator&&"set"!==r)return y.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((i.isPrototypeOf(n.dest)||s.isPrototypeOf(n.dest))===("unpack"===r))return y.create("macrocall","unpack"===r?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the (".concat(r,":) macro with just single variables and typed variables to the ").concat("set"===r?"left of 'to'.":"right of 'into'."),"You may wish to change this to the (".concat("unpack"!==r?"unpack":"to"===n.operator?"set":"put",":) macro."));n=n.set();if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (".concat(r,":) operation"),TwineScript_ObjectName:"a (".concat(r,":) operation"),TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)])}),n.add("move","Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return y.create("macrocall","Please say 'into' when using the (move:) macro.");n=n.set(!0);if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)]),n.addCommand("display",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (display:) the passage '".concat(e,"' because it doesn't exist."))},function(e,t,n){return e.source=l.getTree(n),e},[String])("print",P,function(e,t,n){return C(e,{source:h(n)})},[f])(["verbatim-print","v6m-print"],P,function(e,t,n){return C(e,{verbatim:!0,source:h(n)})},[f])(["verbatim-source","v6m-source"],function(e){if("command"===(null==e?void 0:e.TwineScript_TypeID)&&!e.TwineScript_ToSource)return y.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return C(e,{verbatim:!0,source:h(w(n))})},[f])("go-to",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (go-to:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.goToPassage(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("redirect",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (redirect:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.redirect(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("undo",P,function(e,t,n){return c.pastLength<1?C(e,{source:n}):b.options.ignoreGotos?void 0:(requestAnimationFrame(function(){return a.goBack({transition:e.data.passageT8n})}),{blocked:!0})},[x(String)])("debug",P,a.enableDebugMode,[],!1),b.onStartup(function(){return b.storyElement.on("click.icon","tw-icon",function(e){var t=u(this),n=t.data("clickEvent"),r=t.attr("alt");n&&n(t),"Undo"===r&&(e.stopPropagation(),a.goBack()),"Redo"===r&&(e.stopPropagation(),a.goForward()),"Fullscreen"===r&&(e.stopPropagation(),a.toggleFullscreen()),"Restart"===r&&(c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return 0<c.pastLength}],["Redo","&#8631;",function(){return 0<c.futureLength}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var e=_slicedToArray(e,3),o=e[0],i=e[1],s=e[2];n.addCommand("icon-".concat(o.toLowerCase()),function(e,t){if("string"==typeof e&&"string"==typeof t)return e=_toConsumableArray(e).length,t=_toConsumableArray(t).length,1<e&&1<t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 1 character long, for its icon.")):1===e&&1===t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 2 or more characters long, for its label.")):void 0},function(t,e,n,r){var a;return("string"==typeof r&&1===_toConsumableArray(r).length||"string"==typeof n&&1<_toConsumableArray(n).length)&&(n=(a=[r,n])[0],r=a[1]),"Undo"===o&&(t.data.forgetUndosEvent=function(e){t.section.whenUnblocked(function(){return u(e).css("visibility","hidden")})}),C(t,{source:'<tw-icon tabindex=0 alt="'.concat(o,'" ').concat(r?'data-label="'.concat(r.replace('"',"&quot;"),'"'):"",' title="').concat(o,'" ').concat(s()?"":'style="visibility:hidden"',">").concat(n||i,"</tw-icon>")})},[x(String),x(String)])}),n.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:y.create("datatype","The 2nd "+r):y.create("datatype","The 1st "+r)},function(r,e,a,o,i){r.attr.push({"data-2bind":!0}),r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&r.target.children("tw-icon").text((0<t?E:N)(t)).attr("data-label",1!==j(t)&&void 0!==i?i:o)};var t=a.varRef.get();return"number"!=typeof t?y.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-icon data-label="'.concat(b.escape(1!==j(t)&&void 0!==i?i:o),'">').concat((0<t?E:N)(t),"</tw-icon>")})},[v,String,x(String)]),n.addCommand("meter",function(e,t,n,r){return"two way"===e.bind?y.create("datatype","(meter:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".'):"string"!=typeof r||r.trim()?-1===n.search(D)||!n.includes("=")&&1<n.length?y.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:y.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(r,e,a,n,t,o,i){o&&"string"!=typeof o&&(i=o,o=void 0),i=i||p.create({h:0,s:0,l:.5,a:.5}),p.isPrototypeOf(i)&&(i=d.create(90,[{colour:i,stop:0},{colour:i,stop:1}]));function s(e){var t=z(0,q(1,e/n)),e=i.repeating?i:i.multiply(n/e);return"height:100%;background-repeat:no-repeat;background-image:".concat((l?C(e,e.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+C(e,e.repeating?{}:{angle:l||0===c?90:270}).toLinearGradientString(),";background-size:").concat(l?Array(2).fill(50*t+"%"):100*t+"%",";background-position-x:").concat(l?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===c?"left":"right",";text-align:").concat(l?"center":0===c?"left":"right")}var t=S(t),c=t.marginLeft,t=t.size,l=0<c&&Math.ceil(c+t)<100,u=(r.styles.push({"margin-left":c+"%",width:t+"%",height:"1.5em",display:"block"}),r.attr.push({"data-2bind":!0}),o&&e.stackTop.tempVariables),t=(r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&((n=r.target.children("tw-meter")).attr("style",s(t)),o)&&r.section.renderInto("",null,{source:o,target:n,append:"replace",transitionDeferred:!1},u)},a.varRef.get());return"number"!=typeof t?y.create("datatype","(meter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-meter style="'.concat(s(t),'">').concat(o||"","</tw-meter>")})},[v,r,String,x(_(String,p,d)),x(_(p,d))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(t,u){return n.addCommand(t,function(){var e;return""===(arguments.length<=0?void 0:arguments[0])?y.create("datatype","The first string in a ("+t[0]+":) can't be empty."):arguments.length<=(v.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?y.create("datatype","I need two or more strings to "+(u?"sequence":"cycle")+" through, not just '"+((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e])+"'."):void 0},function(a,e){for(var o,t=arguments.length,i=new Array(2<t?t-2:0),n=2;n<t;n++)i[n-2]=arguments[n];v.isPrototypeOf(i[0])&&(o=i.shift());var s=0,c=("two way"===(null==(l=o)?void 0:l.bind)&&(a.attr.push({"data-2bind":!0}),-1<(l=i.indexOf(o.varRef.get())))&&(s=l),e.stackTop.tempVariables);function r(e,t){var n=s>=i.length-1&&u,r=""===i[s]?"":n?i[s]:"<tw-link>".concat(i[s],"</tw-link>");if(n&&(a.data.clickEvent=void 0),o&&!t){n=o.set(i[s]);if(y.containsError(n))return void e.replaceWith(n.render(i[s]))}t=_objectSpread(_objectSpread({},a),{},{source:r,transitionDeferred:!1});a.section.renderInto("",null,t,c)}i[s]&&(a.data.clickEvent=function(e){s=(s+1)%i.length,r(e,!1)},a.data.twoWayBindEvent=function(e,t,n){o.varRef.matches(t,n)&&(t=o.varRef.get(),-1<(n=i.indexOf(t)))&&n!==s&&(s=n,r(e,!0))});var l="<tw-link>".concat(i[s],"</tw-link>");if(o){e=o.set(i[s]);if(y.containsError(e))return e}return C(a,{source:l,append:"replace",transitionDeferred:!0})},[_(v,String),T(String)])}),b.onStartup(function(){return b.storyElement.on("change.dropdown-macro","select",function(){var e=u(this),t=e.closest("tw-expression, tw-hook").data("dropdownEvent");t&&t(e)})}),n.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===((t=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=t?void 0:arguments[t])?y.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?y.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(e,t,r){for(var n=arguments.length,a=new Array(3<n?n-3:0),o=3;o<n;o++)a[o-3]=arguments[o];var i=0,s=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),-1<(c=a.indexOf(r.varRef.get())))&&(i=c),Math.max.apply(Math,_toConsumableArray(a.map(function(e){return _toConsumableArray(e).length})))),c="<select>"+a.map(function(e,t){return"<option".concat(t===i?" selected":"").concat(""===e?" disabled":"",">").concat(b.escape(e||"\u2500".repeat(s)),"</option>")}).join("\n")+"</select>",l=(e.data.dropdownEvent=function(e){var t=e.val(),n=r.set(t);y.containsError(n)&&e.replaceWith(n.render(t))},e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&(t=r.varRef.get(),-1<(n=a.indexOf(t)))&&n!==i&&(e.find("select").val(t),i=n)},e.styles.push({"background-color":function(){return b.parentColours(u(this)).backgroundColour}}),r.set(a[i]));return y.containsError(l)?l:C(e,{source:c,append:"replace"})},[v,String,T(String)]),b.onStartup(function(){return b.storyElement.on("input.checkbox-macro","input[type=checkbox]",function(){var e=u(this),t=e.closest("tw-expression").data("checkboxEvent");t&&t(e)})});function I(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]}var V=1;n.addCommand("checkbox",function(){},function(e,t,r,n){var a=!1,o="checkbox-"+ ++V,i=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),"boolean"==typeof(i=r.varRef.get())&&(a=i),e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&"boolean"==typeof(t=r.varRef.get())&&e.children("input[type=checkbox]").prop("checked",t)}),e.data.checkboxEvent=function(e){var t=e.is(":checked"),t=r.set(t);y.containsError(t)&&e.replaceWith(t.render(""))},r.set(a));return y.containsError(i)?i:C(e,{source:'<input id="'.concat(o,'" type="checkbox" ').concat(a?"checked":"",'><label for="').concat(o,'">').concat(n,"</label>"),append:"replace"})},[v,String]),b.onStartup(function(){return u(document).on("fullscreenchange",function(){u("input[type=checkbox][id^=fullscreen]",b.storyElement).each(function(e,t){(u(t).closest("tw-expression").data("fullscreenEvent")||Object)(t)})})}),n.addCommand("checkbox-fullscreen",function(){},function(e,t,n){var r="fullscreenCheckbox-"+ ++V;return e.data.fullscreenEvent=function(e){return u(e).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},e.data.checkboxEvent=function(){return a.toggleFullscreen()},C(e,{source:'<input id="'.concat(r,'" type="checkbox" ').concat(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ").concat(document.fullscreenElement||document.msFullscreenElement?"checked":"",'><label for="').concat(r,'">').concat(n,"</label>"),append:"replace"})},[String]),b.onStartup(function(){return b.storyElement.on("input.input-box-macro","textarea, input[type=text]",function(){var e=u(this),t=e.closest("tw-expression").data("inputBoxEvent");t&&t(e)})}),["input","force-input","input-box","force-input-box"].forEach(function(g){return n.addCommand(g,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g.endsWith("box"),a=v.isPrototypeOf(t[0]),o="string"==typeof t[+a],r=r&&"number"==typeof t[o+a],i=o?t[+a]:t[a+r],s=0<S(i).size,o=s?t[a+r+o]:i;return g.startsWith("force")&&"string"!=typeof o?y.create("datatype","The (".concat(g,":) macro requires a string of text to forcibly input.")):t.length>a+r+s+("string"==typeof o)?y.create("datatype","An incorrect combination of values was given to this (".concat(g,":) macro.")):void 0},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o=g.startsWith("force"),i=g.endsWith("box"),s=v.isPrototypeOf(r[0]),c="string"==typeof r[+s],l=i&&"number"==typeof r[c+s],u=s&&r[0],p=l?r[1+s]:3,d=c?S(r[+s]):{},f=d.marginLeft,d=d.size,h=(d?r[s+l+c]:c&&r[+s])||"",l=o?"":h,c=!1;if("two way"===u.bind){e.attr.push({"data-2bind":!0});s=u.varRef.get();if("string"==typeof s){l=o?h.slice(0,s.length):s,s=u.set(l),c=!0;if(y.containsError(s))return s}e.data.twoWayBindEvent=function(e,t,n){u.varRef.matches(t,n)&&"string"==typeof(t=u.varRef.get())&&e.find(i?"textarea":"input").val(o?h.slice(0,t.length):t)}}if(u&&!c){s=u.set(o?"":h);if(y.containsError(s))return s}!o&&u&&(e.data.inputBoxEvent=function(e){var t=e.val(),t=u.set(t);y.containsError(t)&&e.replaceWith(t.render(""))});var m,c="<".concat(i?"textarea":"input type=text",' style="width:100%" ').concat(i?"rows=".concat(p,">"):'value="').concat(b.escape(l)).concat(i?"</textarea>":'">');return o&&(m=Array.from(h),e.data.inputBoxEvent=function(e){var t=e.val().length,t=m.slice(0,t).join("");return e.val(t),u&&(t=u.set(t),y.containsError(t))&&e.replaceWith(t.render("")),!0}),e.styles.push({display:"block","margin-left":d?f+"%":void 0,width:d?d+"%":"100%","border-style":function(){return this.style.borderStyle||"solid"}}),C(e,{source:c,append:"replace"})},g.endsWith("box")?[_(v,String),x(_(A,String)),x(_(A,String)),x(String)]:[x(_(v,String)),x(String),x(String)])}),["show","rerun"].forEach(function(s){return n.addCommand(s,function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(o,i){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return t.forEach(function(e){return e.forEach(i,function(e){var t,n,r,a=e.data("hidden");void 0!==a!=("rerun"===s)&&(e.removeData("hidden"),a instanceof u?e.empty().append(a):(a=e.data("tempVariables"),n=(t="tw-passage"===e.tag())?l.getTree(c.passage):e.data("originalSource")||"",t&&(r=e.find("tw-sidebar").detach()),i.renderInto("",null,_objectSpread(_objectSpread({},o),{},{append:"replace",source:n,target:e}),a&&Object.create(a)),r&&e.prepend(r)))})}),o},[T(o)])});n.addCommand("hide",function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++)o[a].forEach(e,function(e){e.data("hidden")||e.data("hidden",e.contents().detach())})},[T(o)],!1)("scroll",P,function(m,e,g){var y="number"==typeof g&&g;requestAnimationFrame(function(){e.forEach(m,function(e){if(!1!==y){var t,n,r=e[0];null!=(t=(n=r=r===b.storyElement[0]&&r.scrollHeight===r.clientHeight?getComputedStyle(document.body).overflow.includes(" scroll")?document.body:document.documentElement:r).scrollTo)&&t.call(n,0,(r.scrollHeight-r.clientHeight)*y)}else{var a,o=_createForOfIteratorHelper(g.hooks(m).get());try{for(o.s();!(a=o.n()).done;){var i=a.value;if(e.find(i)){for(var s=[],c=e[0];(c=c.parentNode)&&c!==document.body;)s.push([c,c.scrollLeft,c.scrollTop]);i.scrollIntoView();for(var l=0,u=s;l<u.length;l++){var p=_slicedToArray(u[l],3),d=p[0],f=p[1],h=p[2];d.scrollLeft=f,d.scrollTop=h}break}}}catch(e){o.e(e)}finally{o.f()}}})})},[o,_(L,o)],!1)("stop",P,P,[],!1)("load-game",P,function(e,t){var n,r;return e.loadedGame?y.create("infinite","I can't use (load-game:) immediately after loading a game."):(n=localStorage.getItem(R("Saved Game")+t))?(n=c.deserialise(e,n))instanceof Error?{blocked:r=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+n.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===r.find("input").last().val()&&localStorage.removeItem(R("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]})}:void requestAnimationFrame(a.showPassage.bind(a,c.passage,{loadedGame:!0})):y.create("saving","I can't find a save slot named '"+t+"'!")},[String],!1)("forget-undos",P,function(e,t){c.futureLength||c.forgetUndos(t)},[parseInt],!1)("forget-visits",P,function(e,t){c.forgetVisits(t)},[parseInt],!1)("mock-visits",function(){if(!b.options.debug)return y.create("debugonly","(mock-visits:) cannot be used outside of debug mode.");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.find(function(e){return!l.hasValid(e)});return r?y.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];c.mockVisits=g(n)},[T(String)],!1)("mock-turns",function(){if(!b.options.debug)return y.create("debugonly","(mock-turns:) cannot be used outside of debug mode.")},function(e,t){c.mockTurns=t},[H],!1)("seed",P,function(e,t){c.setSeed(t)},[String],!1)(["dialog","alert"],function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(v.isPrototypeOf(e)){if("two way"===e.bind)return y.create("datatype","(dialog:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".');if(void 0===t)return y.create("datatype","(dialog:) needs a message string or codehook to display.")}else void 0!==t&&r.unshift(t);e=r.findIndex(function(e){return""===e});if(-1<e)return y.create("datatype","(dialog:)'s ".concat(b.nth(e+1)," link text shouldn't be an empty string."))},function(e,n,r,t){for(var a=arguments.length,o=new Array(4<a?a-4:0),i=4;i<a;i++)o[i-4]=arguments[i];return v.isPrototypeOf(r)||(void 0!==t&&o.unshift(t),t=r,r=void 0),o.length||(o=["OK"]),{blocked:k({section:n,message:t,cd:e,buttons:o.map(function(t){return{name:t,callback:function(){var e;n.unblock((null==(e=r)?void 0:e.set(t))||"")}}})})}},[_(v,String,t),x(_(t,String)),O(String)])("open-url",P,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],P,function(){if(!b.options.ignoreGotos){if(c.turns<=1)return y.create("infinite","I mustn't (restart:) the story in the starting passage.");c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()}},[],!1)("goto-url",P,function(e,t){window.location.assign(t)},[String],!1)("ignore",P,P,[O(F)])("assert-exists",function(e){if(""===e)return y.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?o.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:y.create("assertion","I didn't see any ".concat("string"==typeof n?"text occurrences of":"hooks matching"," ").concat(w(n)," in this passage."))},[_(o,String)]),n.add("assert","Instant",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:C(y.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game","Boolean",function(e,t,n){if(n=n||"",!c.hasStorage)return!1;var r=c.serialise(!1).pastAndPresent;if(y.containsError(r))return r;if(!1===r)return!1;try{return localStorage.setItem(R("Saved Game")+t,r),localStorage.setItem(R("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,x(String)])("prompt","String",function(e,t,n,r,a){var o,i;return null!=(o=e.stackTop)&&o.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===a?y.create("datatype","The text for (prompt:)'s confirm link can't be blank."):(i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})}),e.stackTop.blocked=i,0)},[_(String,t),String,x(String),x(String)])("confirm","Boolean",function(e,t,n,r){var a;return null!=(a=e.stackTop)&&a.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===r?y.create("datatype","The text for (confirm:)'s confirm link can't be blank."):(a=k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})}),e.stackTop.blocked=a,0)},[_(String,t),x(String),x(String)])("page-url","String",function(){return window.location.href},[])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(c,l,u,e,t,p,n,d,f){function s(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return f.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")}var h=e.objectName,m=e.toSource,e=l.add,r=l.addChanger,a=l.addCommand,o=l.TypeSignature,i=o.rest,g=o.either,y=o.Any,b=o.Everything,o=o.zeroOrMore;e("macro","CustomMacro",function(e){for(var t,n=[],r=arguments.length,a=new Array(1<r?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];for(t=0;t<a.length;t+=1){var i=t===a.length-1;if(d.isPrototypeOf(a[t])===i)return f.create("datatype","The "+(i?"":c.nth(a.length-t+1)+"-")+"last value given to (macro:) should be a "+(i?"code hook":"datatyped variable")+", not "+h(a[t]));if(!i){i="A custom macro";if(a[t].varRef.object===u.variables)return f.create("datatype",i+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(1<a[t].varRef.propertyChain.length)return f.create("datatype",i+"'s typed variables can't be properties inside a data structure.");if(a[t].datatype.rest&&t!==a.length-2)return f.create("datatype",i+" can only have one spread variable, and it must be its last variable.");var s=a[t].varRef.propertyChain[0];if(n.includes(s))return f.create("datatype",i+"'s typed variables can't both be named '"+s+"'.");n.push(s)}}return p.create(a.slice(0,-1),a[a.length-1])},[i(g(d,n))]);a(["output-data","out-data"],function(){},function(e,t){e=e.stack;return s("output-data",e,t)||{blocked:!0}},[y],!1),r(["output","out"],function(){return Object.assign(t.create("output",[]))},function(e,t){if(e.section){var n,r=e.section,a=r.stack,o=r.stackTop,i={};for(n in o.tempVariables)n.startsWith("TwineScript_")||(i[n]=o.tempVariables[n]);s("output",a,{changer:t,variables:i,hook:Array.isArray(e.source)?"["+e.source.map(function(e){return e.text}).join("")+"]":e.source}),e.output=!0,o.blocked=!0}},[]),a("error",function(e){if(!e)return f.create("datatype","This (error:) macro was given an empty string.")},function(e,t){e=e.stack;return s("error",e,f.create("user",t))||{blocked:!0}},[String],!1),e("partial","CustomMacro",function(e,a){for(var t=arguments.length,o=new Array(2<t?t-2:0),n=2;n<t;n++)o[n-2]=arguments[n];var r="string"!=typeof a&&a,i=!r&&a;if(!r){if(!l.has(i))return f.create("macrocall",'The macro name given to (partial:), "'.concat(a,"\", isn't the name of a built-in macro."));if("Metadata"===l.get(i).returnType)return f.create("macrocall","(partial:) can't be used with metadata macros such as (".concat(a,":)"))}var s="(partial:".concat(m(a),",").concat(o.map(function(e){return m(e)}),")"),c=p.createFromFn(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=l["string"==typeof a?"run":"runCustom"](a,e,o.concat(n));return f.containsError(e)&&(e.message="An error occurred while running the (partial:)-created macro, ".concat(c.TwineScript_ObjectName,":\n")+e.message),e},"a (partial:) custom macro of ".concat(i||r.TwineScript_KnownName?"(".concat(i||r.TwineScript_KnownName,":").concat(o.map(function(e){return m(e)}),")"):"another unnamed custom macro"),function(){return s},(i?l.get(i):r).typeSignature.filter(function(e,t){return t>=o.length||"rest"===e.pattern||"zero or more"===e.pattern}));return c},[g(String,p),o(b)])}),define("macrolib/datastructures",["utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/typedvar","internaltypes/twineerror"],function(e,i,t,n,s,r,a,c,o,l){var u=e.permutations,p=e.options,d=n.objectName,f=n.subset,h=n.collectionType,m=n.isValidDatamapName,g=n.is,y=n.unique,b=n.clone,v=n.range,e=t.TypeSignature,n=e.optional,w=e.rest,k=e.either,S=e.zeroOrMore,T=e.Any,e=e.nonNegativeInteger,_=i("en");t.add(["a","array"],"Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},S(k(o,T)))("range","Array",function(e,t,n){return v(t,n)},[parseInt,parseInt])("subarray","Array",function(e,t,n,r){return f(t,n,r)},[Array,parseInt,parseInt])("reversed","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(b)},S(T))("shuffled","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.shuffled.apply(s,n).map(b)},[S(T)])("sorted","Array",function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(!c.isPrototypeOf(r[0]))return(t=r.filter(function(e){return"string"!=typeof e&&"number"!=typeof e}))&&t.length?1===t.length&&Array.isArray(t[0])?l.create("macrocall","Please give multiple numbers or strings to (sorted:), not a single array.","You can use the spread ... syntax to spread out the array's values into (sorted:)."):l.create("datatype","If (sorted:) isn't given a 'via' lambda, it must be given only numbers and strings, not ".concat(d(t[0]),".")):r.sort(_);var o=r.shift();if("making"in o||"where"in o||"when"in o||!("via"in o))return l.create("datatype","The optional lambda given to (sorted:) must be a 'via' lambda, not ".concat(d(o),"."));for(var i=0;i<r.length;i+=1){var s=o.apply(e,{loop:r[i],pos:i+1});if(l.containsError(s))return s;if("string"!=typeof s&&"number"!=typeof s)return l.create("datatype",'The "via" lambda given to (sorted:) couldn\'t convert '.concat(d(r[i])," into a string or number."));r[i]=[r[i],s]}return r.sort(function(e,t){return _(e[1],t[1])}).map(function(e){return e[0]})},[S(T)])("rotated","Array",function(e,t){if(0===t)return l.create("macrocall","I can't rotate these values by 0 positions.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=-1*(t=Math.abs(t)%r.length*Math.sign(t));return r.slice(t).concat(r.slice(0,t)).map(b)},[parseInt,S(T)])("rotated-to","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)?t:t.length?(e=r.indexOf(t[0]),r.slice(e).concat(r.slice(0,e)).map(b)):l.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.")},[c.TypeSignature("where"),w(T)])("repeated","Array",function(e,t){for(var n=[],r=arguments.length,a=new Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];if(!a.length)return n;for(;0<t--;)n.push.apply(n,a);return n.map(b)},[e,w(T)])("interlaced","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),o=[],i=0;i<a;i+=1)for(var s=0;s<n.length;s+=1)o.push(b(n[s][i]));return o},[Array,w(Array)])("permutations","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?u.apply(void 0,n):[]},[S(T)])("unique","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.filter(y)},[S(T)])("altered","Array",function(n,r){for(var e=arguments.length,t=new Array(2<e?e-2:0),a=2;a<e;a++)t[a-2]=arguments[a];return t.map(function(e,t){t=r.apply(n,{loop:e,pos:t+1});return null===t?e:t})},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),S(T)])("find","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),S(T)])(["all-pass","pass"],"Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||t.length===r.length},[c.TypeSignature("where"),S(T)])("some-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0<t.length},[c.TypeSignature("where"),S(T)])("none-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0===t.length},[c.TypeSignature("where"),S(T)])("folded","Any",function(r,a){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return"where"in a&&(t=[t[0]].concat(_toConsumableArray(a.filter(r,t.slice(1))))),l.containsError(t)||t.reduce(function(e,t,n){return a.apply(r,{making:e,loop:t,pos:n+1})})},[k(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),w(T)])(["dm-names","datamap-names","datanames"],"Array",function(e,t){return Array.from(t.keys()).sort(i("en"))},[Map])(["dm-values","datamap-values","datavalues"],"Array",function(e,t){return Array.from(t.entries()).sort(i("en",function(e){return String(e[0])})).map(function(e){return b(e[1])})},[Map])(["dm-entries","datamap-entries","dataentries"],"Array",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",b(e[1])]])})},[Map])(["dm-altered","datamap-altered"],"Datamap",function(a,o,e){return Array.from(e.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).reduce(function(e,t,n){if(!l.containsError(e)){var r=new Map([["name",t[0]],["value",b(t[1])]]),r=o.apply(a,{loop:r,pos:n+1});if(l.containsError(r))return r;e.set(t[0],null===r?t[1]:r)}return e},new Map)},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),Map])("history","Array",function(e,t){var n=s.history();return t?(t=t.filter(e,n.map(function(e){return a.get(e)})),l.containsError(t)?t:t.map(function(e){return e.get("name")})):n},[n(c.TypeSignature("where"))])("visited","Boolean",function(e,t){var n;return"string"==typeof t?a.has(t)?0<s.passageNameVisited(t)||s.passage===t:l.create("macrocall","There's no passage named '"+t+"' in this story."):(n=s.history(),n=t.filter(e,n.concat(s.passage).map(function(e){return a.get(e)})),l.containsError(n)?n:0<n.length)},[k(String,c.TypeSignature("where"))])("passage","Datamap",function(e,t){return b(a.get(t||s.passage))||l.create("macrocall","There's no passage named '"+t+"' in this story.")},[n(String)])("passages","Array",function(e,t){var n=i("en"),r=_toConsumableArray(a.values()).map(function(e){return b(e)}),t=t?t.filter(e,r):r,e=l.containsError(t);return e||t.sort(function(e,t){return n(e.get("name"),t.get("name"))})},[n(c.TypeSignature("where"))])("open-storylets","Array",function(e,t){return e.stackTop.evaluateOnly?l.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+"."):(e=a.getStorylets(e,t),l.containsError(e)||e.map(b))},[n(c.TypeSignature("where"))])("savedgames","Datamap",function(){function e(e){return"("+e+" "+p.ifid+") "}var t,n,r=0,a=new Map;do{if(!s.hasStorage)break;t=localStorage.key(r),r+=1;var o=e("Saved Game")}while(null!=(n=t)&&n.startsWith(o)&&(t=t.slice(o.length),a.set(t,localStorage.getItem(e("Saved Game Filename")+t))),t);return a},[])(["datamap","dm"],"Datamap",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!l.containsError(e))if(void 0===r)r=t;else{if(n=l.containsError(m(a,r)))return n;if(a.has(r))return l.create("macrocall","You used the same data name ("+d(r)+") twice in the same (datamap:) call.");a.set(r,b(t)),r=void 0}return e},!0);return l.containsError(i)?i:void 0!==r?l.create("macrocall","This datamap has a data name without a value."):a},S(k(o,T)))(["dataset","ds"],"Dataset",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(y).map(b))},S(T))("count","Number",function t(n,r){for(var e,a=arguments.length,o=new Array(2<a?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];if(1<o.length)return e=o.map(function(e){return t(n,r,e)}),l.containsError(e)||e.reduce(function(e,t){return e+t},0);var s=o[0];switch(h(r)){case"dataset":case"datamap":return l.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof s?l.create("macrocall",d(r)+" can't contain  "+d(s)+" because it isn't also a string."):s?r.split(s).length-1:0;case"array":return r.reduce(function(e,t){return e+g(t,s)},0);default:return l.create("macrocall",d(r)+" can't contain values, let alone "+d(s)+".")}},[T,w(T)])}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/codehook","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(c,r,e,l,s,n,u,p,a,d,t,i,f,h){var m=e.is,e=u.TypeSignature,g=e.either,y=e.rest,o=e.optional,b=Object.assign;function v(e,t){if(d.isPrototypeOf(t)&&!t.canEnchant)return h.create("datatype","The changer given to (".concat(e,":) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."))}["enchant","change"].forEach(function(o){u.addCommand(o,function(e,t){t=v(o,t);if(t)return t},function(t,n,e){n=p.from(n);var r,a=[];return d.isPrototypeOf(e)&&(r=i.create({section:t}),e.run(r),0<(r.innerEnchantments||[]).length)&&(r=r.innerEnchantments.map(function(e){return e(n)}),a.push.apply(a,_toConsumableArray(r))),a.push(f.create(_defineProperty(_defineProperty({scope:n},d.isPrototypeOf(e)?"changer":"lambda",e),"section",t))),a.forEach(function(e){"enchant"===o?(t.addEnchantment(e),t.updateEnchantments()):e.enchantScope()}),""},[g(p,String),g(d,t.TypeSignature("via"))],!1)}),u.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||d.create("enchant-in",[t,n])},function(t,n,r){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:p.from(n),localHook:e},d.isPrototypeOf(r)?"changer":"lambda",r),"section",t.section))}),t},[g(p,String),g(d,t.TypeSignature("via"))]),[["link-style",p.create({type:"name",data:"link"})],["line-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"lines",void 0)],["char-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var e=_slicedToArray(e,2),r=e[0],a=e[1];u.addChanger(r,function(e,t){var n=v(r,t);return n||d.create(r,[t])},function(t,n){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:a,localHook:e},d.isPrototypeOf(n)?"changer":"lambda",n),"section",t.section))}),t},[g(d,t.TypeSignature("via"))])});e=["replace","append","prepend"];function w(i,s){return r.onStartup(function(){var e=i.classList.replace(/ /g,"."),t=i.blockClassList?i.blockClassList.replace(/ /g,"."):"",n="."+e+(t?",."+t:"");r.storyElement.on(i.event.map(function(e){return e+".enchantment"}).join(" "),n,function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents(n).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})}),[function(e,t,n){if(!t)return h.create("datatype","A string given to this ("+s+":) macro was empty.");if(n){var r=v(s,n);if(r)return r}return d.create(s,[p.from(t)].concat(n?[n]:[]))},function(t,e,n){t.enabled=!1,t.transitionDeferred=!0,i.rerender&&(t.newTargets=(t.newTargets||[]).concat({target:e,append:i.rerender}));var r,a=null!=(r=t.section)&&r.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=f.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(e.children().css("display"))?i.blockClassList:i.classList),e.attr({tabIndex:"0"})}],data:{enchantmentEvent:function(){var e;null!=(e=t.section.stackTop)&&e.blocked||(i.once&&t.section.removeEnchantment(o),i.goto?l.goToPassage(i.goto,{transition:i.transition}):i.undo?l.goBack({transition:i.transition}):t.section.renderInto(t.source,null,_objectSpread(_objectSpread({},t),{},{append:i.once?"append":"replace",enabled:!0,transitionDeferred:!1}),a))}},scope:e,section:t.section,name:s},d.isPrototypeOf(n)?"changer":"lambda",n));return t.section&&(t.section.addEnchantment(o),o.enchantScope()),t},[g(p,String),o(g(d,t.TypeSignature("via")))]]}e.forEach(function(o){u.addChanger(o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.every(Boolean)?d.create(o,n.map(p.from),null,!1):h.create("datatype","A string given to this (".concat(o,":) macro was empty."))},function(e){var t;0<c(e.target).parents().filter("tw-collapsed,[collapsing=true]").length||e.attr.some(function(e){return e.collapsing})||(e.attr=[].concat(_toConsumableArray(e.attr),[{collapsing:!1}])),e.newTargets=e.newTargets||[];for(var n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=e.newTargets).push.apply(t,_toConsumableArray(r.filter(function(n){return!e.newTargets.some(function(e){var t=e.target,e=e.append;return m(n,t)&&o===e})}).map(function(e){return{target:e,append:o,before:!0}}))),e},y(g(p,String)))(o+"-with",function(e,t){return d.create(o+"-with",[t],null,!1)},function(e,t){return a.isPrototypeOf(t)&&(t=t.code),e.appendSource=(e.appendSource||[]).concat({source:t,append:o}),e},g(a,String))});var k="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}},{name:"doubleclick",enchantDesc:{event:["dblclick"],once:!0,rerender:"",classList:"link enchantment-dblclick",blockClassList:"enchantment-dblclickblock"}}];S.forEach(function(e){"doubleclick"!==e.name&&(u.addChanger.apply(u,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name)))),"click"===e.name)&&u.addChanger.apply(u,[e.name+"-rerun"].concat(_toConsumableArray(w(_objectSpread(_objectSpread({},e.enchantDesc),{},{once:!1}),e.name+"-rerun"))))}),r.onStartup(function(){S.forEach(function(e){var n=e.enchantDesc;n.blockClassList&&r.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents("."+n.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})})}),e.forEach(function(n){S.forEach(function(e){var t;"doubleclick"!==e&&(t=_objectSpread(_objectSpread({},e.enchantDesc),{},{rerender:n}),e=e.name+"-"+n,u.addChanger.apply(u,[e].concat(_toConsumableArray(w(t,e)))))})}),S.forEach(function(i){"doubleclick"!==i&&["goto","undo"].forEach(function(a){var o=i.name+"-"+a;u.addCommand(o,function(e,t){return!e||!t&&"goto"===a?h.create("datatype","A string given to this ("+o+":) macro was empty."):"goto"!==a||n.hasValid(t)?void 0:h.create("macrocall","I can't ("+o+":) the passage '"+t+"' because it doesn't exist.")},function(e,t,n,r){return"undo"===a&&s.pastLength<1?h.create("macrocall","I can't (undo:) on the first turn."):((0,_slicedToArray(w(_objectSpread(_objectSpread({},i.enchantDesc),{},{transition:e.data.passageT8n},"undo"===a?{undo:!0}:{goto:r}),o),2)[1])({section:t},p.from(n)),b(e,{source:""}))},[g(p,String)].concat("undo"===a?[]:String))})})}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(i,e,c,l,u,p,a,d,t,f,h){var n=e.TypeSignature,r=n.optional,o=n.rest,n=n.either,m=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],g=Object.assign;function s(e,t,n){n=n||t;var r,a=u.hasValid(t)&&t===n,e=e.evaluateTwineMarkup(c.unescape(n),"a link's passage name");return a?t=(a=0<e.children().length?"`".repeat((n.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"")+"\0".repeat(!!a)+t+"\0".repeat(!!a)+a:(e.findAndFilter("tw-error").length&&(r=e.findAndFilter("tw-error").data("TwineError")),n=e.text()),{text:t,passage:n,error:r}}c.onStartup(function(){var e="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;function t(e){var t=i(this),n=t.closest("tw-expression"),r=t.closest("tw-expression, tw-hook"),a=r.data("clickEvent"),r=r.data("section");if((!c.options.debug||!c.options.ignoreClickEvents||t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *"))&&!t.is("tw-open-button")&&(null==r||!r.stackTop||!r.stackTop.blocked||r.stackTop.blocked instanceof i&&r.stackTop.blocked.find(t).length)){if(a)return 0<t.find("tw-error").length?void 0:(e.stopPropagation(),void a(t));var r=n.data("linkPassageName"),o=_objectSpread({},n.data("passageT8n")||{});n.find("tw-enchantment").each(function(e,t){Object.assign(o,i(t).data("passageT8n")||{})}),r?(e.stopPropagation(),p.goToPassage(r,{transition:o})):t.is("[undo]")?(e.stopPropagation(),p.goBack({transition:o})):t.is("[fullscreen]")&&(e.stopPropagation(),p.toggleFullscreen())}}c.storyElement.on("click.passage-link","tw-link"+(e?"":":not(.enchantment-mouseover):not(.enchantment-mouseout):not(.enchantment-dblclick)"),t).on("mouseover.passage-link","tw-link.enchantment-mouseover, tw-expression.enchantment-mouseover > tw-link",t).on("mouseout.passage-link","tw-link.enchantment-mouseout, tw-expression.enchantment-mouseout > tw-link",t).on("dblclick.passage-link","tw-link.enchantment-dblclick, tw-expression.enchantment-dblclick > tw-link",t),i(document).on("fullscreenchange",function(){i("tw-link[fullscreen]",c.storyElement).each(function(e,t){(i(t).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(t)})})}),[["link","link-replace"],["link-reveal","link-append"],["link-repeat"],["link-rerun"]].forEach(function(s){return e.addChanger(s,function(e,t,n){return t?n&&!n.canEnchant?h.create("datatype","The changer given to (".concat(s[0],":) can't be (or include) a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")):a.create(s[0],[t].concat(n||[]),null,!0):h.create("datatype",m[0])},function(r,e,t){var n,a=s[0],o=null!=(n=r.section)&&n.stackTop?r.section.stackTop.tempVariables:Object.create(null),i=d.create({source:"<tw-link tabindex=0>"+e+"</tw-link>",target:function(){return r.target},append:"replace",data:{section:r.section,clickEvent:function(e){r.enablers=r.enablers.filter(function(e){return e.descriptor!==i}),"link-reveal"===a&&e.contents().unwrap();var t,n=e.parentsUntil(":not(tw-enchantment)").parent();n.length||(n=e.parent()),"link-rerun"===a&&(t=e.parentsUntil(":not(tw-enchantment)"),e.detach(),t.remove()),"link"!==a&&"link-rerun"!==a||n.empty(),r.section.renderInto("",null,r,o),"link-rerun"===a&&n.prepend(e)}}});return r.enablers=(r.enablers||[]).concat({descriptor:i,changer:t}),r},[String,r(a)])}),e.addCommand("link-goto",function(e){if(!e)return h.create.apply(h,["datatype"].concat(m))},function(e,t,n,r){var a,o=s(t,n,r);return n=o.text,r=o.passage,(o=o.error)||(e.transition?h.create("datatype","Please attach ("+(o="transition")+"-depart:) or ("+o+"-arrive:) to a passage link, not ("+o+":)."):(a=(a=u.hasValid(r)?a:'<tw-broken-link passage-name="'+c.escape(r)+'">'+n+"</tw-broken-link>")||"<tw-link tabindex=0 "+(0<l.passageNameVisited(r)?'class="visited" ':"")+">"+n+"</tw-link>",e.data.linkPassageName=r,e.data.section=t,g(e,{source:a,transitionDeferred:!0})))},[String,r(String)])("link-storylet",function(){var e=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1)<0||arguments.length<=e?void 0:arguments[e];if(!e||"string"==typeof e)return h.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n=(n=2+("string"==typeof(arguments.length<=2?void 0:arguments[2])?1:0))<2||arguments.length<=n?void 0:arguments[n],r="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),a=((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a])!==n&&((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a]);if(e.transition)return h.create("datatype","Please attach (".concat(o="transition","-depart:) or (").concat(o,"-arrive:) to (link-storylet:), not (").concat(o,":)."));var o=f.isPrototypeOf(n),i=u.getStorylets(t,o&&n),s=h.containsError(i);if(s)return s;var c,s=i[o?0:n<0?i.length+n:n-1];if(s)s=s.get("name"),r=r||s,c=c||"<tw-link tabindex=0 "+(0<l.passageNameVisited(s)?'class="visited" ':"")+">"+r+"</tw-link>",e.data.linkPassageName=s,e.data.section=t;else{if(!a)return e;c=a}return g(e,{source:c,transitionDeferred:!0})},[n(parseInt,String,f.TypeSignature("where")),r(n(parseInt,String,f.TypeSignature("where"))),r(String)])("link-undo",function(e){if(!e)return h.create("datatype",m[0])},function(t,e,n){var r,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";return l.pastLength<1?g(t,{source:a}):(r=(t.data.section=e).stackTop.tempVariables,t.data.forgetUndosEvent=function(){return t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a,transitionDeferred:!1});t.section.renderInto("",null,e,r)})},g(t,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String,r(String)])("link-show",function(e){if(!e)return h.create("datatype",m[0])},function(r,a,e){for(var t=arguments.length,n=new Array(3<t?t-3:0),o=3;o<t;o++)n[o-3]=arguments[o];return r.data.section=a,r.data.clickEvent=function(e){e.contents().unwrap(),n.forEach(function(e){return e.forEach(a,function(e){var t=e.data("originalSource")||"",n=e.data("hidden");n&&(e.removeData("hidden"),n instanceof i?e.empty().append(n):(n=e.data("tempVariables"),a.renderInto("",null,_objectSpread(_objectSpread({},r),{},{source:t,target:e,transitionDeferred:!1}),n&&Object.create(n))))})})},g(r,{source:"<tw-link tabindex=0>"+e+"</tw-link>",transitionDeferred:!0})},[String,o(t)])("link-fullscreen",function(e,t){if(!e||!t)return h.create("datatype",m[0])},function(t,e,n,r){function a(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""}var o=e.stackTop.tempVariables;return t.data.section=e,t.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a(),transitionDeferred:!1});t.section.renderInto("",null,e,o)})},g(t,{source:a(),transitionDeferred:!0})},[String,String,r(String)]),e.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return h.create.apply(h,["datatype"].concat(m));if(a.isPrototypeOf(n)){if(a.isPrototypeOf(r))return h.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}return r&&!r.canEnchant?h.create("datatype","The changer given to (link-reveal-goto:) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."):(t=(e=s(e,t,n)).text,n=e.passage,e.error||a.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}),null,!1))},function(t,e,n,r){var a,o,i,s;if(u.hasValid(n))return o=l.passageNameVisited(n),i=null!=(a=t.section)&&a.stackTop?t.section.stackTop.tempVariables:Object.create(null),s=d.create({source:"<tw-link tabindex=0 "+(0<o?'class="visited" ':"")+">"+e+"</tw-link>",target:t.target,append:"replace",data:{section:t.section,append:"replace",clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==s}),e.contents().unwrap(),t.section.renderInto("",null,t,i),t.section.whenUnblocked(function(){return p.goToPassage(n,{transition:t.data.passageT8n})})}}}),t.enablers=(t.enablers||[]).concat({descriptor:s,changer:r}),t;t.source='<tw-broken-link passage-name="'+c.escape(n)+'">'+e+"</tw-broken-link>"},[String,r(n(a,String)),r(a)])}),define("macrolib/metadata",["macros","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(t,e,n,s){function c(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}}var l=e.clone,u=e.objectName,p=e.isValidDatamapName,e=t.TypeSignature,r=e.zeroOrMore,e=e.Any;[["storylet",n.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(e){var e=_slicedToArray(e,2),n=e[0],e=e[1];t.add(n,"Metadata",function(e,t){return e.stackTop.speculativePassage?t:c(n)},e)}),t.add("metadata","Metadata",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!s.containsError(e))if(void 0===r)r=t;else{if(n=s.containsError(p(a,r)))return n;if(a.has(r))return s.create("macrocall","You used the same data name ("+u(r)+") twice in the same (metadata:) call.");a.set(r,l(t)),r=void 0}return e},!0);return s.containsError(i)?i:void 0!==r?s.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?a:c("metadata")},r(e))}),define("macrolib/patterns",["macros","utils","utils/operationutils","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror","internaltypes/varscope"],function(e,t,n,y,b,h,v,w){function k(e){var r,t,a=e.name,n=e.fullArgs,o=e.args,i=e.makeRegExpString,s=void 0===i?function(e){return e.join("")}:i,c=void 0!==(i=e.insensitive)&&i,l=void 0===(i=e.canContainTypedVars)||i,u=void 0===(i=e.canBeUsedAlone)||i,p=void 0===(i=e.canContainTypedGlobals)||i,d=o||n,f=E(null),e=d.map(function e(t){if(h.isPrototypeOf(t)){var n=t.varRef;if(!l)return v.create("operation","Optional string patterns, like (".concat(a,":)").concat("p-many"===a?" with a minimum of 0 matches":"",", can't have typed variables inside them."));if(!p&&!w.isPrototypeOf(n.object))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"));n=n.getName();if(n in f)return v.create("operation","There's already a typed temp variable named _".concat(n," inside this (").concat(a,":) call."));f[n]=!0;n=e(t.datatype);return v.containsError(n)?n:"("+n+")"}if(b.isPrototypeOf(t)){if(!(l&&p||"function"!=typeof t.typedVars)){n=t.typedVars();if(!l&&n.length)return v.create("operation","(".concat(a,":) can't have typed variables inside its pattern."));if(!p&&n.some(function(e){return!w.isPrototypeOf(e.varRef.object)}))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"))}var r;return t.regExp?(t.rest?"(?:":"")+(c?t.insensitive():t).regExp+(t.rest?")*":""):(n=t.name,r=t.rest?"*":"","alnum"===n?m+r:"whitespace"===n?_+r:"uppercase"===n?(c?T:g)+r:"lowercase"===n?(c?T:S)+r:"anycase"===n?T+r:"digit"===n?"\\d"+r:"linebreak"===n?"(?:\\r|\\n|\\r\\n)"+r:"str"===n?".*?":["even","odd","int","num"].includes(n)?v.create("datatype","Please use string datatypes like 'digit' in (".concat(a,":) instead of number datatypes.")):v.create("datatype","The (".concat(a,":) macro must only be given string-related datatypes, not ").concat(O(t),".")))}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),c?t.replace(RegExp("(".concat(g,"|").concat(S,")"),"g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"}):t):(x("createPattern","mapper() was given a non-string non-datatype "+t),"")});return(i=v.containsError(e))||(r=s(e),t=C(E(b),{name:a,regExp:r,insensitive:function(){return c?t:k({name:a,fullArgs:n,args:d.map(function(e){return b.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:s,insensitive:!0,canContainTypedVars:l,canBeUsedAlone:u})},typedVars:function(){return d.reduce(function(e,t){return h.isPrototypeOf(t)&&(e=e.concat(c?h.create(k({name:"p-ins",fullArgs:[t.datatype],insensitive:!0}),t.varRef):t),t=t.datatype),e=b.isPrototypeOf(t)&&"function"==typeof t.typedVars?e.concat(t.typedVars()):e},[])},destructure:function(e){var n,t;return"string"!=typeof e?[v.create("operation","I can't put ".concat(O(e)," into ").concat(this.TwineScript_ToSource()," because it isn't a string."))]:(n=this.typedVars()).length?(t=(RegExp("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$").exec(e)||[]).slice(1)).length?t.map(function(e,t){t=n[t];if(t)return t.datatype.rest&&!t.datatype.regExp&&((t=t.TwineScript_Clone()).datatype=k({name:"p",fullArgs:[t.datatype]})),{dest:t,value:e||"",src:void 0}}).filter(Boolean):[v.create("operation","I can't put ".concat(O(e)," because it doesn't match the pattern ").concat(this.TwineScript_ToSource(),"."))]:[]},TwineScript_IsTypeOf:function(e){return u?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$"):v.create("operation","A (".concat(a,":) datatype must only be used with a (p:) macro."))},TwineScript_toTypeSignatureObject:function(){var t=this;return{pattern:"range",name:a,range:function(e){return t.TwineScript_IsTypeOf(e)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+a+":"+n.map(A)+")"}}),Object.defineProperty(t,"TwineScript_ObjectName",{get:function(){return"a (".concat(a,":) datatype")}}),t)}var m=t.anyRealLetter,g=t.anyUppercase,S=t.anyLowercase,T=t.anyCasedLetter,_=t.realWhitespace,x=t.impossible,O=n.objectName,A=n.toSource,t=e.TypeSignature,n=t.rest,r=t.either,a=t.optional,t=t.nonNegativeInteger,C=Object.assign,E=Object.create,o=n(r(String,b,h));e.add(["p","pattern"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p",fullArgs:n})},o)(["p-either","pattern-either"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},o)(["p-opt","pattern-opt","p-optional","pattern-optional"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},o)(["p-not","pattern-not"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==_toConsumableArray(e).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?v.create("datatype","(p-not:) should only be given single characters, or datatypes that match single characters"):k({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},o)(["p-not-before","pattern-not-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-not-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?!"+e.join("")+")"}})},o)(["p-before","pattern-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?="+e.join("")+")"}})},o)(["p-start","pattern-start"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-start",fullArgs:n,makeRegExpString:function(e){return"^(?:"+e.join("")+")"}})},o)(["p-end","pattern-end"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-end",fullArgs:n,makeRegExpString:function(e){return"(?:"+e.join("")+")$"}})},o)(["p-many","pattern-many"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i,s=n.slice();return"number"==typeof n[0]&&(a=n.shift(),o="number"==typeof n[0]?n.shift():1/0),!(void 0!==o&&o<a)&&n.length?(i=n.find(function(e){return"string"!=typeof e&&!b.isPrototypeOf(e)&&!h.isPrototypeOf(e)}))?v.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+O(i)+"."):k({name:"p-many",args:n,fullArgs:s,canContainTypedVars:0<a,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==a?"{"+a+(o===1/0?",":o!==a?","+o:"")+"}":"+")}}):v.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.")},[n(r(t,String,b,h))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-ins",fullArgs:n,insensitive:!0})},o)(["split","splitted"],"Array",function(e,t,n){if(t=k({name:"split",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t))return t;if(!n)return[""];if(!t.regExp)return _toConsumableArray(n);for(var r,a=RegExp(t.regExp),o=[];n&&(r=a.exec(n));){if(r.index+r[0].length===0)return o;o.push(n.slice(0,r.index)),n=n.slice(r.index+r[0].length)}return o.concat(n||[])},[r(String,b),String])("trimmed","String",function(e,t,n){return void 0===n||b.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=k({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[r(String,b),a(String)])(["str-find","string-find"],"String",function(e,t,n){if(t=k({name:"str-find",fullArgs:[t],canContainTypedGlobals:!1}),v.containsError(t))return t;for(var r,a=t.typedVars(),o=RegExp(t.regExp,"g"),i=[],s=o.lastIndex;(r=o.exec(n))&&s!==o.lastIndex;)if(s=o.lastIndex,a.length){for(var c=new Map,l=0;l<a.length;l+=1){if("match"===a[l].varRef.getName())return v.create("macrocall","There was a typed temp variable named _match in the pattern given to (str-find:)","The variable _match is reserved, and can't be used inside (str-find:)'s pattern.");c.set(a[l].varRef.getName(),r[l+1]),c.set("match",r[0])}i.push(c)}else i.push(r[0]);return i},[b,String])(["str-replaced","string-replaced","replaced"],"String",function(e,t,n,r,a){if("number"!=typeof t){if(void 0!==a)return v.create("macrocall","1 too many values were given to (str-replaced:).","If this is given 5 values, the first value must be a number of replacements.");a=r,r=n,n=t,t=1/0}else if(void 0===a)return v.create("macrocall","The (str-replaced:) macro needs 1 more value.","The final string seems to be missing.");if(b.isPrototypeOf(r))return v.create("datatype","The replacement value for (str-replaced:) must be a string or lambda, not ".concat(O(r)));if(y.isPrototypeOf(a)||y.isPrototypeOf(n))return v.create("datatype","The ".concat(y.isPrototypeOf(a)?"final string":"search pattern"," given to (str-replaced:) can't be a lambda."),"Only the replacement value (after the search pattern) can be a 'via' lambda.");if(n=k({name:"str-replaced",fullArgs:[n],canContainTypedGlobals:!1}),v.containsError(n))return n;if(!n.regExp)return a;for(var o,i=RegExp(n.regExp,"g"),s=y.isPrototypeOf(r)?n.typedVars():[],c=1,l=0,u="",p=i.lastIndex;a&&(o=i.exec(a))&&0<t&&p!==i.lastIndex;){for(var p=i.lastIndex,d=Object.create(e.stack.length?e.stackTop.tempVariables:w),f=0;f<s.length;f+=1){var h=s[f],m=h.varRef.create(d,h.varRef.propertyChain);if(v.containsError(m))return m;h=m.defineType(h.datatype);if(v.containsError(h))return h;m.set(o[f+1])}var g=y.isPrototypeOf(r)?r.apply(e,{loop:o[0],pos:c,tempVariables:d}):r;if(v.containsError(g))return g;if("string"!=typeof g)return v.create("datatype","(str-replaced:)'s lambda must produce a string, but it produced ".concat(O(g),' when given "').concat(o[0],'".'));u+=a.slice(l,o.index)+g,c+=1,--t,l=o.index+o[0].length}return u+=a.slice(l)},[r(t,String,b),r(b,String,y.TypeSignature("via")),r(String,y.TypeSignature("via")),a(String)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(s,e,c,t,a,n,r,o,i,l,u){var p,d,f=t.geomParse,h=t.geomStringRegExp,m=Object.assign,t=e.TypeSignature,g=t.either,y=t.wrapped,b=t.optional,v=t.Any,w=t.Everything,k=t.zeroOrMore,S=t.rest,T=t.insensitiveSet,_=t.positiveNumber,x=t.positiveInteger,O=t.nonNegativeNumber,t=t.percent,y=[y(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')],A=(c.onStartup(function(){return c.storyElement.on("mouseenter.hover-macro","[hover=false]",function(){var e=s(this),t=e.data("hoverChanger");c.options.debug&&c.options.ignoreClickEvents&&!e.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||(e.data({mouseoutStyle:e.attr("style")||""}),l.create({target:e},t).update(),e.attr("hover",!0))}).on("mouseleave.hover-macro","[hover=true]",function(){var e=s(this),t=e.data("mouseoutStyle");e.attr("style",t).removeData("mouseoutStyle").attr("hover",!1)})}),u.on(function(){s("tw-expression, tw-hook",c.storyElement).each(function(e,t){((t=s(t)).data("errorEvent")||Object)(t)})}),T("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur")),C=T("dotted","dashed","solid","double","groove","ridge","inset","outset","none");e.addChanger("if",function(e,t){return o.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},y)("unless",function(e,t){return o.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},y)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?o.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):u.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},y)("else",function(e){return"lastHookShown"in e.stack[0]?o.create("else",[!1===e.stack[0].lastHookShown]):u.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return o.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return o.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return o.create("live",t?[t]:[])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={delay:t}},b(Number))("event",function(e,t){return o.create("event",[t])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:t}},i.TypeSignature("when"))("more",function(){return o.create("more")},function(e){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return 0!==e.Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return o.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,n){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return c.anyInputDown()&&n&&(t-=n),e.Identifiers.time>t?[!0]:[]}}}},[_,b(O)])("after-error",function(){return o.create("after-error",[])},function(n){n.enabled=!1,n.transitionDeferred=!0;var r=n.section.stackTop.tempVariables;n.data.errorEvent=function(e){e.removeData("errorEvent");var t=_objectSpread(_objectSpread({},n),{},{enabled:!0,transitionDeferred:!1});t.data&&(t.data.errorEvent=void 0),n.section.whenUnblocked(function(){return n.section.renderInto("",null,t,r)})}},[])("hook",function(e,t){var n;return t?(n=c.insensitiveName(t))?o.create("hook",[n]):u.create("datatype",'The string given to (hook:), "'.concat(t,'", contained only dashes and underscores.')):u.create("datatype","The string given to (hook:) was empty.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){if(!t.loop)return u.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return o.create("for",[t].concat(r))},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o,i=t.filter(e.section,r);if(o=u.containsError(i))return o;e.loopVars[t.loop.getName()]=i||[]},[i.TypeSignature("where"),k(v)])(["transition","t8n"],function(e,t){return o.create("transition",[c.insensitiveName(t)])},function(e,t){return"zoom"===(e.transition=t)&&(e.transitionOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-time","t8n-time"],function(e,t){return o.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=m(e.data.passageT8n||{},{time:t}),e},[_])(["transition-delay","t8n-delay"],function(e,t){return o.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return o.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[_])(["transition-depart","t8n-depart"],function(e,t){return o.create("transition-depart",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{depart:t}),"zoom"===t&&(e.data.passageT8n.departOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-arrive","t8n-arrive"],function(e,t){return o.create("transition-arrive",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{arrive:t}),"zoom"===t&&(e.data.passageT8n.arriveOrigin=function(){var e=s(this),t=e.offset(),n=t.left,t=t.top,r=e.height();return{"transform-origin":100*(c.mouseCoords.x-n)/e.width()+"% "+100*(c.mouseCoords.y-t)/r+"%",height:r+"px"}}),e},[A])("button",function(e,t){return void 0===t||f(t).size?o.create("button",t?[t]:[]):u.create("datatype",'The string given to (button:) should be a sizing line ("==X==", "==X", "=XXXX=" etc.), not '.concat(JSON.stringify(t),"."))},function(e,t){var t=f(t),n=t.marginLeft,t=t.size;return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(0<this.className.length)+"enchantment-button")}}),e.styles.push({"margin-left":t?n+"%":void 0,width:t?t+"%":"100%"}),e},[b(String)]).apply(void 0,_toConsumableArray((d={click:{className:"enchantment-link",blockClassName:"enchantment-clickblock"},doubleclick:{className:"enchantment-dblclick",blockClassName:"enchantment-dblclickblock"},mouseover:{className:"enchantment-mouseover",blockClassName:"enchantment-mouseoverblock"},mouseout:{className:"enchantment-mouseout",blockClassName:"enchantment-mouseoutblock"}},["action",function(e,t){return o.create("action",[c.insensitiveName(t)])},function(e,t){return e.attr.push({class:function(){var e=function e(t){return(t=s(t)).is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(t.css("display"))||t.children().get().some(e)}(this);return Array.from(this.classList).filter(function(t){return!Object.keys(d).some(function(e){return d[e].className===t||d[e].blockClassName===t})}).concat(d[t][e?"blockClassName":"className"]).join(" ")}}),e},[T.apply(void 0,_toConsumableArray(Object.keys(d)))]])))(["border","b4r"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({display:function(){var e=s(this).css("display");return n.every(function(e){return"none"===e})||!e.includes("inline")?e:"inline-block"},"border-style":n.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),e},[C].concat(_toConsumableArray(Array(3).fill(b(C)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-size",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))("corner-radius",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("corner-radius",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[g(String,a)].concat(_toConsumableArray(Array(3).fill(b(g(String,a))))))("opacity",function(e,t){return o.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[t])("font",function(e,t){return o.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=t.indexOf("><");return/^(==+>|<=+|=+><=+|<==+>)$/.test(t)?((n=~n?_objectSpread({"text-align":"center","max-width":"50%"},25===(n=Math.round(n/(t.length-2)*50))?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":n+"%"}):"<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"}).display="block",o.create("align",[n])):u.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"')},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return o.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[g(String,a)])(["text-size","size"],function(e,t){return o.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return o.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return o.create("text-rotate-z",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" rotate("+t+"deg)"}}),e},[Number])("text-rotate-y",function(e,t){return o.create("text-rotate-y",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateY("+t+"deg)"}}),e},[Number])("text-rotate-x",function(e,t){return o.create("text-rotate-x",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateX("+t+"deg)"}}),e},[Number])(["background","bg"],function(e,t){return o.create("background",[t])},function(e,t){return a.isPrototypeOf(t)?t=t.toRGBAString():r.isPrototypeOf(t)&&(t=t.toLinearGradientString()),t=a.isHexString(t)||a.isCSS3Function(t)?{"background-color":t}:t.startsWith("linear-gradient(")||t.startsWith("repeating-linear-gradient(")?{"background-image":t}:{"background-size":"cover","background-image":"url(".concat(t,")"),"background-attachment":"fixed"},e.styles.push(t,{display:function(){var e=s(this);return!e.children().length||c.childrenProbablyInline(e)?s(this).css("display"):"block"}}),e},[g(String,a,r)]).apply(void 0,_toConsumableArray((y={color:function(){return"transparent"}},p=m(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var e=s(this).css("color");return"-1px -1px 0 "+e+", 1px -1px 0 "+e+",-1px  1px 0 "+e+", 1px  1px 0 "+e}},{color:function(){return c.parentColours(s(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+s(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+s(this).css("color")}},smear:[{"text-shadow":function(){var e=s(this).css("color");return"0em   0em 0.02em "+e+",-0.2em 0em  0.5em "+e+", 0.2em 0em  0.5em "+e}},y],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+s(this).css("color")}},y],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+s(this).css("color")},"user-select":"none"},y],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},tall:{display:"inline-block",transform:"scaleY(1.5) translateY(-0.25ex)"},flat:{display:"inline-block",transform:"scaleY(0.5) translateY(0.25ex)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("text-style",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(p[n[a]]);return e},[S(T.apply(void 0,_toConsumableArray(Object.keys(p))))]])))("collapse",function(){return o.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=l.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?o.create("hover-style",[t]):u.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[o])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),o.create("css",[t])},function(e,t){return e.attr.push({style:function(){return(s(this).attr("style")||"")+t}}),e},[String])("test-true",function(){return o.create("test-true",[])},function(e){return e.enabled=!0},k(w))("test-false",function(){return o.create("test-false",[])},function(e){return e.enabled=!1},k(w)),e.addCommand("animate",s.noop,function(r,e,t,a,o){t.forEach(e,function(e){var t,n;"zoom"===name&&(n=(t=e.offset()).left,t=t.top,n=c.mouseCoords.x-n+"px "+(c.mouseCoords.y-t)+"px"),c.transitionIn(e,a,r.transitionTime||o,r.transitionDelay,r.transitionSkip,0,n)})},[S(n),T.apply(void 0,_toConsumableArray(A.innerType.filter(function(e){return"instant"!==e}))),b(_)]),["box","float-box"].forEach(function(i){return e.addChanger(i,function(e,t,n){var r=-1===t.search(h)||1<t.length&&!t.includes("="),a="float-box"===i&&(-1===n.search(h)||1<n.length&&!n.includes("="));return r||a?u.create("datatype","The ("+i+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(r?t:n)+'".'):o.create(i,[t,n].filter(function(e){return void 0!==e}))},function(e,t,n){var r,t=f(t),a=t.marginLeft,t=t.size,o=("float-box"===i&&(r=(o=f(n)).marginLeft,n=o.size),"box"===i?"%":"vw"),t=_defineProperty(_defineProperty(_defineProperty({display:"block",width:t+o,"max-width":t+o},"box"===i?"margin-left":"left",a+o),"overflow-y","auto"),"padding",function(){var e=s(this).css("padding");return e&&"0px"!==e?e:"1em"});return void 0!==n&&(t.height="box"===i?1.5*n+2+"em":n+"vh"),"float-box"===i&&m(t,{position:"fixed",top:r+"vh","background-color":function(){return c.parentColours(s(this)).backgroundColour}}),e.styles.push(t),e},[String,"box"===i?b(x):String])})}),define("macrolib/values",["macros","state","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","datatypes/codehook","internaltypes/twineerror"],function(t,r,e,n,l,c,a,o,i,f){var s=e.realWhitespace,u=e.nth,p=e.anyRealLetter,d=e.plural,h=n.subset,m=n.objectName,g=n.clone,y=n.toSource,e=t.TypeSignature,n=e.rest,b=e.zeroOrMore,v=e.either,w=e.optional,k=e.insensitiveSet,S=e.numberRange,T=e.percent,_=e.nonNegativeInteger,x=e.positiveInteger,e=e.Any,O=Math.max,A=Math.min,C=Math.round,E=Math.floor,N=Math.ceil;function j(t){return function(){var e=t.apply(void 0,arguments);return"number"!=typeof e||isNaN(e)?f.create("macrocall","This mathematical expression doesn't compute!"):e}}t.add(["str","string","text"],"String",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.map(function(e){return i.isPrototypeOf(e)?e.source:e}).join("")},[b(t.TypeSignature.either(String,Number,Boolean,Array,i))])("source","String",function(e,t){return"command"!==(null==t?void 0:t.TwineScript_TypeID)||t.TwineScript_ToSource?y(t):f.create("datatype","I can't construct the source code of a command created by a custom macro.")},[e])("substring","String",function(e,t,n,r){return h(t,n,r)},[String,parseInt,parseInt])("lowercase","String",function(e,t){return t.toLowerCase()},[String])("uppercase","String",function(e,t){return t.toUpperCase()},[String])("lowerfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words","Array",function(e,t){return t.split(RegExp(s+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],"String",function(e,t,n){return 0===n.length?f.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[_,String])(["str-reversed","string-reversed"],"String",function(e,t){return _toConsumableArray(t).reverse().join("")},[String])("joined","String",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[n(String)])("plural","String",function(e,t,n,r){return n&&""!==r?d(t,n,r):f.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,w(String)])(["str-nth","string-nth"],"String",function(e,t){return u(t)},[parseInt])("digit-format","String",function(e,t,n){if(1e21<=Math.abs(n))return f.create("macrocall","The number given to (digit-format:) is too big.");for(var r=/([^#0])(?=[#0]*$)/g,a=(r.exec(t)||[])[1],o=(/^[#0]*([^#0])/g.exec(t)||[])[1],i=(t=_toConsumableArray(t)).length,s=(a&&(","!==a||o&&","!==o)&&(i=r.lastIndex-1),Math.abs(n).toFixed(16).replace(/(\.\d*?)0+$/,function(e,t){return t}).replace(/^0+/,"")),c=s.includes(".")?s.indexOf("."):s.length,l=0,u="",p=t.length-1;0<=p;--p){var d=t[p];"0"===d||"#"===d?u=(s[c-i+p+l]||("0"===d?"0":""))+u:p<t.length-1&&0<p&&(u=d+u,l+=p===i?0:1)}return(n<0?"-":"")+u},[String,Number])(["num","number"],"Number",function(e,t){return Number.isNaN(+t)?f.create("macrocall","I couldn't convert "+m(t)+" to a number."):+t},[String])("datatype","Datatype",function(e,t){return a.from(t)},[e])("datapattern","Any",function(e,t){return function n(e){var r;return Array.isArray(e)?r=e.map(n):e instanceof Map?(r=new Map,_toConsumableArray(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return r.set(t,n(e))})):r=a.from(e),(e=f.containsError(r))||r}(t)},[e])(["rgb","rgba"],"Colour",function(e){return l.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[S(0,255),S(0,255),S(0,255),w(T)])(["hsl","hsla"],"Colour",function(e,t,n,r,a){return(t=C(t)%360)<0&&(t+=360),l.create({h:t,s:n,l:r,a:a})},[Number,T,T,w(T)])(["lch","lcha"],"Colour",function(e,t,n,r,a){return(r=C(r)%360)<0&&(r+=360),l.create({l:t,c:n,h:r,a:a})},[T,S(0,132),Number,w(T)])("complement","Colour",function(e,t){return t.LCHRotate(180)},[l])("mix","Colour",function(e,t,n,r,a){n=n.toLCHA(),a=a.toLCHA();var o=1,i=(t+r!==1&&(t+r<1&&(o=t+r),t=(i=[t/(t+r),r/(t+r)])[0],r=i[1]),n.c<2||n.l<.01||.99<n.l?n.h=a.h:(a.c<2||a.l<.01||.99<a.l)&&(a.h=n.h),n.l*=n.a,n.c*=n.a,a.l*=a.a,a.c*=a.a,180<a.h-n.h?n.h+=360:a.h-n.h<-180&&(a.h+=360),n.a*t+a.a*r),s=(n.l*t+a.l*r)/i,c=(n.c*t+a.c*r)/i,n=(n.h*t+a.h*r)/i;return l.create({l:s,c:c,h:n,a:i*o})},[T,l,T,l])("palette","Array",function(e,t,n){var r,a=n.toLCHA(),o=a.l,a={l:o<=.75?.75+o/3:.75-3*(1-o),c:80,h:a.h,a:1},i=l.create(a);return a.l+=o<=.75?-.1:.1,a.l<.5&&(a.l*=.5/a.l),r=l.create(a),a.l+=o<=.85?.15:-.15,o=l.create(a),"adjacent"===t?(r=(i=i.LCHRotate(-30)).LCHRotate(30),o=i.LCHRotate(60)):"triad"===t&&(o=i.LCHRotate(180),r=i.LCHRotate(140),i=i.LCHRotate(-140)),[n,i,r,o]},[k("mono","adjacent","triad"),l])("gradient","Gradient",function(e,t){(t=C(t)%360)<0&&(t+=360);for(var n,r,a,o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];return i.length<4?f.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours."):(r=[],a=i.reduce(function(e,t){if(!f.containsError(e))if(void 0===n)n=t;else{if("number"!=typeof n||!l.isPrototypeOf(t))return f.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");r.push({stop:n,colour:g(t)}),n=void 0}return e},!0),f.containsError(a)?a:void 0!==n?f.create("macrocall","This gradient has a colour-stop percent without a colour."):c.create(t,r))},[Number,n(v(T,l))])("stripes","Gradient",function(e,t,n){(t=C(t)%360)<0&&(t+=360);for(var r=0,a=[],o=arguments.length,i=new Array(3<o?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return i.forEach(function(e){a.push({stop:r,colour:g(e)}),r+=n,a.push({stop:r,colour:g(e)})}),c.create(t,a,!0)},[Number,x,l,n(l)])("hooks-named","HookName",function(e,t){return t?o.create({type:"name",data:t}):f.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond","Any",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=2){var o=n[a];if(a===n.length-1||f.containsError(o))return o;if("boolean"!=typeof o)return f.create("datatype","(cond:)'s "+u(a+1)+" value is "+m(o)+", but should be a boolean.");if(o)return n[a+1]}return f.create("macrocall","An odd number of values must be given to (cond:), not "+n.length,"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,e,n(e)]);({weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,n(Number)],max:[O,n(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return(0<e?E:N)(e)},Number],ceil:[N,Number],pow:[j(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[j(Math.sqrt),Number],log:[j(Math.log),Number],log10:[j(Math.log10),Number],log2:[j(Math.log2),Number],random:[function(e,t){var n,t=t?(n=A(e,t),O(e,t)):(n=0,e);return t+=1,~~(r.random()*(t-n))+n},[parseInt,t.TypeSignature.optional(parseInt)]],"":function(){for(var e in this)e&&hasOwnProperty.call(this,e)&&t.add(e,"Number",function(a){return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.apply(void 0,n)}}(this[e][0]),this[e][1])}})[""](),t.add("either","Any",function(e){var t=1+~~(r.random()*(arguments.length<=1?0:arguments.length-1));return t<1||arguments.length<=t?void 0:arguments[t]},n(e))("nth","Any",function(e,t){return t<=0?f.create("datatype","(nth:)'s first value should be a positive whole number, not "+t):(t=(t-1)%(arguments.length<=2?0:arguments.length-2)+2)<2||arguments.length<=t?void 0:arguments[t]},[parseInt,n(e)])}),!function(){var a,k={};function o(e){for(var t in e)this[t]=e[t]}function i(e,t){for(var n,r,a=e.innerText,o=null,i=0,s=i,c=a.length,l=null;i<c;){for(var u=a.slice(i),p=(o&&o.length?o[0]:e).innerMode,d=0,f=p.length;d<f;d+=1){var h=k[p[d]];if(!(h.constraint&&!h.constraint(l)||h.cannotFollowText&&("text"===(null==(w=l)?void 0:w.type)||s<i))&&(h.plainCompare?u.startsWith(h.pattern):h.pattern.test(u))){var m=h.fn(h.plainCompare?h.pattern:h.pattern.exec(u)),g=!1,y=0;if(m.matches){for(;o&&y<o.length;y+=1){var b=o[y],v=b.type,b=b.aka;if(v in m.matches){g=!0;break}b&&(v=b),-1<(null==(b=m.cannotCross)?void 0:b.indexOf(v))&&(y=o.length-1)}if((!o||y>=o.length)&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:p});var s=i+=(l=e.addChild(m)).text.length,w=!1;g&&(t&&S(e,l,o[y]),o=o.slice(y+1),w=!0),!w&&l.isFront&&(o?o.unshift(l):o=[l]);break}}d===f&&(i+=1,null===l)&&(l={type:"text"})}for(s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:(null!=(n=o)&&n.length?o[0]:e).innerMode});0<(null==(r=o)?void 0:r.length);)o.shift().demote();return e}function S(e,t,n){var r=e.children.indexOf(t),a=e.children.indexOf(n);t.children=e.children.splice(a+1,r-(a+1)),t.type=t.matches[n.type],t.innerText="";for(var o,i=0,s=t.children.length;i<s;i++)t.innerText+=t.children[i].text;for(o in t.start=n.start,t.text=n.text+t.innerText+t.text,n)hasOwnProperty.call(n,o)&&!hasOwnProperty.call(t,o)&&(t[o]=n[o]);t.isFront&&(t.isFront=!1),e.children.splice(a,1)}o.prototype={constructor:o,addChild:function(e){var t=this.lastChildEnd(),n=new o(e);return n.start=t,n.end=e.text&&t+e.text.length,n.place=this.place,n.children=[],n.innerText&&i(n),this.children.push(n),n},lastChildEnd:function(){var e=this.children&&this.children[this.children.length-1]||null;return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.children.length)for(var t=0;t<this.children.length;t+=1)if(e>=this.children[t].start&&e<this.children[t].end){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1)if(e>=this.children[n].start&&e<this.children[n].end){var r=this.children[n].pathAt(e);if(r.length){t=t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(n){return n<this.start||n>=this.end?null:this.children?this.children.reduce(function(e,t){return e||(n>=t.start&&n<t.end?t:null)},null):this},everyLeaf:function(n){return this.children&&0!==this.children.length?this.children.reduce(function(e,t){return e&&t.everyLeaf(n)},!0):!!n(this)},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&0<this.children.length&&(e+="["+this.children+"]"),e},copy:function(){var e=new o(this);return e.children=e.children.slice(),e},foldChildren:function(){for(var e=[],t=this.children.slice(),n=0;n<t.length;n+=1){var r=t[n],a=!1;if(r.matches)for(var o=0;o<e.length;o+=1)e[o].type in r.matches&&(S(this,r,e[o]),e=e.slice(o+1),a=!0);!a&&r.isFront&&e.unshift(r)}}},a={lex:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"start",r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return i(new o({type:"root",place:t,start:0,end:e.length,text:e,innerText:e,children:[],innerMode:a.modes[n]}),!r)},rules:k,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=a:"function"==typeof define&&define.amd?define("lexer",[],function(){return a}):this&&null!=this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=a):this.Lexer=a}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var m,g=Object.keys,y=Object.assign;function t(e){function t(n){return n=n||"innerText",function(e){var e=e.reduceRight(function(e,t,n){return e||(n?t:"")},""),t={};return t[n]=e,t}}function n(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var r=Object.bind(0,null);function a(a,e){return Object.keys(e).forEach(function(n){var r=e[n].fn;e[n].fn=function(e){var t=r(e);return t.text||(t.text="string"==typeof e?e:e[0]),t.type||(t.type=n),t.innerMode||(t.innerMode=a),t}}),e}function o(e){switch(e&&e.type){case null:case"br":case"hr":case"bulleted":case"numbered":case"heading":case"align":case"column":case"escapedLine":return!0}return!1}var i=[],s=[],c=[],l=a(i,{hr:{fn:r},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t,e=e[1],n=e.indexOf("><");return~n?25===(t=Math.round(n/(e.length-2)*50))&&(t="center"):"<"===e[0]&&">"===e.slice(-1)?t="justify":-1<e.indexOf(">")?t="right":-1<e.indexOf("<")&&(t="left"),{align:t}}},column:{fn:function(e){var t,e=e[1],n=e.indexOf("|");return n&&n<e.length-1?t="center":"|"===e[0]&&"|"===e.slice(-1)?t="none":n===e.length-1?t="right":n||(t="left"),{column:t,width:/\|+/.exec(e)[0].length,marginLeft:/^=*/.exec(e)[0].length,marginRight:/=*$/.exec(e)[0].length}}}}),u=(g(l).forEach(function(e){l[e].constraint=o,l[e].cannotFollowText=!0}),a(i,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:n("boldOpener","bold")},italicOpener:{fn:n("italicOpener","italic")},strikeOpener:{fn:n("strikeOpener","strike")},supOpener:{fn:n("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:r},tag:{fn:r},url:{fn:r},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:r},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var e=e[0].length,t={};return{type:(t["verbatim"+e]="verbatim")+e,isFront:!0,matches:t,aka:"verbatimOpener"}}},unclosedCollapsed:{fn:r},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:r},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:i}}},br:{fn:r}})),p=y(a(s,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener","hookFront"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",e=e[3]||"";return{type:"twineLink",innerText:n?e:t,passage:t?e:n,innerMode:i}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:i}}},variable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")},tempVariable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")}}),{hookFront:u.hookFront,hookBack:u.hookBack}),d=a(s,_objectSpread(_objectSpread({commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},macroName:{constraint:function(e){return e&&"macroFront"===e.type},fn:t("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:t("name"),constraint:function(e){if(e)switch(e.type){case"variable":case"hookName":case"property":case"tempVariable":case"colour":case"itsProperty":case"belongingItProperty":case"macro":case"grouping":case"string":case"datatype":case"hook":case"boolean":case"number":return!0}}},possessiveOperator:{fn:r},itsProperty:{cannotFollowText:!0,fn:t("name")},itsOperator:{cannotFollowText:!0,fn:r},belongingItProperty:{cannotFollowText:!0,fn:t("name")},belongingItOperator:{cannotFollowText:!0,fn:r},belongingProperty:{cannotFollowText:!0,fn:t("name")},belongingOperator:{cannotFollowText:!0,fn:r},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:c}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:c}}},hookName:{fn:t("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollowText:!0,fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollowText:!0,fn:function(e){var e=e[0].toLowerCase(),t={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"},t=hasOwnProperty.call(t,e)?"#"+t[e]:e;return{colour:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:-1<e[1].indexOf("not")}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:t("name"),cannotFollowText:!0},whitespace:{fn:r,cannotFollowText:!0},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollowText:!0}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:r,cannotFollowText:!0},e},{})),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:r},e},{}))),f=a(c,{singleStringCloser:d.singleStringOpener,doubleStringCloser:d.doubleStringOpener,escapedStringChar:d.escapedStringChar}),h=(i.push.apply(i,_toConsumableArray(g(l)).concat(_toConsumableArray(g(p)),_toConsumableArray(g(u)))),s.push.apply(s,_toConsumableArray(g(p)).concat(_toConsumableArray(g(d)))),c.push.apply(c,_toConsumableArray(g(f))),_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},l),u),p),d),f)),u=(g(h).forEach(function(e){m.PlainCompare[e]?(h[e].pattern=m.PlainCompare[e],h[e].plainCompare=!0):h[e].pattern=RegExp("^(?:"+m[e]+")","i")}),y(e.rules,h),e.modes);return u.start=u.markup=i,u.macro=s,u.string=c,e}function n(e){return Object.freeze({lex:t(e).lex,Patterns:m})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(m=require("./patterns"),module.exports=n(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(e,t){return m=t,n(e)}):this&&this.loaded&&this.modules?(m=this.modules.Patterns,this.modules.Markup=n(this.modules.Lexer)):(m=this.Patterns,this.Markup=n(this.Lexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){var e;function n(t){return t&&"object"===_typeof(t)?(Object.keys(t).forEach(function(e){t[e]=n(t[e])}),t):(t+"").replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function t(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=t("?:"),a=t("?!"),o=t("?="),i="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=i.replace("*","+"),c="\\b",l="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",u=l.replace("\\-",""),p=r("\\n","$"),d=i+"(\\*+)"+s,f=i+"((?:0\\.)+)"+s,h=i+"-{3,}"+i+p,m=i+"(==+>|<=+|=+><=+|<==+>)"+i+p,p=i+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+i+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(n).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},y=u+"*"+u.replace("\\w","a-zA-Z")+u+"*",b="\\$("+y+")",v="_("+y+")",w="'s"+s+a("_")+"("+y+")",k="("+y+")"+s+"of"+c+a("it\\b"),S="'s"+s,T=r("it","time","turns?","visits?","exits?","pos")+c,_="its"+s+"("+y+")",x="("+y+")"+s+"of"+s+"it"+c,O="of"+s+"it"+c,A={opener:"\\(",name:"("+r("\\$","_")+"?"+l+"+):"+a("\\/"),closer:"\\)"},C=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),E="[a-zA-Z][\\w\\-]*",N="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",j="\\|("+l+"+)(>|\\))",P="(<|\\()("+l+"+)\\|",R="((?:\\b\\d+(?:\\.\\d+)?|\\.\\d+)(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:l,anyLetterStrict:u,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",tag:"<\\/?"+E+N+">",scriptStyleTag:"<("+r("script","style","textarea")+")"+N+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:m,column:p,bulleted:d,numbered:f,verbatimOpener:"`+",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:j+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(P),hookAppendedBack:"\\]"+P,unclosedHook:"\\[=+",unclosedHookPrepended:j+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,simpleLink:g.opener+g.legacyText+g.closer,macroFront:A.opener+o(A.name),macroName:A.name,groupingFront:"\\("+a(A.name),twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",validPropertyName:y,property:w,belongingProperty:k,possessiveOperator:S,belongingOperator:"of\\b",itsOperator:"its\\b",belongingItOperator:O,variable:b,tempVariable:v,hookName:"\\?("+l+"+)\\b",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","codehook","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","newline","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:R,boolean:r("true","false")+c,identifier:T,itsProperty:_,belongingItProperty:x,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+i+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:n("+")+a("="),subtraction:n("-")+a("=","type"),multiplication:n("*")+a("="),division:r("/","%")+a("="),spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:n("-type")+c,incorrectOperator:C,PlainCompare:{comma:",",commentFront:"\x3c!--",commentBack:"--\x3e",strikeOpener:"~~",italicOpener:"//",boldOpener:"''",supOpener:"^^",strongFront:"**",strongBack:"**",emFront:"*",emBack:"*",collapsedFront:"{",collapsedBack:"}",groupingBack:")"}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),define("twinescript/operations",["utils","utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,m){var a=e.plural,o=t.isObject,i=t.collectionType,s=t.is,c=t.isA,l=t.clone,u=t.unique,p=t.contains,e=t.matches,g=t.objectName,d=t.toSource;function f(r,a,o,i){return o=o||"do this to",function(e,t){var n;return 1===a.length&&(t=e),(n=m.containsError(e,t))||(_typeof(e)!==r||_typeof(t)!==r?m.create("operation","I can only ".concat(o," ").concat(r,"s, not ").concat(g(_typeof(e)!==r?e:t),"."),i):a(e,t))}}function h(a){return function(e,t){var n,r;return(n=m.containsError(e,t))||(_typeof(e)!==_typeof(t)||o(e)&&"TwineScript_TypeName"in e&&o(t)&&"TwineScript_TypeName"in t&&e.TwineScript_TypeName!==t.TwineScript_TypeName||i(e)!==i(t)?(n="".concat(g(e)," isn't the same type of data as ").concat(g(t)),_typeof(e)+_typeof(t)!=="stringnumber"&&_typeof(e)+_typeof(t)!=="numberstring"||(r="You might want to convert one side to a number using (num:), or to a string using (str:)."),m.create("operation",n[0].toUpperCase()+n.slice(1),r)):a(e,t))}}function y(d,f,e){var h=2<arguments.length&&void 0!==e&&e;return function r(a,o){var e;if(e=m.containsError(a,o))return e;var t=_slicedToArray(a.determiner?[a,o]:o.determiner?[o,a]:[],2),i=t[0],t=t[1];if(i){var n=i,s=n.determiner,n=n.determined;if("start"===s||"end"===s){if(f)return m.create("operation","I can't use '".concat(f,"' with the 'start' or 'end' of ").concat(g(n),"."));if(t.determiner){if("start"===t.determiner||"end"===t.determiner)return m.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");n=[t,i],i=n[0]}for(var c=i.string||i.array,l=0;l<c.length+1;l+=1){var u=l?"end"===s?c.slice(-l):c.slice(0,l):c.constructor(),u=i===a?r(u,o):r(a,u);if(e=m.containsError(u))return e;if(u!==h)return u}return h}var p="all"===s;return i.array.reduce(function(e,t){var n,t=i===a?r(t,o):r(a,t);return(n=m.containsError(e,t))||(p?e&&t:e||t)},p)}return d(a,o)}}function b(n,e){return y(function(e,t){e=n(e,t);return m.containsError(e)?e:!e},e,!0)}t="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.",t={and:f("boolean",h(function(e,t){return e&&t}),"use 'and' to join",t),or:f("boolean",h(function(e,t){return e||t}),"use 'or' to join",t),not:f("boolean",function(e){return!e},"use 'not' to invert",t),"+":h(function(e,t){var n;return Array.isArray(e)?[].concat(_toConsumableArray(e),_toConsumableArray(t)):e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(u).map(l)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(_typeof(e))?e+t:m.create("operation","I can't use + on ".concat(g(e),"."))}),"-":h(function(e,n){var r;return Array.isArray(e)?e.filter(function(t){return!n.some(function(e){return s(t,e)})}):e instanceof Set?(r=_toConsumableArray(n),new Set(_toConsumableArray(e).filter(function(t){return!r.some(function(e){return s(t,e)})}))):"string"==typeof e?e.split(n).join(""):"number"==typeof e?e-n:m.create("operation","I can't use - on ".concat(g(e),"."))}),"*":f("number",h(function(e,t){return e*t}),"multiply"),"/":f("number",h(function(e,t){return 0===t?m.create("operation","I can't divide ".concat(g(e)," by zero.")):e/t}),"divide"),"%":f("number",h(function(e,t){return 0===t?m.create("operation","I can't modulo ".concat(g(e)," by zero.")):e%t}),"modulus"),"<":y(f("number",h(function(e,t){return e<t}),"do < to"),"<"),">":y(f("number",h(function(e,t){return t<e}),"do > to"),">"),"<=":y(f("number",h(function(e,t){return e<=t}),"do <= to"),"<="),">=":y(f("number",h(function(e,t){return t<=e}),"do >= to"),">="),is:y(s),isNot:b(s),contains:y(p,"contains"),doesNotContain:b(p,"does not contain"),isIn:y(function(e,t){return p(t,e)},"is in"),isNotIn:b(function(e,t){return p(t,e)},"is not in"),isA:y(c,"is a"),isNotA:b(c,"is not a"),typifies:y(function(e,t){return c(t,e)}),untypifies:b(function(e,t){return c(t,e)}),matches:y(e),doesNotMatch:b(e),makeSpreader:function(e){var t;return m.containsError(e)?e:n.isPrototypeOf(e)||r.isPrototypeOf(e)?(t=l(e),(n.isPrototypeOf(e)?t.datatype:t).rest=!0,t):{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:a("string"==typeof e||Array.isArray(e)?_toConsumableArray(e).length:1,"spreaded '...' value"),TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return""+_toConsumableArray(e).map(d)}}}};return Object.freeze(t)}),define("twinescript/runner",["macros","state","utils","utils/operationutils","twinescript/operations","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","datatypes/assignmentrequest","internaltypes/varref","internaltypes/twineerror"],function(Macros,State,Utils,_ref127,Operations,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,AssignmentRequest,VarRef,TwineError){var toSource=_ref127.toSource,typeName=_ref127.typeName,objectName=_ref127.objectName,insensitiveName=Utils.insensitiveName,impossible=Utils.impossible,hash=Utils.hash;function addFreeVariable(e,t){var n,r=e.freeVariables;"macro"===t.type?"current-time"===(n=insensitiveName(t.name))||"current-date"===n||"monthday"===n||"weekday"===n||"history"===n||"visited"===n||"passage"===n?e.freeVariables=!0:t.blockedValue&&!r.blockedValues?r.blockedValues=e.stackTop.blockedValues.concat():"random"!==n&&"either"!==n&&"shuffled"!==n||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"identifier"===t.type?"time"!==(n=insensitiveName(t.text))&&"exits"!==n&&"it"!==n&&"visits"!==n&&"turns"!==n||(e.freeVariables=!0):"property"===t.type||"belongingProperty"===t.type?"random"!==insensitiveName(t.name)||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"variable"!==t.type&&"tempVariable"!==t.type||(e.freeVariables=!0)}var precedenceTable=[["error","text"],["comma"],["to","into"],["where","when","via","making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink","macro","identifier","variable","tempVariable","hookName","number","cssTime","boolean","string","hook","colour","datatype","root"],["grouping"]];function precedentToken(e,t){var n,r,a,o=[];if(e.length)for("most"===t?(n=precedenceTable.length-1,r=a=-1):(n=0,r=precedenceTable.length,a=1);n!==r;n+=a){var i=precedenceTable[n],s=NaN;if(i.rightAssociative){for(var c=0;c<e.length;c+=1)if(i.rightAssociative.includes(e[c].type)){s=c;break}}else for(var l=e.length-1;0<=l;--l)if(i.includes(e[l].type)){s=l;break}if(!Number.isNaN(s)&&-1<s){o=[e[s],s];break}}return o}var comparisonOpTypes=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"],inequalityNegator={">":"<=","<":">=",">=":"<","<=":">"};function compileComparisonOperator(e){return"inequality"===e.type?e.negate?inequalityNegator[e.operator]:e.operator:e.type}var comparisonReverser={">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"};function reverseComparisonOperator(e){e=compileComparisonOperator(e);return comparisonReverser[e]||e}var tokenSides={error:"neither",identifier:"neither",variable:"neither",tempVariable:"neither",hookName:"neither",number:"neither",boolean:"neither",string:"neither",hook:"neither",colour:"neither",datatype:"neither",root:"neither",twineLink:"neither",macro:"neither",grouping:"neither",itsProperty:"neither",belongingItProperty:"neither",to:"both",into:"both",typeSignature:"both",augmentedAssign:"both",and:"both",or:"both",belongingOperator:"both",possessiveOperator:"both",multiplication:"both",division:"both",spread:"after",bind:"after",not:"after",belongingProperty:"after",each:"after",itsOperator:"after",positive:"after",negative:"after",belongingItOperator:"before",property:"before"};function missingSideError(e,t,n){return TwineError.create("syntax","I need usable code to be ".concat(e?"left ":"").concat(e&&t?"and ":"").concat(t?"right ":"","of ").concat(n.text,"."))}function wrongSideError(e,t,n){return TwineError.create("syntax","There can't be a ".concat(e&&t?e.map(function(e){return e.text}).join("")+" or "+t.map(function(e){return e.text}).join(""):(e||t).map(function(e){return e.text}).join("")," to the ").concat(e?"left ":"").concat(e&&t?"or ":"").concat(t?"right ":"","of ").concat(n.text,"."),"There could be a comma missing between them.")}function makeEvalReplayFrame(e,t){var n=t.val,r=t.fromCode,a=t.toCode,o=t.toDesc,i=t.reason,s=t.it,c=t.tokens,t=t.i;if(!(200<=e.length)){var l=c[t],u=c.slice(0,t),t=c.slice(t+1);if(1===c.length&&(u=t=!1,l=c[0]),!e[e.length-1].error){var p,d,c=TwineError.containsError(n),f=e[e.length-1].code,h=e[0].basis,m=(null!=(p=u)&&p.length&&null!=(p=t)&&p.length&&u[0].start>t[0].start&&(u=(p=[t,u])[0],t=p[1]),p=a||"".concat(null!=(p=u)&&p.length&&"whitespace"===u[u.length-1].type?" ":"").concat(c?" \ud83d\udc1e ":(n&&!n.TwineScript_ToSource&&n.TwineScript_Unstorable?objectName:toSource)(n)).concat(null==(p=t)||!p.length||"whitespace"!==t[0].type&&"addition"!==l.type&&"subtraction"!==l.type?"":" "),(u.length?u[0]:l).start-h),g=(t.length?t[t.length-1]:l).end-h,y=_createForOfIteratorHelper(e);try{for(y.s();!(d=y.n()).done;){var b=d.value;b.start<m?(m+=b.diff,g+=b.diff):b.start<g&&(g+=b.diff)}}catch(e){y.e(e)}finally{y.f()}!r&&(r=f.slice(m,g),a)&&a.trim()===r.trim()||(u=p.length-(g-m),e.push({code:f.slice(0,m)+p+f.slice(g),fromCode:r,toCode:!c&&a,toDesc:!c&&!a&&(o||objectName(n)),start:m,end:g,diff:u,reason:i,itIdentifier:void 0!==s&&objectName(s),error:c&&c.render(f.slice(m,g),!0)}))}}}function setIt(e,t){return(VarRef.isPrototypeOf(t)||TypedVar.isPrototypeOf(t))&&(e.Identifiers.it=t.get()),t}return function run(section,tokens){var isVarRef=2<arguments.length&&void 0!==arguments[2]&&arguments[2],isTypedVar=3<arguments.length&&void 0!==arguments[3]&&arguments[3],evalReplay=section.evalReplay,hasEvalReplay=null==evalReplay?void 0:evalReplay.length,evalReplayReason,evalReplaySkip=!1,evalReplayIt,ops=Operations,token,ret,i,before,after,_precedentToken,_precedentToken2,token,i,before,after;if(Array.isArray(tokens)||(tokens=[tokens]),!tokens.length||!tokens[0])return impossible("Runner.run","No tokens to run!"),0;1===tokens.length?token=tokens[0]:(_precedentToken=precedentToken(tokens,"least"),_precedentToken2=_slicedToArray(_precedentToken,2),token=_precedentToken2[0],i=_precedentToken2[1],before=tokens.slice(0,i),after=tokens.slice(i+1),before.length&&(1!==before.length||"whitespace"!==before[0].type)||(before=!1),after.length&&(1!==after.length||"whitespace"!==after[0].type)||(after=!1));var type=token.type;if(!type)return impossible("Runner.run","Token has no type!"),0;var sides=tokenSides[type]||"",VARREF=("both"!==sides||before&&after?"neither"===sides&&(before||after)?ret=wrongSideError(before,after,token):"before"===sides?before?after&&(ret=wrongSideError(null,after,token)):ret=missingSideError(!0,!1,token):"after"===sides&&(after?before&&(ret=wrongSideError(before,null,token)):ret=missingSideError(!1,!0,token)):ret=missingSideError(!before,!after,token),section.freeVariables&&"object"===_typeof(section.freeVariables)&&addFreeVariable(section,token),!0),TYPEDVAR=!0,_ret4,val,evalReplayReason,ret,source,_source4,_value4,msg;if(!ret){if("comma"===type)return impossible("Section.run","a comma token was run() somehow."),0;if("root"===type)ret=run(section,token.children);else if("identifier"===type)ret=isVarRef?VarRef.create(section.Identifiers,token.text.toLowerCase()):section.Identifiers[token.text.toLowerCase()];else if("variable"===type||"tempVariable"===type){ret=VarRef.create("tempVariable"===type?section.stackTop.tempVariables:State.variables,token.name),isTypedVar?(ret=TypedVar.create(Datatype.create("any"),ret),evalReplayReason=hasEvalReplay&&"Variables in 'to' or 'into' expressions with no -type to their left are considered to be 'any-type' variables that can store any storable value."):isVarRef||TwineError.containsError(ret)?evalReplaySkip=!0:(val=ret.get(),evalReplayReason=hasEvalReplay&&((null==(_ret4=ret)?void 0:_ret4.object)!==State.variables||hasOwnProperty.call(ret.object,ret.compiledPropertyChain[0])?"":"This variable didn't exist; for story-wide $ variables, a default value of 0 is used if they don't exist."),ret=val)}else if("hookName"===type)ret=HookSet.create({type:"name",data:token.name}),evalReplaySkip=!0;else if("number"===type||"cssTime"===type)ret=token.value,evalReplayReason=hasEvalReplay&&"cssTime"===type&&(token.text.endsWith("ms")?"The letters 'ms' at the end of numbers are ignored, so you can use them to indicate that a number represents milliseconds.":"The letter 's' at the end of numbers represents 'seconds'. Harlowe converts them to milliseconds (multiplies them by 1000)."),evalReplaySkip=!evalReplayReason;else if("boolean"===type)ret="true"===token.text.toLowerCase(),evalReplaySkip=!0;else if("string"===type){var t=token.text.replace(/(.?)\n/g,function(e,t){return("\\"===t?"\\\\":"\n"===t?"\\n":t)+"\\n"}).replace(/(\\*)\\0/g,function(e,t){return(t?"\\".repeat(2*t.length):"")+"0"});ret=eval(t),evalReplaySkip=!0}else if("hook"===type)ret=CodeHook.create(token.children,token.text),evalReplaySkip=!0;else if("colour"===type)ret=Colour.create(token.colour),evalReplaySkip=!0;else if("datatype"===type)ret=Datatype.create(token.name),evalReplaySkip=!0;else if("spread"===type)ret=ops.makeSpreader(run(section,after,!1,isTypedVar));else if("bind"===type)ret=VarBind.create(run(section,after,VARREF),token.text.startsWith("2")?"two way":""),evalReplaySkip=!0;else if("to"===type||"into"===type){var dest="to"===type?setIt(section,run(section,before,VARREF,TYPEDVAR)):run(section,after,VARREF,TYPEDVAR);if(TwineError.containsError(dest))ret=dest;else{(VarRef.isPrototypeOf(dest)&&dest.propertyChain.length<=1||TypedVar.isPrototypeOf(dest)&&dest.varRef.propertyChain.length<=1)&&(section.freeVariables=Object.create(null));var src="to"===type?run(section,after,VARREF):setIt(section,run(section,before,VARREF));if(TwineError.containsError(src))return src;var freeVariables=section.freeVariables,srcRef;section.freeVariables=null,token.place&&freeVariables&&"object"===_typeof(freeVariables)&&"boolean"!=typeof src&&"number"!=typeof src&&!Utils.options.uncompressedPureValues&&(srcRef=freeVariables,srcRef.at=token.place,srcRef.from=after[0].start,srcRef.to=after[after.length-1].end,srcRef.hash=hash(after.reduce(function(e,t){return e+t.text},"")).toString(16),JSON.stringify(srcRef).length>=toSource(src).length)&&(srcRef=void 0),ret=AssignmentRequest.create(dest,src,type,srcRef),evalReplaySkip=!0,evalReplayIt=section.Identifiers.it}}else if("typeSignature"===type){var datatype=run(section,before),free=section.freeVariables,variable=(section.freeVariables=null,run(section,after,VARREF));section.freeVariables=free,ret=TypedVar.create(datatype,variable),evalReplaySkip=!0}else if("where"===type||"when"===type||"via"===type){after?(source=tokens.map(function(e){return e.text}).join(""),ret=Lambda.create(before?run(section,before,VARREF):void 0,token.type,after,source),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("making"===type||"each"===type){after?(_source4=[].concat(tokens).map(function(e){return e.text}).join(""),ret="each"===type?Lambda.create(run(section,after,VARREF),"each",null,_source4):Lambda.create(before?run(section,before,VARREF):void 0,token.type,run(section,after,VARREF),_source4),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("augmentedAssign"===type)ret=ops.makeAssignmentRequest(run(section,before,VARREF),ops[token.operator](run(section,before),run(section,after)),token.operator),evalReplaySkip=!0;else if("and"===type||"or"===type){var isComparisonOp=function e(t){var n=_slicedToArray(precedentToken(t,"least"),2),r=n[0],n=n[1];if(r&&"whitespace"!==r.type)return comparisonOpTypes.includes(r.type)?r:r.type===type?e(t.slice(0,n))||e(t.slice(n+1)):void 0},leftIsComparison=isComparisonOp(before),rightIsComparison=isComparisonOp(after),ambiguityError=TwineError.create("operation",'This use of "is not" and "'.concat(type,'" is grammatically ambiguous.'),'Maybe try rewriting this as "__ is not __ '.concat(type,' __ is not __"')),operator,getElisionOperands=function e(t){var n,r=_slicedToArray(precedentToken(t,"least"),2),a=r[0],r=r[1];return a&&"whitespace"!==a.type?a.type===type?[].concat(_toConsumableArray(e(t.slice(0,r))),_toConsumableArray(e(t.slice(r+1)))):(a=run(section,t),hasEvalReplay&&"boolean"!=typeof a&&(n=operator.replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}),makeEvalReplayFrame(evalReplay,{toCode:" it ".concat(n," ").concat(toSource(a)," "),reason:"A missing 'it ".concat(n,"' was inferred to correct the '").concat(type,"' operation."),tokens:t,i:r}),makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it)," ").concat(n," ").concat(toSource(a)," "),tokens:t,i:r})),[{val:a,tokens:t,i:r}]):[]},elidedComparisonOperator=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){var n=t.val,r=t.tokens,t=t.i;return"boolean"==typeof n?n:(e=Operations[token.type](e,Operations[operator](section.Identifiers.it,n)),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{val:e,tokens:r,i:t}),e)},"and"===token.type)},leftSide,evalBefore,operator,rightSide,rightIndex,swappedSides,evalAfter;ret=leftIsComparison&&!rightIsComparison?(leftSide=leftIsComparison,operator=compileComparisonOperator(leftSide),"isNot"===leftSide.type||"isNotA"===leftSide.type||"untypifies"===leftSide.type?ambiguityError:(evalBefore=run(section,before),ops[type](evalBefore,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(after)))))):!leftIsComparison&&rightIsComparison?(rightSide=rightIsComparison,rightIndex=tokens.indexOf(rightSide),operator=reverseComparisonOperator(rightSide),"isNot"===rightSide.type||"isNotA"===rightSide.type||"untypifies"===rightSide.type?ambiguityError:(swappedSides=[].concat(_toConsumableArray(tokens.slice(rightIndex+1)),[Object.assign(Object.create(rightSide),_defineProperty({},"inequality"===rightSide.type?"operator":"type",reverseComparisonOperator(rightSide)))],_toConsumableArray(tokens.slice(i+1,rightIndex))),evalAfter=run(section,swappedSides),ops[type](evalAfter,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(before)))))):ops[type](run(section,before),run(section,after))}else if(comparisonOpTypes.includes(type)){after||missingSideError(!1,!0,token);var leftOp=before?run(section,before):section.Identifiers.it;ret=ops[compileComparisonOperator(token)](leftOp,run(section,after)),section.Identifiers.it=leftOp,evalReplayIt=leftOp,evalReplayReason=hasEvalReplay&&!before&&"A missing 'it' was inferred to complete the operation."}else if("addition"===type||"subtraction"===type){after||missingSideError(!1,!0,token);var convert=!before,_precedentToken7,_precedentToken8,previousPrecedentToken,_i10,_sides,pType,convert;before&&(_precedentToken7=precedentToken(before,"least"),_precedentToken8=_slicedToArray(_precedentToken7,2),previousPrecedentToken=_precedentToken8[0],_i10=_precedentToken8[1],_sides=tokenSides[previousPrecedentToken.type],pType=previousPrecedentToken.type,convert=("both"===_sides||"after"===_sides||"addition"===pType||"subtraction"===pType)&&(_i10===before.length-1||_i10===before.length-2&&"whitespace"===before[before.length-1].type)),convert?(token.type="addition"===type?"positive":"negative",ret=run(section,tokens),token.type=type,evalReplaySkip=!0):ret=ops[token.text](run(section,before),run(section,after))}else if("multiplication"===type||"division"===type)ret=ops[token.text](run(section,before),run(section,after));else if("positive"===type||"negative"===type)ret=ops["*"]("negative"===type?-1:1,run(section,after)),evalReplaySkip=!0;else if("not"===type)ret=ops.not(run(section,after));else if("belongingProperty"===type){var container=run(section,after,isVarRef),isRef=(ret=VarRef.create(container,token.name),isVarRef||TwineError.containsError(ret));ret=isRef?ret:ret.get(),isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&!isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(token.name," of ").concat(toSource(VarRef.isPrototypeOf(container)?container.get():container)," "),tokens:tokens,i:i}):isRef||(evalReplayReason="The value to the right of 'of', ".concat(typeName(container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("belongingOperator"===type||"belongingItOperator"===type){var value=run(section,before);"random"===value&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("belongingItOperator"===type?section.Identifiers.it:run(section,after,isVarRef),{computed:!0,value:value}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"belongingItOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(value)," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i})}else if("property"===type){var _container=run(section,before,VARREF),_isRef=(ret=VarRef.create(_container,token.name),isVarRef||TwineError.containsError(ret));ret=_isRef?ret:ret.get(),_isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&VarRef.isPrototypeOf(_container)&&!_isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(_container.get()),"'s ").concat(token.name," "),tokens:tokens,i:i}):_isRef||(evalReplayReason="The value to the left of 's, ".concat(typeName(_container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("itsProperty"===type||"belongingItProperty"===type)ret=VarRef.create(section.Identifiers.it,token.name),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:"itsProperty"===type?" ".concat(toSource(section.Identifiers.it),"'s ").concat(token.name," "):" ".concat(token.name," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i});else if("possessiveOperator"===type||"itsOperator"===type){!after||!before&&"itsOperator"!==token.type?ret=missingSideError(!before,!after,token):(_value4=run(section,after),"random"===_value4&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("itsOperator"===token.type?section.Identifiers.it:run(section,before,isVarRef),{computed:!0,value:_value4}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"itsOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it),"'s ").concat(toSource(_value4)," "),tokens:tokens,i:i}))}else if("twineLink"===type)ret=Macros.run("link-goto",section,[token.innerText,token.passage]),evalReplayReason=hasEvalReplay&&"Passage links are the same as (link-goto:) macro calls.";else if("macro"===type)if(token.blockedValue&&!section.blocked){if(ret=section.blockedValue(),void 0===ret)return impossible("Runner.run","section.blockedValue() returned undefined"),0}else{var macroNameToken=token.children[0],variableCall="$"===macroNameToken.text[0]||"_"===macroNameToken.text[0],macroRef;if("macroName"!==macroNameToken.type&&!variableCall)return impossible("Runner.run","macro token had no macroName child token"),0;variableCall?(macroRef=VarRef.create("_"===macroNameToken.text[0]?section.stackTop.tempVariables:State.variables,macroNameToken.text.trim().slice(1,-1)),TwineError.containsError(macroRef)||(macroRef=macroRef.get())):macroRef=token.name,ret=Macros[variableCall?"runCustom":"run"](macroRef,section,token.children.slice(1).reduce(function(e,t){return"comma"===t.type?e.push([]):e[e.length-1].push(t),e},[[]]).filter(function(e){return e.length&&(1<e.length||"whitespace"!==e[0].type)}).map(function(e){return run(section,e,!1,isTypedVar)})),evalReplayReason=hasEvalReplay&&variableCall&&"I called ".concat(objectName(macroRef),".")}else if("grouping"===type)ret=run(section,token.children,isVarRef),evalReplaySkip=!0;else if("error"===type)ret=TwineError.create("syntax",token.message,token.explanation||"");else{if("text"!==type)return impossible("Section.run","unknown syntax token type: ".concat(type,"!!")),0;token.text.trim().match(/^\d+(?:th|nd|st|rd)(?:last)?(?:to\d+(?:nth|nd|st|rd)(?:last)?)?$/g)&&(msg='Position data names like "'.concat(token.text,'" need to be either left of "of" or right of "\'s".')),ret=TwineError.create("syntax",msg||'"'.concat(token.text,"\" isn't valid Harlowe syntax for the inside of a macro call."),"Maybe you misspelled something? Also, as of 3.3.0, Javascript syntax is not allowed inside macro calls.")}}return void 0===ret?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced undefined")),0):ret===section?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced the section")),0):(hasEvalReplay&&!evalReplaySkip&&makeEvalReplayFrame(evalReplay,{val:ret,reason:evalReplayReason,it:evalReplayIt,tokens:tokens,i:i}),ret)}}),define("utils/jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]&&this[0].nodeType===Node.TEXT_NODE?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return(null==e?void 0:e.nodeType)===Node.TEXT_NODE&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){var t=this.find(e),e=this.filter(e);return e.length?t.add(e):t}})}),define("utils/naturalsort",[],function(){return function(h){var m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:String;return function(e,t){var n,r,a,o,i=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[/-]\d{1,4}[/-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,l=/^0/,e=m(e).trim(),t=m(t).trim(),u=e.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=t.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=parseInt(e.match(c))||1!==u.length&&e.match(s)&&Date.parse(e),e=parseInt(t.match(c))||i&&t.match(s)&&Date.parse(t)||null;if(h&&window.Intl&&window.Intl.Collator&&(a=window.Intl.Collator(h)),e){if(i<e)return-1;if(e<i)return 1}for(var d=0,f=Math.max(u.length,p.length);d<f;d++){if(n=!(u[d]||"").match(l)&&parseFloat(u[d])||u[d]||0,r=!(p[d]||"").match(l)&&parseFloat(p[d])||p[d]||0,isNaN(n)!==isNaN(r))return isNaN(n)?1:-1;if(_typeof(n)!==_typeof(r))n+="",r+="";else if("string"==typeof n&&a&&0!==(o=a.compare(n,r)))return o;if(n<r)return-1;if(r<n)return 1}return 0}}}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(f,e,h,t){var m=e.impossible,g=e.nth,u=e.permutations,s=e.plural,y=t.validPropertyName,r="object",n="boolean",b="string",v="number",w="function";function a(e){return!!e&&(_typeof(e)===r||_typeof(e)===w)}var k=Array.isArray;function S(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function i(e){return k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":_typeof(e)===b?b:e&&_typeof(e)===r?r:""}function c(e){if(a(e)){if(_typeof(e.TwineScript_Clone)===w)return e.TwineScript_Clone();if(k(e))return _toConsumableArray(e);if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(_typeof(e)===w)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return _objectSpread({},e);case null:return Object.assign(Object.create(null),e)}m("OperationUtils.clone","The value "+e+" cannot be cloned!")}return e}function o(e,t,n,r){for(var a="",o=0;a.length<=t&&o<e.length;){var i=r(e[o]);if(!(i.length+a.length<=t)){a+=(0<o?" and ":"")+s(e.length-o,(0<o?"other ":"")+n);break}a+=(0<o&&o===e.length-1?" and ":"")+i+(o<e.length-1?", ":""),o+=1}return a}function l(e){var t;return a(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:k(e)?0===e.length?"an empty array":"an array (with "+o(e,48,"item",l)+")":e instanceof Map?0===e.size?"an empty datamap":"a datamap (with "+o(_toConsumableArray(e.keys()),48,"dataname",_)+")":e instanceof Set?0===e.size?"an empty dataset":"a dataset (with "+o(_toConsumableArray(e.values()),48,"item",l)+")":_typeof(e)===b?0===e.length?"an empty string":48<(t=_toConsumableArray(e)).length?"a ".concat(t.length,"-character string starting with ").concat(JSON.stringify(t.slice(0,48).join(""))):"the string ".concat(JSON.stringify(e)):_typeof(e)===n?"the boolean value '"+e+"'":_typeof(e)===v?"the number "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function T(e,t){return[e[0],t[0]].sort(f("en"))[0]===e[0]?-1:1}function _(e,t){var n=h.containsError(e);if(n&&m("toSource","received a TwineError: "+n.message),_typeof(e.TwineScript_ToSource)===w)return e.TwineScript_ToSource();if(S(e)&&"first"in e&&"last"in e)return(e.first<0?(-1!==e.first?g(-e.first):"")+"last":g(e.first+1))+"to"+(e.last<0?(-1!==e.last?g(-e.last):"")+"last":g(e.last+1));if(k(e)){var r,a="",o=_createForOfIteratorHelper(e);try{for(o.s();!(r=o.n()).done;)var i=r.value,a=(a+=a?",":"(a:")+("property"===t?i+(0<i):_(i))}catch(e){o.e(e)}finally{o.f()}return a+(a?")":"(a:)")}if(e instanceof Map){var s,c="",l=_createForOfIteratorHelper(Array.from(e.entries()).sort(T));try{for(l.s();!(s=l.n()).done;){var u=_slicedToArray(s.value,2),p=u[0],d=u[1];c+=(c?",":"(dm:")+_(p)+","+_(d)}}catch(e){l.e(e)}finally{l.f()}return c+(c?")":"(dm:)")}return e instanceof Set?"(ds:"+Array.from(e).sort(f("en")).map(_)+")":_typeof(e)===v&&"property"===t?e<0?-1===e?"last":g(-e)+"last":g(e+1):_typeof(e)===b&&"property"===t?RegExp(y).test(e)?e:"("+JSON.stringify(e)+")":JSON.stringify(e)}function p(t,n){return _typeof(t)!==r&&_typeof(n)!==r?t===n:k(t)&&k(n)?t.length===n.length&&t.every(function(e,t){return p(n[t],e)}):t instanceof Map&&n instanceof Map?p(Array.from(t.entries()).sort(),Array.from(n.entries()).sort()):t instanceof Set&&n instanceof Set?p(_toConsumableArray(t),_toConsumableArray(n)):t&&_typeof(t.TwineScript_is)===w?t.TwineScript_is(n):t&&_typeof(t)===r&&n&&_typeof(n)===r&&S(t)&&S(n)?p(Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]}),Object.getOwnPropertyNames(n).map(function(e){return[e,n[e]]})):Object.is(t,n)}return Object.freeze({isObject:a,isValidDatamapName:function(e,t){var n;return e instanceof Map||m("isValidDatamapName","called with non-Map"),h.containsError(t)?t:_typeof(t)!==b&&_typeof(t)!==v?h.create("property","Only strings and numbers can be used as data names for "+l(e)+", not "+l(t)+"."):(n=_typeof(t)===b?+t:""+t,!(!Number.isNaN(n)&&e.has(n))||h.create("property","You mustn't use both "+l(t)+" and "+l(n)+" as data names in the same datamap."))},collectionType:i,isSequential:function(e){return _typeof(e)===b||k(e)||_typeof(e.hooks)===w},unstorableValue:function e(t){return(null==t?void 0:t.TwineScript_Unstorable)&&t||k(t)&&t.find(e)||t instanceof Map&&_toConsumableArray(t.values()).find(e)||t instanceof Set&&_toConsumableArray(t).find(e)},isHarloweJSValue:function e(t){return _typeof(t)===b||_typeof(t)===n||_typeof(t)===v&&!Number.isNaN(t)&&Math.abs(t)!==1/0||Array.isArray(t)&&t.every(e)||t instanceof Set&&_toConsumableArray(t).every(e)||t instanceof Map&&_toConsumableArray(t.values()).every(e)&&_toConsumableArray(t.keys()).every(function(e){return _typeof(e)===b})},clone:c,objectName:l,typeName:function e(t){var n,r=S(t);return r&&t.innerType?t.typeName||("insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(k(t.innerType)||m("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType)):r&&"range"===t.pattern?t.name||(r=t.min,n=t.max,"a"+(0<r?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+n:n<1/0?" up to "+n:"")):t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":a(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:l(t)},typeID:function(e){var t=_typeof(e);return[n,b,v].includes(t)?t:k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:_,is:p,contains:function(e,t){if(e||""===e){if(_typeof(e)===b)return _typeof(t)!==b?h.create("operation",l(e)+" can only contain strings, not "+l(t)+"."):e.includes(t);if(k(e))return e.some(function(e){return p(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return p(e,t)})}return h.create("operation",l(e)+" cannot contain any values, let alone "+l(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===w?t.TwineScript_IsTypeOf(e):h.create("operation",'"is a" should only be used to compare type names, not '+l(t)+".")},matches:function t(n,e){var r=!1;if(n&&_typeof(n.TwineScript_IsTypeOf)===w){var a=n.TwineScript_IsTypeOf(e);if(h.containsError(a))return a;r|=a}if(e&&_typeof(e.TwineScript_IsTypeOf)===w){if(a=e.TwineScript_IsTypeOf(n),h.containsError(a))return a;r|=a}if(r)return!0;if(k(n)&&k(e)){for(var o=0,i=0,s=!0;s&&o<n.length&&i<e.length;){var c=n[o],l=e[i];if(c.rest){for(;i<e.length&&t(c,l);)l=e[i+=1];o+=1}else if(l.rest){for(;o<n.length&&t(c,l);)c=n[o+=1];i+=1}else t(c,l)?(o+=1,i+=1):s=!1}return s&&o>=n.length&&i>=e.length}return n instanceof Map&&e instanceof Map?t(Array.from(n.entries()).sort(),Array.from(e.entries()).sort()):n instanceof Set&&e instanceof Set?(n=_toConsumableArray(n),u.apply(void 0,_toConsumableArray(e)).some(function(e){return t(n,e)})):p(n,e)},subset:function e(t,n,r){var a,o;return n&&r?((a=_typeof(t)===b)&&(t=Array.from(t)),n<0&&(n=Math.max(0,t.length+n+1)),(r=r<0?Math.max(0,t.length+r+1):r)<n?e(arguments[0],r,n):(o=t.slice(0<n?n-1:n,r).map(c),a?o.join(""):o)):h.create("macrocall","The sub"+i(t)+" index value must not be "+(n&&r)+".")},range:function e(t,n){if(n<t)return e(n,t);var r=[t];for(n-=t;0<n--;)r.push(++t);return r},printBuiltinValue:function r(e){return h.containsError(e)?e:e&&_typeof(e.TwineScript_Print)===w?e.TwineScript_Print():e instanceof Map?(e=Array.from(e.entries()),h.containsError(e)?e:e.reduce(function(e,t){var n=(t=_slicedToArray(t,2))[0],t=t[1];return e+"<tr><td>`"+r(n)+"`</td><td>`"+r(t)+"`</td></tr>"},"<table class=datamap>")+"</table>"):e instanceof Set?Array.from(e.values()).map(r)+"":k(e)?e.map(r)+"":e&&_typeof(e.jquery)===b?e:a(e)?h.create("unimplemented","I don't know how to print this value yet."):e+""},unique:function(t,e,n){return n.findIndex(function(e){return p(t,e)})===e}})}),define("utils/polyfills",[],function(){var o=Array.prototype;"function"!=typeof o.includes&&(o.includes=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(e)&&Number.isFinite(t)&&void 0!==e)return-1<o.indexOf.call(this,e,t);var n=Object(this),r=parseInt(n.length);if(!(r<=0))for(var a=0<=t?t:Math.max(0,r+t);a<r;){if(Object.is(e,n[a]))return!0;a+=1}return!1}),window.Symbol||(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils/renderutils",["jquery","utils","renderer"],function(l,u,p){var n=RegExp(u.realWhitespace+"+"),s=RegExp(u.realWhitespace+"+","g");function d(e,t,n){var r,a=e.textContent.length;if(!(a<=t))return r=[e=0===t?e:e.splitText(t)],n&&(n=n<=0?a-n:n)<a&&r.push(e.splitText(n-t)),r}var t,c=function(){var e;return void 0!==t?t:(e=l("<p>"),t=!!e[0].normalize&&(e.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),1===e.contents().length))};var f="tw-collapsed,[collapsing=true]";var o=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var e,t=(c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).section,n=void 0===(n=c.parent)?u.storyElement:n,r=c.cd,a=void 0===(a=c.message)?"":a,o=c.defaultValue,i=void 0===(c=c.buttons)?[{name:"OK",confirm:!0,callback:Object}]:c,s=("a code hook"===a.TwineScript_TypeName&&(a=a.code),l("<tw-backdrop><tw-dialog>"+(o||""===o?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(i.length?i.reduce(function(e,t,n){t=t.name;return e+"<tw-link style='margin:0 "+(n===i.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+t+"</tw-link>"},""):"<tw-link tabindex=0>"+i[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>")),c=s.find("tw-dialog");return n.append(s),t?(t.renderInto(a,c,_objectSpread(_objectSpread({},r),{},{append:"prepend"})),null!=(n=(null==r?void 0:r.transition)&&s.find("tw-dialog > tw-transition-container"))&&n.length&&n.appendTo(s).append(c.prepend(n.contents().detach()))):c.prepend(p.exec(a)),o&&((e=s.find("input").last()).val(o).on("keypress",function(e){13===e.which&&(s.remove(),i.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return e.focus()},100)),i.reverse().forEach(function(e,t){l(s.find("tw-link").get(-t-1)).on("click",function(){u.options.debug&&u.options.ignoreClickEvents&&!l(s).is(".eval-replay, .harlowe-crash")||(s.remove(),e.callback())})}),s},realWhitespace:n,textNodeToChars:function(r){var e=_toConsumableArray(r.textContent);return 1===e.length?[r]:e.reduce(function(e,t){return t.match(n)&&e.length&&e[e.length-1].match(n)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(e,t){var n=r;return t.length<r.textContent.length&&(r=r.splitText(t.length)),e.concat(n)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;0<t.length;){r.push(t[0]),a+=t[0].textContent,t.shift();var i=a.indexOf(n);if(-1<i){for(var s=a.length-(i+n.length);i>=r[0].textContent.length;)i-=r[0].textContent.length,r.shift();if(1===r.length){var c=d(r[0],i,i+n.length);o.push(c[0]),c[1]&&t.unshift(c[1]);break}o.push(d(r[0],i,r[0].length)[0]),o.push.apply(o,_toConsumableArray(r.slice(1,-1))),c=d(r[r.length-1],0,r[r.length-1].textContent.length-s),o.push(c[0]),c[1]&&t.unshift(c[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(e){function n(e){return 0===l(this||e).parentsUntil(f).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var t=function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:(t=(t=r.textNodes().filter(function(e){return 4&(e=e.compareDocumentPosition(n))&&!(8&e)}))[t.length-1])||e(r)}(e),r=(l(t).parents(f).length||(t=null),function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:r.textNodes().filter(function(e){return 2&(e=e.compareDocumentPosition(n))&&!(8&e)})[0]||e(r)}(e)),a=(l(r).parents(f).length||(r=null),"br:not([data-raw]),tw-consecutive-br:not([data-raw])"),o=(e.find(a).filter(n).replaceWith(document.createTextNode(" ")),(e=l(e.get().map(function(e){return l(e).filter(n).is(a)?l(document.createTextNode(" ")).replaceAll(e)[0]:e}))).textNodes()),i=0;o.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(s," ")," "!==t.textContent[0]||e&&e.textContent&&!(-1<e.textContent.search(/\s$/))||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},t),_toConsumableArray(o).reverse().every(function(e){return!(!n(e)||(e.textContent.match(/^\s*$/)?(i+=e.textContent.length,e.textContent=""):(e.textContent=e.textContent.replace(/\s+$/,function(e){return i+=e.length,""}),1)))}),0<i&&r&&(o[o.length-1].textContent+=" "),e[0]&&c()&&e[0].normalize()},geomStringRegExp:o,geomParse:function(e){var t,n,r,a;return!e||(t=e.length,n=(a=_slicedToArray(o.exec(e)||[],3))[0],r=a[1],a=a[2],!n)||a===e&&1<a.length?{marginLeft:0,size:0}:{marginLeft:r.length/t*100,size:a.length/t*100}}})}),define("utils/scripttag",["state","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(a,o,i,s){return function(e,r){Function("script","scope","with(scope){var scope=void 0,arguments=void 0;eval([script,script=void 0][0]);}")(e,Object.create(null,Object.keys(a.variables).map(function(e){return!e.startsWith("TwineScript_")&&"$"+e}).concat(Object.keys(r).map(function(e){return!e.startsWith("TwineScript_")&&"_"+e})).reduce(function(e,n){return n&&(e[n]={get:function(){var e=("$"===n[0]?a.variables:r)[n.slice(1)];if(o.isHarloweJSValue(e))return o.clone(e);throw s.create("","The contents of the variable ".concat(n,", ").concat(o.objectName(e),", couldn't be converted to a Javascript value."),"Only booleans, strings, numbers, datamaps, datasets and arrays can be converted to Javascript values.")},set:function(e){var t="$"===n[0]?a.variables:r;if(!o.isHarloweJSValue(e))throw s.create("","The Javascript value, ".concat(e,", couldn't be converted to a Harlowe value and assigned to the variable ").concat(n,"."),"Only booleans, strings, numbers (except NaN and Infinity), Maps, Sets and Arrays can be converted to Harlowe values.");e=o.clone(e);t=i.create(t,n.slice(1)).set(e);if(s.containsError(t))throw t}}),e},{})))}}),!function(){function e(t,n,r){return function(e){return"background-color: hsla(".concat(t,",").concat(n,"%,").concat(r,"%,").concat(e,");")}}var t={boolean:"color:hsla(0,0%,30%,1.0)",array:"color:hsla(0,100%,30%,1.0)",dataset:"color:hsla(30,100%,40%,1.0)",number:"color:hsla(30,100%,30%,1.0)",datamap:"color:hsla(60,100%,30%,1.0)",changer:"color:hsla(90,100%,30%,1.0)",lambda:"color:hsla(120,100%,40%,1.0)",hookName:"color:hsla(160,100%,30%,1.0)",string:"color:hsla(180,100%,30%,1.0)",identifier:"color:hsla(200,80%,40%,1.0)",variable:"color:hsla(200,100%,30%,1.0)",tempVariable:"color:hsla(200,70%,20%,1.0)",datatype:"color:hsla(220,100%,30%,1.0)",colour:"color:hsla(280,100%,30%,1.0)",macro:"color:hsla(320,80%,30%,1.0)",twineLink:"color:hsla(240,100%,20%,1.0)"},o=(t.gradient=t.colour,t.command=t.twineLink,t.instant=t.metadata=t.any=t.customMacro=t.macro,Math.min),n=e(40,100,50),r=e(220,100,50),i=/hsla\((\d+),\s*(\d+)%,\s*(\d+)%,\s*(\d+\.\d+)\)/g,s="cm-harlowe-3-",a=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={root:"box-sizing:border-box;",hook:n(.05),"hook-2":n(.1),"hook-3":n(.15),"hook-4":n(.2),"hook-5":n(.25),"hook-6":n(.3),"hook-7":n(.35),"hook-8":n(.4),"^=hook , ^=hook-":"font-weight:bold;",unclosedHook:n(.05)+"font-weight:bold;"},"error:not([class*='"+s+"string'])","background-color: hsla(17,100%,50%,0.5) !important;"),"^=macroName","font-style:italic;"),"macroName-boolean",t.boolean),"macroName-array",t.array),"macroName-dataset",t.dataset),"macroName-datatype",t.datatype),"macroName-number",t.number),"macroName-datamap",t.datamap),"macroName-changer",t.changer),"macroName-string",t.string),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"macroName-colour, macroName-gradient",t.colour),"macroName-command, macroName-instant, macroName-metadata",t.command),"macroName-custommacro, macroName-macro, macroName-any",t.macro),"^=macro ","font-weight:bold;"+t.macro),"comma, spread",t.macro),"addition",t.any),"subtraction, multiplication, division",t.number),"is, and, or, not, isNot, contains, doesNotContain, isIn, isA, isNotA, isNotIn, matches, doesNotMatch",t.boolean),"bold, strong","font-weight:bold;"),"italic, em","font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"sup","vertical-align: super;font-size:0.8em;"),"strike","text-decoration: line-through;"),"verbatim","background-color: hsla(0,0%,50%,0.1);font:var(--font-monospaced)"),"^=bold, ^=strong, ^=italic, ^=em, ^=sup, ^=verbatim, ^=strike","font-weight:100; color: hsla(0,0%,0%,0.5)"),"^=collapsed","font-weight:bold; color: hsla(201,100%,30%,1.0);"),"unclosedCollapsed",r(.025)+"font-weight:bold; color: hsla(201,100%,30%,1.0);"),"collapsed",r(.025)),"collapsed.hook",r(.05)),"collapsed.hook-2",r(.1)),"collapsed.hook-3",r(.15)),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"collapsed.hook-4",r(.2)),"collapsed.hook-5",r(.25)),"collapsed.hook-6",r(.3)),"collapsed.hook-7",r(.35)),"collapsed.hook-8",r(.4)),"twineLink:not(.text)",t.twineLink),"tag, scriptStyleTag, comment","color: hsla(240,34%,25%,1.0);"),"boolean",t.boolean),"string",t.string),"number",t.number),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"variable",t.variable),"tempVariable",t.tempVariable),"hookName",t.hookName),"datatype",t.datatype),"colour",t.colour),"cssTime",t.number),"passageString",t.variable+";text-decoration:underline 1px;"),"tagString",t.variable+";text-decoration:underline 1px dotted;"),"variableOccurrence, hookOccurrence","background: hsla(159,50%,75%,1.0) !important;"),"^=where, ^=via, ^=with, ^=making, ^=each, ^=when",t.lambda+"; font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"heading","font-weight:bold;"),"hr","background-image: linear-gradient(0deg, transparent, transparent 45%, hsla(0,0%,75%,1.0) 45%, transparent 55%, transparent);"),"align","color: hsla(14,99%,37%,1.0); background-color: hsla(14,99%,87%,0.1);"),"column","color: hsla(204,99%,37%,1.0); background-color: hsla(204,99%,87%,0.1);"),"escapedLine","font-weight:bold; color: hsla(51,100%,30%,1.0);"),"identifier, property, belongingProperty, itsProperty, belongingItProperty, belongingItOperator, possessiveOperator, belongingOperator",t.identifier),"toString",function(){var a=this;return Object.keys(this).reduce(function(e,n){var r;return"toString"!==n&&(r=n.split(", ").map(function e(t){return-1<t.indexOf(".")?t.split(/\./g).map(e).join(""):0===t.indexOf("^=")?"[class^='"+s+t.slice(2)+"']":"."+s+t}),e+=r.join(", ")+"{"+a[n]+"}",a[n].match(i))&&[".theme-dark","[data-app-theme=dark]"].forEach(function(t){e+=r.map(function(e){return t+" "+e}).join(", ")+"{"+a[n].replace(i,function(e,t,n,r,a){return"hsla("+t+","+o(100,1.5*+n)+"%,"+(100-r)+"%,"+a+")"})+"}"}),e},"")})+"");"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports={Colours:t,CSS:a,versionClass:s}:"function"==typeof define&&define.amd&&define("utils/typecolours",[],function(){return{Colours:t,CSS:a,versionClass:s}})}.call(void 0);
;require("harlowe")}());
</script>

</body>
</html>
